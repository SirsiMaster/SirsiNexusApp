<!DOCTYPE html>
<html lang="en" data-auth-protect="admin">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proposal & Agreement | Admin Console</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700;800&family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap"
        rel="stylesheet">

    <!-- Dependencies -->
    <link href="/assets/css/tailwind.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- HTML to PDF - Simple, client-side PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <!-- Admin Layout Styles -->
    <link rel="stylesheet" href="/assets/css/admin-layout.css">
    <style>
        /* ============================================
           OPENSIGN POPUP/IFRAME CENTERING FIX
           Force any dynamically injected elements to center
           EXCLUDES: dialogs, workflow guides, and page wrappers
           ============================================ */
        /* Target OpenSign iframes, popups, and overlays - NOT dialogs */
        iframe[src*="opensign"],
        iframe[src*="sign"],
        div[id*="opensign"],
        div[class*="opensign"],
        div[class*="signing"],
        div[class*="popup"]:not(dialog *) {
            position: fixed !important;
            top: 50% !important;
            left: 50% !important;
            transform: translate(-50%, -50%) !important;
            margin: 0 !important;
            max-width: 95vw !important;
            max-height: 95vh !important;
            z-index: 999999 !important;
        }

        /* Modal styling - simple flexbox centering */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            display: none;
            z-index: 1000000;
        }

        .modal-overlay.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* CRITICAL OVERRIDES FOR CONTRACT HIERARCHY */

        /* Level 1: Main Page Title (H1) - Handled in layout */

        /* Level 2: Section Headers (e.g. "2. Detailed Scope") */
        .contract-immersive-wrapper h2 {
            font-family: 'Inter', sans-serif !important;
            /* FIXED: FORCE INTER */
            color: #C8A951 !important;
            font-size: 2.25rem !important;
            font-weight: 600 !important;
            /* REFINED: SemiBold instead of ExtraBold */
            text-transform: uppercase !important;
            letter-spacing: 0.05em !important;
            /* Tighter spacing */
            margin-top: 4rem !important;
            margin-bottom: 2rem !important;
            border: none !important;
            line-height: 2.5rem !important;
            text-align: center !important;
            /* Center all section headers */
        }

        /* Level 3: Subsections (e.g. "2.1 Core Vault") */
        /* FIX: Making this larger than H4 */
        .contract-immersive-wrapper h3 {
            font-family: 'Inter', sans-serif !important;
            /* FIXED: FORCE INTER */
            color: #93c5fd !important;
            /* Blue-300 */
            font-size: 1.375rem !important;
            /* text-lg */
            font-weight: 700 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.15em !important;
            margin-top: 3rem !important;
            margin-bottom: 1.5rem !important;
            padding-bottom: 0.5rem !important;
        }

        /* Level 4: Item Groups (e.g. "A. Identity") */
        .contract-immersive-wrapper h4 {
            font-family: 'Inter', sans-serif !important;
            color: #C8A951 !important;
            font-size: 1.125rem !important;
            /* text-lg (18px) - Clearly smaller than H3 */
            font-weight: 700 !important;
            margin-top: 1.5rem !important;
            margin-bottom: 0.5rem !important;
            text-transform: uppercase !important;
            letter-spacing: 0.05em !important;
        }

        /* Fix list spacing */
        .contract-immersive-wrapper ul {
            margin-bottom: 2rem !important;
        }

        .contract-immersive-wrapper li {
            margin-bottom: 0.75rem !important;
        }

        /* FORCE WIDER WIDTHS */
        .max-w-4xl {
            max-width: 80rem !important;
            /* max-w-7xl override */
        }

        /* Force grid to behave */
        .grid-cols-12 {
            display: grid !important;
            grid-template-columns: repeat(12, minmax(0, 1fr)) !important;
            gap: 2rem !important;
        }

        /* Fix the 2-column sections */
        .grid-cols-1.md\:grid-cols-2 {
            grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
            gap: 3rem !important;
        }

        /* Fix lists specifically */
        ul.list-disc {
            margin-left: 1.5rem !important;
            margin-bottom: 2rem !important;
        }

        ul.list-disc li {
            padding-left: 0.5rem !important;
            margin-bottom: 0.75rem !important;
        }

        /* Card overrides for space */
        .bg-white\/5 {
            padding: 2rem !important;
        }

        /* Ensure table text is readable */
        td,
        th {
            padding: 1rem !important;
            text-align: left !important;
            font-family: 'Inter', sans-serif !important;
            font-size: 1rem !important;
        }

        /* GLOBAL: Standardize ALL body text sizes in contract wrapper */
        .contract-immersive-wrapper p,
        .contract-immersive-wrapper li,
        .contract-immersive-wrapper td,
        .contract-immersive-wrapper th,
        .contract-immersive-wrapper span:not(.neo-text-gold),
        .text-blue-200,
        .text-blue-100,
        .text-slate-300,
        .text-slate-200,
        .text-slate-400,
        .text-slate-500 {
            font-size: 1.125rem !important;
            line-height: 1.75 !important;
            color: rgba(255, 255, 255, 0.9) !important;
        }

        /* Preserve small labels and badges */
        .text-xs,
        .text-sm {
            font-size: inherit !important;
        }

        /* Ensure table cells match */
        .contract-immersive-wrapper table td,
        .contract-immersive-wrapper table th {
            font-size: 1.125rem !important;
        }



        /* ========================================== */
        /* COST & VALUATION TAB: UNIFIED TYPOGRAPHY  */
        /* ========================================== */

        /*
         * UNIFIED TYPE SCALE (Based on 16px root):
         * - Labels: 12px (text-xs)
         * - Body/Table: 16px (text-base)
         * - Subheads: 18px (text-lg)
         * - Card Values: 24px (text-2xl)
         * - Section Titles: 28px (text-3xl)
         * - Big Values: 36px (text-4xl)
         * - Hero Values: 48px (text-5xl)
         */

        /* TOP STAT CARDS - Uniform Styling */
        #cost .stat-card.contract-stat {
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid rgba(255, 255, 255, 0.15) !important;
            padding: 1.5rem 1rem !important;
            text-align: center !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
            min-height: 120px !important;
        }

        #cost .stat-card.contract-stat>div:first-child {
            /* Label - LARGER for readability */
            font-family: 'Inter', sans-serif !important;
            font-size: 14px !important;
            font-weight: 600 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.08em !important;
            color: #C8A951 !important;
            margin-bottom: 0.5rem !important;
        }

        #cost .stat-card.contract-stat>div:nth-child(2) {
            /* Main Value - proportional */
            font-family: 'Cinzel', serif !important;
            font-size: 24px !important;
            font-weight: 500 !important;
            color: white !important;
            line-height: 1.2 !important;
        }

        #cost .stat-card.contract-stat>div:last-child:not(:nth-child(2)) {
            /* Sublabel */
            font-family: 'Inter', sans-serif !important;
            font-size: 12px !important;
            text-transform: uppercase !important;
            letter-spacing: 0.05em !important;
            color: #94a3b8 !important;
            margin-top: 0.25rem !important;
        }

        /* SECTION HEADERS - Consistent Gold titles */
        #cost h2 {
            font-family: 'Cinzel', serif !important;
            font-size: 24px !important;
            font-weight: 500 !important;
            color: #C8A951 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.1em !important;
        }

        /* ALL TABLES - Unified Font Size */
        #cost table {
            font-size: 16px !important;
        }

        #cost table th {
            font-family: 'Cinzel', serif !important;
            font-size: 14px !important;
            font-weight: 600 !important;
            color: #C8A951 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.05em !important;
            padding: 1rem !important;
        }

        #cost table td {
            font-family: 'Inter', sans-serif !important;
            font-size: 16px !important;
            color: #e2e8f0 !important;
            padding: 1rem !important;
        }

        #cost table td.font-bold,
        #cost table td strong {
            color: white !important;
        }

        /* DISCOUNT REALIZATION BOX - Balanced Professional Layout */
        #cost .discount-box-container {
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid rgba(200, 169, 81, 0.5) !important;
            padding: 2rem !important;
            max-width: 600px !important;
            margin: 0 auto !important;
        }

        #cost .discount-box-container .discount-label {
            font-family: 'Inter', sans-serif !important;
            font-size: 16px !important;
            font-weight: 500 !important;
            color: #e2e8f0 !important;
            text-align: left !important;
        }

        #cost .discount-box-container .discount-value {
            font-family: 'Cinzel', serif !important;
            font-size: 20px !important;
            font-weight: 500 !important;
            color: #C8A951 !important;
            text-align: right !important;
        }

        #cost .discount-box-container .discount-value.strikethrough {
            color: #64748b !important;
            text-decoration: line-through !important;
            text-decoration-color: #ef4444 !important;
        }

        #cost .discount-box-container .discount-final-label {
            font-family: 'Inter', sans-serif !important;
            font-size: 18px !important;
            font-weight: 600 !important;
            color: #e2e8f0 !important;
        }

        #cost .discount-box-container .discount-final-value {
            font-family: 'Cinzel', serif !important;
            font-size: 32px !important;
            font-weight: 600 !important;
            color: #C8A951 !important;
        }

        /* PARTNERSHIP PLAN CARDS */
        #cost .plan-grid-container {
            display: grid !important;
            grid-template-columns: repeat(3, 1fr) !important;
            gap: 2rem !important;
            align-items: stretch !important;
        }

        #cost .plan-grid-container .plan-card-item {
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            padding: 2rem !important;
            text-align: center !important;
            display: flex !important;
            flex-direction: column !important;
            transition: all 0.3s ease !important;
        }

        #cost .plan-grid-container .plan-card-item:hover {
            border-color: #C8A951 !important;
            transform: translateY(-4px) !important;
        }

        #cost .plan-grid-container .plan-card-item.recommended {
            background: linear-gradient(135deg, rgba(200, 169, 81, 0.15) 0%, rgba(0, 0, 0, 0.5) 100%) !important;
            border: 2px solid #C8A951 !important;
            transform: scale(1.03) !important;
            box-shadow: 0 0 60px rgba(200, 169, 81, 0.2) !important;
        }

        #cost .plan-grid-container .plan-card-item .plan-header {
            font-family: 'Cinzel', serif !important;
            font-size: 36px !important;
            font-weight: 600 !important;
            color: white !important;
            margin-bottom: 0.5rem !important;
        }

        #cost .plan-grid-container .plan-card-item .plan-subtitle {
            font-family: 'Inter', sans-serif !important;
            font-size: 11px !important;
            text-transform: uppercase !important;
            letter-spacing: 0.15em !important;
            color: #C8A951 !important;
            margin-bottom: 1.5rem !important;
        }

        #cost .plan-grid-container .plan-card-item .plan-amount-label {
            font-family: 'Inter', sans-serif !important;
            font-size: 14px !important;
            text-transform: uppercase !important;
            letter-spacing: 0.1em !important;
            color: #C8A951 !important;
        }

        #cost .plan-grid-container .plan-card-item .plan-amount-value {
            font-family: 'Cinzel', serif !important;
            font-size: 22px !important;
            color: white !important;
        }

        #cost .plan-grid-container .plan-card-item .plan-total-value {
            font-family: 'Cinzel', serif !important;
            font-size: 28px !important;
            font-weight: 600 !important;
            color: white !important;
        }

        /* ATOMIC BREAKDOWN PHASE CARDS - Larger fonts, white text */
        #cost .space-y-6>div h3 {
            font-size: 22px !important;
            font-weight: 600 !important;
            color: white !important;
        }

        #cost .space-y-6>div .text-right>div:first-child {
            font-size: 22px !important;
            font-family: 'Cinzel', serif !important;
            color: white !important;
        }

        #cost .space-y-6>div .text-xs {
            font-size: 16px !important;
            color: white !important;
        }

        #cost .space-y-6>div table {
            font-size: 18px !important;
        }

        #cost .space-y-6>div table th,
        #cost .space-y-6>div table td {
            font-size: 18px !important;
            padding: 0.75rem !important;
            color: white !important;
        }

        /* GLOBAL COST TAB: No grey/blue text, minimum 18px */
        #cost .text-slate-300,
        #cost .text-slate-400,
        #cost .text-slate-500,
        #cost .text-blue-100,
        #cost .text-blue-200 {
            color: white !important;
        }

        #cost .text-xs {
            font-size: 16px !important;
        }

        #cost .text-sm {
            font-size: 18px !important;
        }

        #cost .text-base {
            font-size: 20px !important;
        }

        #cost .text-lg {
            font-size: 22px !important;
        }

        #cost .text-xl {
            font-size: 24px !important;
        }
    </style>
    <link rel="stylesheet" href="/assets/css/finalwishes.css">
    <link rel="stylesheet" href="/assets/css/theme.css">

    <!-- Contract Specific Styles -->
    <style>
        /* Override Admin Layout for Inner Content to maintain Premium Dark Theme */
        .contract-immersive-wrapper {
            /* ROYAL NEO-DECO THEME */
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 2rem;
            --glass-border: rgba(255, 255, 255, 0.1);
            --color-gold: #C8A951;
            --color-gold-dark: #A08332;
            --color-blue-navy: #0f172a;
            --color-white: #ffffff;
            --radius: 4px;

            /* NEO HERO CARD */
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border-color: rgba(200, 169, 81, 0.5);

            /* FIXED: Background now covers full content */
            background: linear-gradient(180deg, rgb(37, 99, 235) 0%, rgb(30, 58, 138) 300px, rgb(15, 23, 42) 600px);
            background-color: rgb(15, 23, 42);
            background-attachment: local;
            /* Scroll with content */
            color: rgba(255, 255, 255, 0.9);
            font-family: 'Inter', sans-serif;
            flex: 1;
            min-height: 100vh;
            font-size: 18px;
            line-height: 1.6;
            padding: 2rem;
        }

        /* Override admin layout background for this page */
        .main-content {
            background: rgb(15, 23, 42) !important;
        }

        /* NEW: Internal Scroll Viewer Box */
        .legal-scroll-box {
            height: 60vh;
            /* Fixed height for the document viewer */
            min-height: 400px;
            overflow-y: auto;
            overflow-x: hidden;
            background: rgba(15, 23, 42, 0.4);
            border: 1px solid rgba(200, 169, 81, 0.3);
            border-radius: 12px;
            padding: 4rem;
            position: relative;
            box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.6);
            margin-bottom: 3rem;
            scrollbar-width: thin;
            scrollbar-color: #C8A951 rgba(15, 23, 42, 0.5);
        }

        /* Custom Scrollbar for Chrome/Safari */
        .legal-scroll-box::-webkit-scrollbar {
            width: 8px;
        }

        .legal-scroll-box::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 10px;
        }

        .legal-scroll-box::-webkit-scrollbar-thumb {
            background: #C8A951;
            border-radius: 10px;
            border: 2px solid rgba(15, 23, 42, 0.5);
        }

        /* Ensure tab contents handle the new layout */
        .tab-content {
            /* Removed height: 100% - it conflicts with block display and clips content */
            display: flex;
            flex-direction: column;
        }

        /* Allow main content to scroll */
        .main-content {
            overflow-y: auto !important;
        }

        /* MISSING CLASS DEFINITION */
        .neo-stat-card-hero {
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid rgba(200, 169, 81, 0.5) !important;
            border-radius: 8px !important;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1) !important;
            backdrop-filter: blur(5px) !important;
            transition: all 0.3s ease !important;
        }

        .neo-stat-card-hero:hover {
            border-color: #C8A951 !important;
            box-shadow: 0 0 20px rgba(200, 169, 81, 0.2) !important;
        }

        /* TYPOGRAPHY OVERRIDES WITHIN WRAPPER */
        .contract-immersive-wrapper h1,
        .contract-immersive-wrapper h2,
        .contract-immersive-wrapper h3,
        .contract-immersive-wrapper h4,
        .contract-immersive-wrapper .serif {
            font-family: 'Cinzel', serif !important;
            color: white !important;
        }

        /* INTERACTIVE PLAN CARDS */
        .plan-card-interactive {
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .plan-card-interactive:hover {
            border-color: #C8A951;
            box-shadow: 0 0 25px rgba(200, 169, 81, 0.15);
            transform: translateY(-2px);
        }

        .selected-plan-card {
            border: 2px solid #C8A951 !important;
            background: linear-gradient(135deg, rgba(200, 169, 81, 0.15) 0%, rgba(0, 0, 0, 0.6) 100%) !important;
            transform: scale(1.02) !important;
            box-shadow: 0 0 40px rgba(200, 169, 81, 0.25) !important;
            z-index: 10;
        }

        .selected-plan-card::after {
            content: "✓";
            position: absolute;
            top: -12px;
            right: -12px;
            background: #10B981;
            color: #0f172a;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 16px;
            border: 2px solid #0f172a;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            0% {
                transform: scale(0);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* INTERACTIVE ANIMATIONS */
        .plan-card-static.plan-card-anim {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            z-index: 1;
            border-radius: 2.5rem !important;
            -webkit-border-radius: 2.5rem !important;
            -moz-border-radius: 2.5rem !important;
        }

        .plan-card-anim:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px -5px rgba(0, 0, 0, 0.5);
            border-color: rgba(200, 169, 81, 0.4);
            z-index: 5;
        }

        .plan-card-anim.selected-anim {
            transform: scale(1.02);
            border-color: #C8A951 !important;
            background: linear-gradient(135deg, rgba(200, 169, 81, 0.1) 0%, rgba(0, 0, 0, 0.8) 100%) !important;
            box-shadow: 0 0 40px rgba(200, 169, 81, 0.2);
            z-index: 10;
        }

        /* PLAN CARD BUTTONS */
        .select-plan-btn {
            border-radius: 9999px !important;
            background: linear-gradient(to right, #C8A951, #E2C76B) !important;
            color: #000 !important;
            font-weight: 700 !important;
            box-shadow: 0 10px 15px -3px rgba(200, 169, 81, 0.2);
        }

        .select-plan-btn:hover {
            box-shadow: 0 10px 25px -3px rgba(200, 169, 81, 0.4);
            transform: scale(1.02);
        }

        /* All plan buttons should be gold */
        #card-plan-c .select-plan-btn {
            background: linear-gradient(to right, #C8A951, #E2C76B) !important;
            box-shadow: 0 10px 15px -3px rgba(200, 169, 81, 0.2);
        }

        #card-plan-c .select-plan-btn:hover {
            box-shadow: 0 10px 25px -3px rgba(200, 169, 81, 0.4);
        }

        /* DOWNLOAD BUTTONS */
        .download-btn-neo {
            position: absolute;
            top: 2rem;
            right: 2rem;
            border: 1px solid rgba(200, 169, 81, 0.4);
            color: #C8A951;
            padding: 0.6rem 1.2rem;
            font-family: 'Cinzel', serif;
            font-size: 0.75rem;
            letter-spacing: 0.1em;
            background: rgba(15, 23, 42, 0.6);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            transition: all 0.3s ease;
            z-index: 50;
            backdrop-filter: blur(8px);
            border-radius: 2px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .download-btn-neo:hover {
            background: rgba(200, 169, 81, 0.15);
            border-color: #C8A951;
            box-shadow: 0 0 20px rgba(200, 169, 81, 0.25);
            color: #fbbf24;
            transform: translateY(-1px);
        }

        .download-btn-neo svg {
            width: 16px;
            height: 16px;
            opacity: 0.8;
        }

        .download-btn-neo:hover svg {
            opacity: 1;
        }

        /* TABLE OVERRIDES FOR DARK MODE */
        .contract-immersive-wrapper table {
            border-collapse: collapse;
        }

        .contract-immersive-wrapper th {
            background: rgba(255, 255, 255, 0.05) !important;
            color: #C8A951 !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
        }

        .contract-immersive-wrapper td {
            color: rgba(255, 255, 255, 0.9) !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05) !important;
        }

        .contract-immersive-wrapper tr:hover td {
            background: rgba(255, 255, 255, 0.05) !important;
            color: #fff !important;
        }

        .contract-immersive-wrapper .gold-text {
            color: #C8A951 !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .contract-immersive-wrapper h1 {
            font-size: 3.5rem;
            letter-spacing: -0.02em;
        }

        .contract-immersive-wrapper h2 {
            font-size: 2.25rem;
            margin-bottom: 1.5rem;
            color: #C8A951 !important;
        }

        .contract-immersive-wrapper h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: white;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 0.5rem;
        }

        .contract-immersive-wrapper p {
            margin-bottom: 1.5rem;
            color: rgba(255, 255, 255, 0.85);
            font-size: 1.125rem;
        }

        /* CARD STYLES */
        .main-card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(200, 169, 81, 0.3);
            box-shadow: 0 25px 60px -12px rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(16px);
            border-radius: 4px;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }

        /* TABS */
        .nav-tabs {
            display: flex;
            justify-content: center;
            border-bottom: 2px solid rgba(255, 255, 255, 0.05);
            background: rgba(0, 0, 0, 0.2);
        }

        .tab-btn {
            padding: 1.75rem 3rem;
            font-family: 'Cinzel', serif;
            font-weight: 700;
            color: #cbd5e1;
            border-bottom: 4px solid transparent;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 1.125rem;
            cursor: pointer;
            background: transparent;
            border-top: none;
            border-left: none;
            border-right: none;
        }

        .tab-btn:hover {
            color: #C8A951;
            background: rgba(255, 255, 255, 0.03);
        }

        .tab-btn.active {
            color: #C8A951;
            border-bottom-color: #C8A951;
            background: linear-gradient(180deg, rgba(200, 169, 81, 0.1) 0%, rgba(0, 0, 0, 0) 100%);
        }

        /* CONTENT SECTIONS */
        .tab-content {
            display: none;
            padding: 1rem 5rem 5rem !important;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(15px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* DYNAMIC SELECTION STYLES */
        .plan-card-interactive {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 2rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .plan-card-interactive:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(200, 169, 81, 0.4);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.5);
        }

        .selected-plan-card {
            background: rgba(200, 169, 81, 0.05) !important;
            border-color: #C8A951 !important;
            box-shadow: 0 0 40px -10px rgba(200, 169, 81, 0.3) !important;
            transform: scale(1.02);
            z-index: 5;
        }

        .selected-plan-card::after {
            content: 'SELECTED';
            position: absolute;
            bottom: 0;
            right: 0;
            background: #C8A951;
            color: #0f172a;
            font-size: 10px;
            font-weight: 900;
            padding: 4px 12px;
            letter-spacing: 0.1em;
            clip-path: polygon(15% 0, 100% 0, 100% 100%, 0 100%);
        }

        /* SUB-COMPONENTS */
        .stat-card.contract-stat {
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            padding: 2rem;
            text-align: center;
            box-shadow: none !important;
        }

        .plan-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 4px;
        }

        .plan-card.active {
            border: 2px solid #C8A951;
            background: linear-gradient(135deg, rgba(200, 169, 81, 0.15) 0%, rgba(0, 0, 0, 0) 100%);
        }

        /* LEGAL TEXT VIEWER */
        .legal-viewer {
            background: rgba(15, 23, 42, 0.4);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(200, 169, 81, 0.2);
            color: rgba(255, 255, 255, 0.9);
            padding: 4rem;
            font-family: 'Inter', sans-serif;
            line-height: 1.8;
            border-radius: 4px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            margin-bottom: 2rem;
        }

        /* Ensure text in legal viewer is readable (Light mode paper) */
        .legal-viewer h2 {
            color: #C8A951 !important;
            border-bottom: 1px solid rgba(200, 169, 81, 0.3);
            padding-bottom: 1rem;
            font-size: 2.25rem;
            margin-top: 4rem;
            font-family: 'Cinzel', serif !important;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            text-align: center;
        }

        .legal-viewer h3 {
            color: #C8A951 !important;
            font-family: 'Cinzel', serif !important;
            font-size: 1.5rem;
            border-bottom: none;
            margin-top: 3rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .legal-viewer p,
        .legal-viewer li {
            color: rgba(255, 255, 255, 0.8) !important;
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
        }

        .legal-viewer ul {
            list-style-type: none;
            padding-left: 0;
            margin-bottom: 2rem;
        }

        .legal-viewer ul li {
            position: relative;
            padding-left: 2rem;
        }

        .legal-viewer ul li::before {
            content: '•';
            color: #C8A951;
            position: absolute;
            left: 0.5rem;
            font-weight: bold;
        }

        .legal-viewer table {
            color: white !important;
            border-collapse: collapse;
            width: 100%;
            margin: 2rem 0;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .legal-viewer th {
            color: #C8A951 !important;
            background: rgba(0, 0, 0, 0.3);
            font-family: 'Cinzel', serif !important;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding: 1.25rem !important;
        }

        .legal-viewer td {
            color: rgba(255, 255, 255, 0.8) !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            padding: 1rem !important;
        }

        /* CHECK LISTS */
        ul.check-list li {
            position: relative;
            padding-left: 2rem;
            margin-bottom: 1rem;
            font-size: 1.125rem;
        }

        ul.check-list li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: #C8A951;
            font-weight: bold;
        }

        /* GLOBAL TYPOGRAPHY OVERRIDE - NO MORE SERIFS */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        .font-serif {
            font-family: 'Inter', sans-serif !important;
        }

        /* REWRITTEN TABLE STYLES - SINGLE FONT SOURCE OF TRUTH */
        #market-analysis-table {
            width: 100%;
            border-collapse: collapse;
            font-family: 'Inter', sans-serif !important;
            /* FORCE INTER */
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            overflow: hidden;
            border-spacing: 0;
        }

        #market-analysis-table thead tr {
            background-color: rgba(0, 0, 0, 0.4);
            /* Darker header */
            border-bottom: 2px solid rgba(200, 169, 81, 0.4);
            /* Stronger separator */
        }

        #market-analysis-table th {
            font-family: 'Inter', sans-serif !important;
            font-weight: 800;
            /* Extra Bold Headers */
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 2rem 1.5rem;
            /* More vertical padding */
            text-align: center;
            font-size: 1.25rem !important;
            /* 20px - Larger Headers */
            line-height: 1.2;
        }

        #market-analysis-table th:nth-child(1) {
            text-align: left;
            color: #C8A951;
            width: 25%;
            font-size: 1.1rem !important;
            /* Slightly smaller for 'METRIC' label */
            opacity: 0.8;
        }

        #market-analysis-table th:nth-child(2) {
            color: white;
            width: 28%;
            /* Give hero column more space */
            background: rgba(255, 255, 255, 0.05);
            /* Highlight Hero Header */
        }

        #market-analysis-table th:nth-child(3),
        #market-analysis-table th:nth-child(4) {
            color: #94a3b8;
            width: 23.5%;
            font-weight: 600;
            font-size: 1.1rem !important;
            /* De-emphasize competitors */
        }

        #market-analysis-table tbody tr {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: background-color 0.2s;
        }

        #market-analysis-table tbody tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        #market-analysis-table td {
            font-family: 'Inter', sans-serif !important;
            padding: 1.75rem 1.5rem;
            /* Larger cells */
            text-align: center;
            font-size: 1.125rem !important;
            /* 18px Body Text */
            color: rgba(255, 255, 255, 0.9);
            vertical-align: middle;
        }

        #market-analysis-table td:nth-child(1) {
            text-align: left;
            font-weight: 700;
            color: white;
            font-size: 1.25rem !important;
            /* Metric Name Large */
        }

        #market-analysis-table td:nth-child(2) {
            color: white;
            font-weight: 600;
            background-color: rgba(200, 169, 81, 0.08);
            /* Stronger Highlight */
            border-left: 1px solid rgba(200, 169, 81, 0.15);
            border-right: 1px solid rgba(200, 169, 81, 0.15);
            font-size: 1.25rem !important;
            /* Hero Values Large */
        }

        #market-analysis-table td:nth-child(3),
        #market-analysis-table td:nth-child(4) {
            color: #cbd5e1;
            font-weight: 400;
        }

        /* Special Values Helper Class */
        .u-cinzel-accent {
            font-family: 'Cinzel', serif !important;
        }

        .u-text-gold {
            color: #C8A951 !important;
        }

        .u-text-emerald {
            color: #10b981 !important;
        }

        /* Allocation Text */
        #allocation-text {
            text-align: center !important;
            font-family: 'Inter', sans-serif !important;
            font-style: italic;
            font-size: 22px !important;
            /* Larger */
            color: white;
            line-height: 1.5;
        }

        /* ============================================
           PRINT / PDF STYLES
           These override all glassmorphism for clean print output
           ============================================ */
        @media print {

            /* Reset page settings */
            @page {
                size: letter;
                margin: 0.75in;
            }

            /* Hide non-essential UI */
            #sidebar-root,
            #universal-header-root,
            .tab-container,
            #msa-fab,
            #msa-action-bar,
            #msa-acknowledgment-block,
            #selection-phase,
            #signature-block,
            #step-1-label,
            #step-2-label,
            #step-3-label,
            .no-print,
            button,
            nav,
            header,
            footer,
            .sidebar,
            .nav-tabs,
            .download-btn-neo,
            .floating-action-bar,
            .admin-sidebar,
            .main-header,
            #msa-fab,
            #vertical-workflow-guide {
                display: none !important;
            }

            /* Hide ALL tab contents by default during print */
            .tab-content {
                display: none !important;
                visibility: hidden !important;
            }

            /* ONLY show the active tab content */
            .tab-content.active {
                display: block !important;
                visibility: visible !important;
                background: white !important;
                color: black !important;
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
            }

            /* Reset body and backgrounds */
            body,
            html {
                background: white !important;
                color: #1e293b !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .admin-wrapper,
            .main-content,
            .contract-immersive-wrapper,
            .contract-tabs-wrapper,
            .tab-content {
                background: white !important;
                padding: 0 !important;
                margin: 0 !important;
                width: 100% !important;
                max-width: 100% !important;
            }

            /* Make the contract tab always visible */
            .tab-content#contract {
                display: block !important;
                opacity: 1 !important;
            }

            /* Strip glassmorphism from legal-viewer */
            .legal-viewer,
            #contract-document {
                background: white !important;
                backdrop-filter: none !important;
                -webkit-backdrop-filter: none !important;
                border: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                margin: 0 !important;
                color: #1e293b !important;
            }

            /* Typography for print */
            .legal-viewer h2,
            .legal-viewer h3,
            .legal-viewer h4 {
                color: #0f172a !important;
                border-bottom-color: #0f172a !important;
                page-break-after: avoid;
            }

            .legal-viewer p,
            .legal-viewer li,
            .legal-viewer td {
                color: #1e293b !important;
                font-size: 11pt !important;
                line-height: 1.6 !important;
            }

            .legal-viewer ul li::before {
                color: #0f172a !important;
            }

            /* Tables for print */
            .legal-viewer table {
                background: white !important;
                border: 1px solid #cbd5e1 !important;
            }

            .legal-viewer th {
                background: #f1f5f9 !important;
                color: #0f172a !important;
                border-bottom: 2px solid #0f172a !important;
            }

            .legal-viewer td {
                border-bottom: 1px solid #e2e8f0 !important;
            }

            /* Gold accents become dark gold/brown for print */
            [style*="C8A951"] {
                color: #92710d !important;
            }

            /* Prevent page breaks in awkward places */
            h2,
            h3,
            h4 {
                page-break-after: avoid;
            }

            p,
            li {
                orphans: 3;
                widows: 3;
            }

            section {
                page-break-inside: avoid;
            }

            /* Exhibit blocks for print */
            #exhibit-b-dynamic {
                background: #f8fafc !important;
                border: 1px solid #cbd5e1 !important;
                color: #1e293b !important;
            }

            body {
                background: white !important;
            }

            .main-card {
                background: white !important;
                border: none !important;
                box-shadow: none !important;
                padding: 0 !important;
            }
        }

        /* ============================================
           CONTRACT HEADING CLASSES (Desktop)
           Class-based styling for responsive override
           ============================================ */
        .contract-main-heading {
            color: #C8A951;
            margin-bottom: 16px;
            font-size: 42px;
            line-height: 1.2;
            font-family: 'Inter', sans-serif;
            font-weight: 800;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            max-width: 900px;
        }

        .contract-gold-divider {
            height: 1px;
            width: 128px;
            background: #C8A951;
            margin: 24px auto;
            opacity: 0.5;
        }

        .contract-subtitle {
            font-size: 16px;
            color: white;
            text-transform: uppercase;
            letter-spacing: 0.25em;
            font-weight: 600;
            text-align: center;
            font-family: 'Inter', sans-serif;
        }

        .sow-heading {
            font-size: 3.75rem;
            margin-bottom: 1.5rem;
            line-height: 1;
        }

        /* ============================================
           MOBILE RESPONSIVE STYLES
           First-class mobile experience - v3.0 SWIFTUI
           ============================================ */

        /* TABLET BREAKPOINT (1024px and below) */
        @media (max-width: 1024px) {

            /* Tab content - bound padding */
            .tab-content {
                padding: 1.5rem 1.5rem 3rem !important;
            }

            /* Plan grid - 2 columns on tablet */
            #cost .plan-grid-container,
            #selection-phase>div>div:last-child {
                grid-template-columns: repeat(2, 1fr) !important;
            }

            /* Legal viewer - tighter padding */
            .legal-viewer {
                padding: 1.5rem !important;
            }

            /* Main heading - scale down */
            .contract-immersive-wrapper h1 {
                font-size: 2rem !important;
                line-height: 1.2 !important;
                padding: 0 1rem !important;
            }

            /* Phase accordion headers */
            .contract-immersive-wrapper h2,
            .tab-content h2 {
                font-size: 1.5rem !important;
            }

            /* Hero objective card */
            .neo-stat-card-hero {
                padding: 1.5rem !important;
                margin: 1.5rem auto !important;
            }
        }

        /* MOBILE BREAKPOINT (768px and below) */
        @media (max-width: 768px) {

            /* ===== CONTAINER & LAYOUT ===== */
            .main-content {
                margin-left: 0 !important;
                padding: 0 !important;
            }

            /* Wrapper padding control */
            .contract-immersive-wrapper {
                padding-left: 0 !important;
                padding-right: 0 !important;
            }

            /* ===== TAB NAVIGATION - HORIZONTAL SCROLL ===== */
            .nav-tabs,
            .tab-container {
                flex-direction: row !important;
                flex-wrap: nowrap !important;
                gap: 0 !important;
                width: 100% !important;
                overflow-x: auto !important;
                -webkit-overflow-scrolling: touch !important;
            }

            .tab-btn {
                flex: 1 1 0 !important;
                min-width: max-content !important;
                padding: 0.75rem 0.5rem !important;
                font-size: 0.65rem !important;
                border-bottom: 2px solid transparent !important;
                text-align: center !important;
                white-space: nowrap !important;
            }

            .tab-btn:last-child {
                border-bottom: 2px solid transparent !important;
            }

            .tab-btn.active {
                border-bottom-color: #C8A951 !important;
                background: rgba(200, 169, 81, 0.1) !important;
            }

            /* ===== TAB CONTENT - COMPACT PADDING ===== */
            .tab-content {
                padding: 0.75rem 0.625rem !important;
            }

            /* ============================================
               UNIFIED TYPOGRAPHY SCALE - Mobile (375px)
               Base: 11px (0.6875rem)
               Scale: 9px → 10px → 11px → 12px → 13px → 14px
               ============================================ */

            /* ===== LEVEL 1: Main Contract Heading (14px) ===== */
            .contract-main-heading {
                font-size: 0.875rem !important;
                line-height: 1.2 !important;
                margin-bottom: 0.25rem !important;
                letter-spacing: 0.01em !important;
            }

            .contract-gold-divider {
                width: 40px !important;
                margin: 0.375rem auto !important;
                height: 1px !important;
            }

            .contract-subtitle {
                font-size: 0.5rem !important;
                letter-spacing: 0.06em !important;
            }

            /* ===== LEVEL 2: Section Headings (13px) ===== */
            .sow-heading,
            .tab-content h2.text-6xl,
            [style*="font-size: 3.75rem"],
            h2[style*="font-size: 3.75rem"] {
                font-size: 0.8125rem !important;
                line-height: 1.2 !important;
                margin-bottom: 0.375rem !important;
            }

            /* Section titles like "1. Executive Overview" */
            .tab-content h2,
            .contract-immersive-wrapper h2,
            #cost h2 {
                font-size: 0.75rem !important;
                padding: 0 !important;
                margin-top: 0.625rem !important;
                margin-bottom: 0.375rem !important;
                line-height: 1.25 !important;
            }

            /* ===== LEVEL 3: Subsection headings (12px) ===== */
            .tab-content h3,
            .contract-immersive-wrapper h3,
            #cost h3 {
                font-size: 0.6875rem !important;
                margin-top: 0.5rem !important;
                margin-bottom: 0.25rem !important;
                line-height: 1.3 !important;
            }

            /* ===== LEVEL 4: Category headings (11px) ===== */
            .tab-content h4,
            #cost h4 {
                font-size: 0.625rem !important;
                margin-top: 0.375rem !important;
                margin-bottom: 0.25rem !important;
            }

            /* ===== BODY TEXT: Base (11px) ===== */
            .tab-content p,
            .tab-content li,
            .contract-immersive-wrapper p,
            #cost p,
            #cost li {
                font-size: 0.6875rem !important;
                line-height: 1.45 !important;
                margin-bottom: 0.25rem !important;
            }

            /* ===== LABELS & METADATA (9-10px) ===== */
            .tab-content .flex.flex-wrap.justify-center {
                flex-direction: row !important;
                flex-wrap: wrap !important;
                gap: 0.125rem 0.375rem !important;
                align-items: center !important;
                justify-content: center !important;
                padding: 0.25rem !important;
            }

            .tab-content .flex.flex-wrap.justify-center>div,
            .tab-content .flex.flex-wrap.justify-center span,
            .tab-content .flex.flex-wrap.justify-center strong {
                font-size: 0.5625rem !important;
            }

            /* ===== HERO CARD (Primary Objective) ===== */
            .neo-stat-card-hero,
            [style*="max-width: 55rem"] {
                padding: 0.5rem !important;
                margin: 0.375rem 0 !important;
                max-width: 100% !important;
            }

            .neo-stat-card-hero p,
            .neo-stat-card-hero div,
            .neo-stat-card-hero span {
                font-size: 0.625rem !important;
                line-height: 1.4 !important;
            }

            .neo-stat-card-hero [style*="letter-spacing"],
            .neo-stat-card-hero .uppercase {
                font-size: 0.5rem !important;
                letter-spacing: 0.1em !important;
            }

            /* ===== GRID LAYOUTS - SINGLE COLUMN ===== */
            /* 2-column grids to single */
            .grid-cols-2,
            .md\:grid-cols-2,
            [class*="grid-cols-2"],
            .grid.grid-cols-1.md\:grid-cols-2 {
                display: flex !important;
                flex-direction: column !important;
                gap: 0.5rem !important;
            }

            /* Plan grids */
            #cost .plan-grid-container,
            #selection-phase>div>div:last-child,
            .grid-cols-3,
            [style*="grid-template-columns: repeat(3"] {
                display: flex !important;
                flex-direction: column !important;
                gap: 0.5rem !important;
            }

            /* Plan cards - full width */
            .plan-card-static,
            .plan-card-interactive,
            #card-plan-a,
            #card-plan-b,
            #card-plan-c {
                width: 100% !important;
                margin-bottom: 0 !important;
            }

            /* Stat cards - horizontal scroll on mobile, keep 4 side by side */
            .grid-cols-4,
            [style*="grid-template-columns: repeat(4"],
            #cost>div:first-child {
                display: flex !important;
                flex-wrap: nowrap !important;
                overflow-x: auto !important;
                -webkit-overflow-scrolling: touch !important;
                gap: 0.375rem !important;
                padding-bottom: 0.25rem !important;
            }

            /* Stat card children - compact for horizontal scroll */
            #cost>div:first-child>div {
                flex: 0 0 110px !important;
                min-width: 110px !important;
                padding: 0.5rem 0.375rem !important;
            }

            /* Stat card values - scale down fonts */
            #cost>div:first-child>div [style*="font-size: 32px"],
            #cost>div:first-child>div [style*="font-size: 36px"] {
                font-size: 1rem !important;
            }

            #cost>div:first-child>div [style*="font-size: 14px"],
            #cost>div:first-child>div [style*="font-size: 16px"] {
                font-size: 0.5rem !important;
            }

            #cost>div:first-child>div [style*="font-size: 12px"] {
                font-size: 0.4rem !important;
            }

            /* Category cards (Identity, Probate, etc.) */
            .bg-white\/5.p-8,
            [class*="bg-white/5"][class*="p-8"] {
                padding: 0.625rem !important;
            }

            /* ===== LEGAL VIEWER ===== */
            .legal-viewer {
                padding: 0.625rem !important;
                font-size: 0.7rem !important;
                line-height: 1.5 !important;
            }

            .legal-viewer h2 {
                font-size: 0.85rem !important;
                margin-top: 1rem !important;
            }

            .legal-viewer h3 {
                font-size: 0.75rem !important;
            }

            .legal-scroll-box {
                max-height: 50vh !important;
                padding: 0.5rem !important;
            }

            /* ===== TABLES - HORIZONTAL SCROLL ===== */
            .legal-viewer table,
            #cost table,
            table {
                display: block !important;
                overflow-x: auto !important;
                -webkit-overflow-scrolling: touch !important;
                width: 100% !important;
                font-size: 0.75rem !important;
            }

            #cost table th,
            #cost table td,
            .tab-content table th,
            .tab-content table td {
                font-size: 0.75rem !important;
                padding: 0.5rem !important;
                white-space: nowrap !important;
            }

            /* Market analysis table - balanced mobile typography */
            #market-analysis-table {
                font-size: 0.6rem !important;
            }

            #market-analysis-table th {
                font-size: 0.5rem !important;
                padding: 0.375rem 0.25rem !important;
                letter-spacing: 0.02em !important;
            }

            /* First column header - METRIC label */
            #market-analysis-table th:nth-child(1) {
                font-size: 0.45rem !important;
            }

            /* Hero column header - FinalWishes */
            #market-analysis-table th:nth-child(2) {
                font-size: 0.55rem !important;
                color: #C8A951 !important;
            }

            /* Competitor headers */
            #market-analysis-table th:nth-child(3),
            #market-analysis-table th:nth-child(4) {
                font-size: 0.45rem !important;
                color: #94a3b8 !important;
            }

            #market-analysis-table td {
                font-size: 0.55rem !important;
                padding: 0.375rem 0.25rem !important;
            }

            /* Metric names - first column */
            #market-analysis-table td:nth-child(1) {
                font-size: 0.55rem !important;
                font-weight: 600 !important;
            }

            /* Hero values - FinalWishes column */
            #market-analysis-table td:nth-child(2) {
                font-size: 0.6rem !important;
                font-weight: 600 !important;
                color: white !important;
            }

            /* Competitor values - muted */
            #market-analysis-table td:nth-child(3),
            #market-analysis-table td:nth-child(4) {
                font-size: 0.5rem !important;
                color: #94a3b8 !important;
            }

            /* ===== ATOMIC BREAKDOWN - Unified Scale ===== */
            #cost .space-y-6>div h3 {
                font-size: 0.6875rem !important;
                font-weight: 600 !important;
            }

            #cost .space-y-6>div .text-right>div:first-child {
                font-size: 0.6875rem !important;
                font-weight: 500 !important;
            }

            #cost .space-y-6>div .text-xs,
            #cost .space-y-6>div .text-sm {
                font-size: 0.5625rem !important;
            }

            #cost .space-y-6>div table {
                font-size: 0.5625rem !important;
            }

            #cost .space-y-6>div table th,
            #cost .space-y-6>div table td {
                font-size: 0.5625rem !important;
                padding: 0.25rem 0.1875rem !important;
            }

            /* Cost tab - Unified text scale */
            #cost .text-xs {
                font-size: 0.5rem !important;
            }

            #cost .text-sm {
                font-size: 0.5625rem !important;
            }

            #cost .text-base {
                font-size: 0.625rem !important;
            }

            #cost .text-lg {
                font-size: 0.6875rem !important;
            }

            #cost .text-xl {
                font-size: 0.75rem !important;
            }

            #cost .text-2xl {
                font-size: 0.8125rem !important;
            }

            /* ===== STEP LABELS (MSA TAB) - Unified ===== */
            #step-1-label,
            #step-2-label,
            #step-3-label {
                padding: 0.5rem !important;
            }

            #step-1-label h2,
            #step-2-label h2,
            #step-2-plan-label,
            #step-3-label h2 {
                font-size: 0.75rem !important;
                letter-spacing: 0.01em !important;
            }

            #step-1-label p,
            #step-2-label p,
            #step-3-label p {
                font-size: 0.5625rem !important;
                line-height: 1.4 !important;
            }

            /* ===== ACKNOWLEDGMENT BLOCK ===== */
            #msa-acknowledgment-block {
                padding: 0.5rem !important;
            }

            #msa-acknowledgment-block label {
                font-size: 0.625rem !important;
                gap: 0.375rem !important;
                align-items: flex-start !important;
            }

            #msa-acknowledgment-block input[type="checkbox"] {
                width: 1rem !important;
                height: 1rem !important;
                flex-shrink: 0 !important;
                margin-top: 0.0625rem !important;
            }

            /* ===== SIGNATURE BLOCK ===== */
            #signature-block {
                padding: 0.5rem !important;
            }

            #signature-block table {
                display: flex !important;
                flex-direction: column !important;
            }

            #signature-block table tr {
                display: flex !important;
                flex-direction: column !important;
                margin-bottom: 1rem !important;
            }

            #signature-block table td {
                width: 100% !important;
                text-align: center !important;
                padding: 0.25rem 0 !important;
                font-size: 0.625rem !important;
            }

            /* ===== BUTTONS ===== */
            .select-plan-btn,
            #execute-btn,
            #proceed-to-step2,
            button.w-full {
                padding: 0.875rem 1rem !important;
                font-size: 0.8rem !important;
            }

            /* ===== WORKFLOW GUIDE - HIDE ON MOBILE ===== */
            #vertical-workflow-guide {
                display: none !important;
            }

            /* ===== MODAL - MOBILE ADJUSTMENTS ===== */
            .modal-overlay>div {
                max-width: 90vw !important;
                max-height: 90vh !important;
                overflow-y: auto !important;
                padding: 1.25rem !important;
            }

            .modal-overlay input {
                font-size: 0.875rem !important;
                padding: 0.625rem !important;
            }

            .modal-overlay h3 {
                font-size: 1.125rem !important;
            }

            .modal-overlay p {
                font-size: 0.75rem !important;
            }

            .modal-overlay button {
                font-size: 0.75rem !important;
                padding: 0.625rem 1rem !important;
            }

            /* ===== UTILITY OVERRIDES ===== */
            /* Max-width containers - full width on mobile */
            [style*="max-width: 600px"],
            [style*="max-width: 1000px"],
            [style*="max-width: 55rem"],
            [style*="max-width: 50rem"] {
                max-width: 100% !important;
            }

            /* Section margins - tighter */
            [style*="margin-bottom: 96px"] {
                margin-bottom: 2rem !important;
            }

            [style*="margin-bottom: 64px"] {
                margin-bottom: 1.5rem !important;
            }

            [style*="margin-bottom: 48px"] {
                margin-bottom: 1.25rem !important;
            }

            /* Allocation/summary text */
            #allocation-text {
                font-size: 0.875rem !important;
                padding: 0 0.5rem !important;
            }

            /* Header top area */
            .contract-immersive-wrapper>div:first-child {
                padding: 0.5rem !important;
                margin-bottom: 1rem !important;
            }

            /* Gold separator line */
            [style*="width: 128px"][style*="background: #C8A951"] {
                width: 64px !important;
                margin: 0.75rem auto !important;
            }
        }

        /* SMALL PHONE BREAKPOINT (480px and below) */
        @media (max-width: 480px) {

            /* Main heading even smaller */
            .contract-immersive-wrapper h1,
            [style*="font-size: 42px"] {
                font-size: 1.125rem !important;
            }

            /* SOW title */
            .tab-content h2.text-6xl {
                font-size: 1rem !important;
            }

            /* Stat cards - single column */
            .grid-cols-4,
            [style*="grid-template-columns: repeat(4"],
            .grid-cols-2 {
                grid-template-columns: 1fr !important;
            }

            /* Even smaller fonts */
            .legal-viewer {
                font-size: 0.8rem !important;
            }

            .legal-viewer h2 {
                font-size: 1rem !important;
            }

            /* Tab buttons */
            .tab-btn {
                font-size: 0.7rem !important;
                padding: 0.625rem 0.75rem !important;
            }

            /* Very tight padding */
            .tab-content {
                padding: 0.875rem 0.75rem !important;
            }

            /* Body text */
            .tab-content p,
            .tab-content li {
                font-size: 0.8rem !important;
            }

            /* Tables even smaller */
            table th,
            table td {
                font-size: 0.65rem !important;
                padding: 0.375rem !important;
            }
        }
    </style>

    <!-- Note: PDF generation now uses browser's native print dialog with @media print CSS -->
    <!-- Future: OpenSign API will provide server-side PDF generation for signed documents -->
</head>

<body>
    <div class="admin-wrapper">
        <!-- Sidebar Component -->
        <div id="sidebar-root" data-active="proposal-contract"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header Component -->
            <header id="universal-header-root" data-title="Proposal & Contract"
                data-subtitle="FinalWishes • Strategic Partnership Agreement"
                data-search-placeholder="Search contract terms..."></header>

            <!-- Immersive Contract View -->
            <div id="contract-immersive-wrapper" class="contract-immersive-wrapper pb-48">

                <!-- Header Component -->
                <div class="flex flex-col items-center justify-center mb-20 pt-10 px-4 relative w-full mx-auto">

                    <!-- Title -->
                    <div class="contract-title-wrapper"
                        style="text-align: center; width: 100%; margin: 0 auto; display: flex; flex-direction: column; align-items: center;">
                        <h1 id="main-contract-heading" class="contract-main-heading">
                            Technical Partnership Agreement
                        </h1>
                        <div class="contract-gold-divider"></div>
                        <p id="proposal-subtitle" class="contract-subtitle">
                            Prepared for Tameeka Lockhart • <span id="date-proposal"></span>
                        </p>
                    </div>
                </div>

                <div class="main-card">

                    <!-- TABS -->
                    <div class="nav-tabs">
                        <button class="tab-btn active" onclick="switchTab('sow')">Statement of Work</button>
                        <button class="tab-btn" onclick="switchTab('cost')">Cost & Valuation</button>
                        <button class="tab-btn" onclick="switchTab('contract')">Master Agreement (MSA)</button>
                    </div>

                    <!-- TAB 1: SOW -->
                    <div id="sow" class="tab-content active text-blue-100"
                        style="padding-top: 1rem !important; position: relative;">
                        <div class="grid grid-cols-12 gap-12">
                            <div class="col-span-12">
                                <!-- HEADER -->
                                <div class="border-b border-white/10 pb-6 mb-8 text-center">
                                    <h2 id="sow-main-heading"
                                        class="text-6xl text-[#C8A951] mb-6 font-serif uppercase tracking-wider font-bold sow-heading">
                                        Statement of Work (SOW)</h2>
                                    <div class="flex flex-wrap justify-center gap-8 text-sm font-mono text-blue-300">
                                        <div><strong class="text-white">Project:</strong> FinalWishes Platform
                                            Development</div>
                                        <div><strong class="text-white">Date:</strong> <span id="date-sow"></span></div>
                                        <div><strong class="text-white">Ref:</strong> SOW-<span
                                                id="year-ref"></span>-001</div>
                                        <div><strong class="text-white">MSA:</strong> MSA-<span
                                                id="year-msa"></span>-111-FW</div>
                                    </div>
                                </div>

                                <!-- 1. EXECUTIVE OVERVIEW -->
                                <h2
                                    class="text-[#C8A951] mt-12 mb-8 text-3xl font-extrabold uppercase tracking-widest text-center">
                                    1. Executive Overview</h2>

                                <!-- PRIMARY OBJECTIVE (HERO CARD STYLE) -->
                                <div class="neo-stat-card-hero"
                                    style="background: rgba(255, 255, 255, 0.03) !important; border: 2px solid rgba(200, 169, 81, 0.6) !important; border-radius: 8px !important; box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.3) !important; margin: 2rem auto 2rem auto !important; padding: 2rem 3rem !important; text-align: center !important; max-width: 55rem !important;">
                                    <div class="uppercase neo-text-gold font-bold"
                                        style="font-size: 0.85rem !important; letter-spacing: 0.25em !important; color: #C8A951 !important; margin-bottom: 1rem !important;">
                                        Primary Objective
                                    </div>
                                    <p
                                        style="font-family: 'Inter', sans-serif !important; font-size: 1.1rem !important; line-height: 1.7 !important; font-weight: 400 !important; max-width: 50rem !important; margin: 0 auto !important; color: rgba(255, 255, 255, 0.95) !important;">
                                        Deliver a dual-purpose platform that empowers the Living to
                                        <span style="color: #C8A951 !important; font-weight: 600 !important;">Curate
                                            their Legacy</span>
                                        (Memories & Wishes) and equips their Loved Ones to
                                        <span style="color: #C8A951 !important; font-weight: 600 !important;">Automate
                                            the Estate</span>
                                        (Probate & Assets).
                                    </p>
                                </div>


                                <p class="mb-8 text-lg leading-relaxed"
                                    style="text-align: left !important; font-family: 'Inter', sans-serif !important; font-size: 1.125rem !important; line-height: 1.75 !important; color: rgba(255, 255, 255, 0.9) !important; margin-top: 2rem !important;">
                                    This Statement of Work
                                    ("SOW") defines the comprehensive scope for the
                                    <strong>FinalWishes Estate Operating System</strong>. While competent estate
                                    management is critical, <strong>FinalWishes is not merely a probate tool.</strong>
                                    It is a Legacy Management Application designed to capture the "Soul" of the
                                    Principal—their memories, values, and final messages—before dealing with the
                                    "Administration" of their assets.
                                </p>

                                <p class="mb-12 text-lg leading-relaxed"
                                    style="text-align: left !important; font-family: 'Inter', sans-serif !important; font-size: 1.125rem !important; line-height: 1.75 !important; color: rgba(255, 255, 255, 0.9) !important;">
                                    We serve the <strong>Human</strong> first and the <strong>Process</strong> second.
                                    By curating the emotional legacy of the soon-to-be-deceased, we effectively arm the
                                    Executor not just with legal documents, but with the moral authority and clear
                                    instructions needed to protect the family from conflict.
                                </p>



                                <!-- 2. DETAILED SCOPE -->
                                <h2 class="text-[#C8A951] mt-12 mb-6">2. Detailed Scope of Services</h2>

                                <!-- 2.1 -->
                                <h3
                                    class="text-blue-300 text-sm tracking-[0.2em] uppercase font-sans font-bold mb-6 border-b border-white/10 pb-2 mt-12">
                                    2.1 Core Vault & Data Architecture</h3>
                                <p class="mb-4">Provider shall implement a <strong>Multi-Tenant, Zero-Knowledge</strong>
                                    architecture to ensure total data privacy.</p>
                                <ul class="list-disc pl-6 mb-12 text-blue-200 space-y-4 text-base leading-relaxed">
                                    <li><strong class="text-white">Storage Layer:</strong> Hybrid approach using
                                        <strong>Cloud SQL (PostgreSQL)</strong> for structured PII (Encrypted) and
                                        <strong>Firestore</strong> for real-time document metadata.
                                    </li>
                                    <li><strong class="text-white">File Vault:</strong> <strong>Cloud Storage</strong>
                                        buckets with per-tenant isolation boundaries. All files encrypted at rest using
                                        <strong>Cloud
                                            KMS</strong> (AES-256).
                                    </li>
                                    <li><strong class="text-white">Security:</strong> Implementation of <strong>SOC 2
                                            Type II</strong> controls, including strict IAM roles, audit logging, and
                                        encryption in transit (TLS 1.3).
                                    </li>
                                </ul>

                                <!-- 2.2 -->
                                <h3
                                    class="text-blue-300 text-sm tracking-[0.2em] uppercase font-sans font-bold mb-6 border-b border-white/10 pb-2 mt-16">
                                    2.2 Document Inventory & Automation</h3>
                                <p class="mb-8">Provider will build automation or manual guidance paths for the
                                    following specific document categories:</p>

                                <!-- Grid Layout for Categories (BALANCED 2x2) -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">

                                    <!-- A: Identity -->
                                    <div
                                        class="bg-white/5 p-8 rounded-lg border border-white/5 hover:border-[#C8A951]/30 transition-colors">
                                        <h4 class="text-[#C8A951] font-bold mb-4 text-lg border-b border-white/10 pb-2">
                                            A. Identity & Vital Records</h4>
                                        <ul class="list-disc pl-5 text-sm text-blue-200 space-y-3">
                                            <li><strong class="text-white">Death Certificate:</strong> Manual upload/OCR
                                                processing.</li>
                                            <li><strong class="text-white">Social Security:</strong> Secure entry &
                                                validation.</li>
                                            <li><strong class="text-white">Driver's License:</strong> Identity
                                                verification scan.</li>
                                        </ul>
                                    </div>

                                    <!-- B: Probate Court -->
                                    <div
                                        class="bg-white/5 p-8 rounded-lg border border-white/5 hover:border-[#C8A951]/30 transition-colors">
                                        <h4 class="text-[#C8A951] font-bold mb-4 text-lg border-b border-white/10 pb-2">
                                            B. Probate Court Filings</h4>
                                        <ul class="list-disc pl-5 text-sm text-blue-200 space-y-3">
                                            <li><strong class="text-white">Maryland:</strong> Integration/Guidance for
                                                <strong>MDEC</strong>.
                                            </li>
                                            <li><strong class="text-white">Illinois:</strong> Guidance for
                                                <strong>eCourt</strong> (Cook County).
                                            </li>
                                            <li><strong class="text-white">Minnesota:</strong> Guidance for
                                                <strong>MNCIS</strong>.
                                            </li>
                                        </ul>
                                    </div>

                                    <!-- C: Financial Assets (Split) -->
                                    <div
                                        class="bg-white/5 p-8 rounded-lg border border-white/5 hover:border-[#C8A951]/30 transition-colors">
                                        <h4 class="text-[#C8A951] font-bold mb-4 text-lg border-b border-white/10 pb-2">
                                            C. Financial Assets</h4>
                                        <ul class="list-disc pl-5 text-sm text-blue-200 space-y-3">
                                            <li><strong class="text-white">Asset Discovery:</strong> Plaid integration
                                                (12,000+ institutions).</li>
                                            <li><strong class="text-white">Bank Accounts:</strong> Balance checks &
                                                beneficiary validation.</li>
                                            <li><strong class="text-white">Investments:</strong> Portfolio valuation
                                                snapshots.</li>
                                        </ul>
                                    </div>

                                    <!-- D: Property & Insurance (New) -->
                                    <div
                                        class="bg-white/5 p-8 rounded-lg border border-white/5 hover:border-[#C8A951]/30 transition-colors">
                                        <h4 class="text-[#C8A951] font-bold mb-4 text-lg border-b border-white/10 pb-2">
                                            D. Property & Insurance</h4>
                                        <ul class="list-disc pl-5 text-sm text-blue-200 space-y-3">
                                            <li><strong class="text-white">Real Estate:</strong> Zillow/Redfin valuation
                                                integration.</li>
                                            <li><strong class="text-white">Life Insurance:</strong> "Notice of Death"
                                                generation.</li>
                                            <li><strong class="text-white">Personal Property:</strong> Inventory logic &
                                                photo vault.</li>
                                        </ul>
                                    </div>
                                </div>

                                <!-- 2.3 MEMORY VAULT (NEW) -->
                                <h3
                                    class="text-blue-300 text-sm tracking-[0.2em] uppercase font-sans font-bold mb-6 border-b border-white/10 pb-2 mt-16">
                                    2.3 The Legacy & Memory Vault</h3>
                                <p class="mb-4">Provider shall build the "Soul" of the platform—a secure, dedicated
                                    module for preserving the Principal's non-financial legacy.</p>
                                <ul class="list-disc pl-6 mb-12 text-blue-200 space-y-4 text-base leading-relaxed">
                                    <li><strong class="text-white">Time-Capsule Messages:</strong> Logic to record
                                        video/text messages delivered only upon verified death or specific future dates.
                                    </li>
                                    <li><strong class="text-white">Ethical Will:</strong> Digital curation of values,
                                        life lessons, and hopes for heirs (distinct from legal wills).</li>
                                    <li><strong class="text-white">The "Final Wish":</strong> Structured intake of
                                        funeral preferences, burial/cremation desires, and "How I want to be remembered"
                                        directives.</li>
                                </ul>

                                <!-- 2.4 System Integrations -->
                                <h3
                                    class="text-blue-300 text-sm tracking-[0.2em] uppercase font-sans font-bold mb-6 border-b border-white/10 pb-2 mt-16">
                                    2.4 System Integrations</h3>
                                <div class="overflow-x-auto mb-12 bg-white/5 rounded-lg border border-white/5 p-4">
                                    <table class="w-full text-left border-collapse">
                                        <thead>
                                            <tr class="border-b border-white/20 text-[#C8A951]">
                                                <th class="p-3">Service</th>
                                                <th class="p-3">Purpose</th>
                                                <th class="p-3">Integration Level</th>
                                            </tr>
                                        </thead>
                                        <tbody class="text-sm text-slate-200" style="color: #e2e8f0;">
                                            <tr class="border-b border-white/5 bg-white/5">
                                                <td class="p-3 font-bold">Plaid</td>
                                                <td class="p-3">Financial Account Linking</td>
                                                <td class="p-3">Deep Integration (Transactions, Liabilities)</td>
                                            </tr>
                                            <tr class="border-b border-white/5">
                                                <td class="p-3 font-bold">OpenSign</td>
                                                <td class="p-3">E-Signatures</td>
                                                <td class="p-3">Self-Hosted (Full API)</td>
                                            </tr>
                                            <tr class="border-b border-white/5 bg-white/5">
                                                <td class="p-3 font-bold">Lob</td>
                                                <td class="p-3">Certified Mail / Physical Letters</td>
                                                <td class="p-3">API Triggered (Tracking)</td>
                                            </tr>
                                            <tr class="border-b border-white/5">
                                                <td class="p-3 font-bold">SendGrid</td>
                                                <td class="p-3">Transactional Email</td>
                                                <td class="p-3">API Triggered (Notifications)</td>
                                            </tr>
                                            <tr class="border-b border-white/5 bg-white/5">
                                                <td class="p-3 font-bold">Google Document AI</td>
                                                <td class="p-3">OCR / Data Extraction</td>
                                                <td class="p-3">API Integrated (Receipts, Forms)</td>
                                            </tr>
                                            <tr class="border-b border-white/5">
                                                <td class="p-3 font-bold">Vertex AI</td>
                                                <td class="p-3">Process Guidance</td>
                                                <td class="p-3">Context-Aware (RAG pipeline)</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <!-- 2.5 The Shepherd -->
                                <h3
                                    class="text-blue-300 text-sm tracking-[0.2em] uppercase font-sans font-bold mb-6 border-b border-white/10 pb-2 mt-16">
                                    2.5 "The Shepherd" Guidance Engine</h3>

                                <div class="bg-white/5 p-8 rounded-lg border border-white/5 mb-12">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                        <div class="flex gap-4">
                                            <div class="text-[#C8A951] pt-1">
                                                <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10">
                                                    </path>
                                                </svg>
                                            </div>
                                            <div>
                                                <h4 class="text-white font-bold mb-1">Ingests State Laws</h4>
                                                <p class="text-sm text-blue-200">Encodes complex probate timing rules
                                                    for MD, IL, and MN directly into the workflow engine.</p>
                                            </div>
                                        </div>
                                        <div class="flex gap-4">
                                            <div class="text-[#C8A951] pt-1">
                                                <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z">
                                                    </path>
                                                </svg>
                                            </div>
                                            <div>
                                                <h4 class="text-white font-bold mb-1">Generates Timeline</h4>
                                                <p class="text-sm text-blue-200">Creates a dynamic, 18-month Gantt chart
                                                    customized for the specific Estate topology.</p>
                                            </div>
                                        </div>
                                        <div class="flex gap-4">
                                            <div class="text-[#C8A951] pt-1">
                                                <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M15 17h5l-1.405-1.405A2.032 2 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9">
                                                    </path>
                                                </svg>
                                            </div>
                                            <div>
                                                <h4 class="text-white font-bold mb-1">Proactive Alerts</h4>
                                                <p class="text-sm text-blue-200">Notifies Executors of upcoming court
                                                    deadlines via Email & Push notifications.</p>
                                            </div>
                                        </div>
                                        <div class="flex gap-4">
                                            <div class="text-[#C8A951] pt-1">
                                                <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                                </svg>
                                            </div>
                                            <div>
                                                <h4 class="text-white font-bold mb-1">AI Assistance</h4>
                                                <p class="text-sm text-blue-200">Uses Gemini 3.0 to answer
                                                    context-specific questions based on the uploaded documents.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 3. WBS -->
                                <h2
                                    class="text-[#C8A951] mt-12 mb-8 text-3xl font-extrabold uppercase tracking-widest text-center">
                                    3. Work Breakdown Structure (WBS)</h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                                    <!-- PHASE 0 -->
                                    <div class="bg-white/5 p-8 rounded border border-[#C8A951]/30">
                                        <div class="flex justify-between items-center mb-6">
                                            <h4 class="text-white text-lg font-bold uppercase">PHASE 0: DESIGN &
                                                IDENTITY</h4>
                                            <span
                                                class="text-xs font-mono text-[#C8A951] border border-[#C8A951] px-2 py-1 rounded">WEEKS
                                                1-4</span>
                                        </div>
                                        <ul class="space-y-4 text-sm text-blue-200 list-disc pl-5">
                                            <li><strong class="text-white">0.1 Brand Identity:</strong> Logo,
                                                Typography, Palette finalization.</li>
                                            <li><strong class="text-white">0.2 UX/UI Design System:</strong>
                                                Figma-based
                                                Web + Mobile design system.</li>
                                            <li><strong class="text-white">0.3 Prototyping:</strong> High-fidelity
                                                interaction models.</li>
                                            <li><strong class="text-white">0.4 Asset Production:</strong> Custom
                                                icons
                                                and illustrations.</li>
                                        </ul>
                                    </div>
                                    <!-- PHASE 1 -->
                                    <div class="bg-white/5 p-8 rounded border border-[#C8A951]/30">
                                        <div class="flex justify-between items-center mb-6">
                                            <h4 class="text-white text-lg font-bold">PHASE 1: FOUNDATION & VAULT
                                            </h4>
                                            <span
                                                class="text-xs font-mono text-[#C8A951] border border-[#C8A951] px-2 py-1 rounded">WEEKS
                                                1-4</span>
                                        </div>
                                        <ul class="space-y-4 text-sm text-blue-200 list-disc pl-5">
                                            <li><strong class="text-white">1.1 GCP Infrastructure:</strong>
                                                Provision
                                                Cloud Run, Cloud SQL, Firestore, VPC.</li>
                                            <li><strong class="text-white">1.2 Ops:</strong> Setup GitHub Actions
                                                CI/CD
                                                workflows.</li>
                                            <li><strong class="text-white">1.3 Auth:</strong> Firebase Auth + MFA +
                                                Custom Claims.</li>
                                            <li><strong class="text-white">1.4 Schema:</strong> Design Relational
                                                (Heirs) vs Document (Metadata).</li>
                                            <li><strong class="text-white">1.5 Vault:</strong> Implement AES-256
                                                crypto
                                                service.</li>
                                            <li><strong class="text-white">1.6 Web:</strong> React + Vite + "Light
                                                Royal
                                                Neo-Deco" Design.</li>
                                            <li><strong class="text-white">1.7 E-Sign:</strong> Deploy Self-Hosted
                                                OpenSign.</li>
                                        </ul>
                                    </div>

                                    <!-- PHASE 2 -->
                                    <div class="bg-white/5 p-8 rounded border border-white/10">
                                        <div class="flex justify-between items-center mb-6">
                                            <h4 class="text-white text-lg font-bold">PHASE 2: CORE LOGIC & STATE
                                                ENGINES
                                            </h4>
                                            <span
                                                class="text-xs font-mono text-blue-300 border border-blue-300 px-2 py-1 rounded">WEEKS
                                                5-10</span>
                                        </div>
                                        <ul class="space-y-4 text-sm text-blue-200 list-disc pl-5">
                                            <li><strong class="text-white">2.1 Asset Module:</strong> Plaid Link
                                                integration & data overrides.</li>
                                            <li><strong class="text-white">2.2 Maryland Engine:</strong> Encode MD
                                                Register of Wills rules.</li>
                                            <li><strong class="text-white">2.3 Illinois Engine:</strong> Encode IL
                                                Probate Division rules.</li>
                                            <li><strong class="text-white">2.4 Minnesota Engine:</strong> Encode MN
                                                District Court rules.</li>
                                            <li><strong class="text-white">2.5 Gemini RAG:</strong> Build vector
                                                store
                                                for legal context.</li>
                                            <li><strong class="text-white">2.6 PDF Service:</strong> Go-based PDF
                                                stamper for court forms.</li>
                                        </ul>
                                    </div>

                                    <!-- PHASE 3 -->
                                    <div class="bg-white/5 p-8 rounded border border-white/10">
                                        <div class="flex justify-between items-center mb-6">
                                            <h4 class="text-white text-lg font-bold">PHASE 3: MOBILE & DEEP
                                                INTEGRATIONS
                                            </h4>
                                            <span
                                                class="text-xs font-mono text-blue-300 border border-blue-300 px-2 py-1 rounded">WEEKS
                                                11-16</span>
                                        </div>
                                        <ul class="space-y-4 text-sm text-blue-200 list-disc pl-5">
                                            <li><strong class="text-white">3.1 React Native:</strong> Initialize
                                                iOS/Android Expo project.</li>
                                            <li><strong class="text-white">3.2 Camera/Scan:</strong> Implement
                                                document
                                                scanner in mobile app.</li>
                                            <li><strong class="text-white">3.3 Biometrics:</strong> Enable
                                                FaceID/TouchID for Vault access.</li>
                                            <li><strong class="text-white">3.4 Push:</strong> Integrate
                                                Notifications
                                                for timeline alerts.</li>
                                            <li><strong class="text-white">3.5 Lob:</strong> Physical mail API
                                                integration.</li>
                                            <li><strong class="text-white">3.6 SendGrid:</strong> Transactional
                                                email
                                                templates.</li>
                                        </ul>
                                    </div>

                                    <!-- PHASE 4 -->
                                    <div class="bg-white/5 p-8 rounded border border-white/10">
                                        <div class="flex justify-between items-center mb-6">
                                            <h4 class="text-white text-lg font-bold">PHASE 4: AUDIT, SECURITY &
                                                LAUNCH
                                            </h4>
                                            <span
                                                class="text-xs font-mono text-blue-300 border border-blue-300 px-2 py-1 rounded">WEEKS
                                                17-20</span>
                                        </div>
                                        <ul class="space-y-4 text-sm text-blue-200 list-disc pl-5">
                                            <li><strong class="text-white">4.1 Pen Test:</strong> Third-party
                                                security
                                                audit.</li>
                                            <li><strong class="text-white">4.2 Compliance:</strong> SOC 2 evidence
                                                collection.</li>
                                            <li><strong class="text-white">4.3 Load Test:</strong> Stress testing
                                                (k6)
                                                to 1,000 users.</li>
                                            <li><strong class="text-white">4.4 Store Launch:</strong> App Store &
                                                Play
                                                Store submission.</li>
                                            <li><strong class="text-white">4.5 Go-Live:</strong> DNS switchover and
                                                Production migration.</li>
                                        </ul>
                                    </div>

                                    <!-- PHASE 5 -->
                                    <div class="bg-white/5 p-8 rounded border border-white/10">
                                        <div class="flex justify-between items-center mb-6">
                                            <h4 class="text-white text-lg font-bold uppercase">PHASE 5: CONTINGENCY
                                                &
                                                PROJECT MANAGEMENT</h4>
                                            <span
                                                class="text-xs font-mono text-blue-300 border border-blue-300 px-2 py-1 rounded">ONGOING</span>
                                        </div>
                                        <ul class="space-y-4 text-sm text-blue-200 list-disc pl-5">
                                            <li><strong class="text-white">5.1 PM:</strong> Weekly client syncing
                                                and
                                                project management.</li>
                                            <li><strong class="text-white">5.2 Manual QA:</strong> Cross-platform
                                                manual
                                                verification.</li>
                                            <li><strong class="text-white">5.3 Iteration:</strong> Refinements based
                                                on
                                                user feedback.</li>
                                            <li><strong class="text-white">5.4 Support:</strong> Post-launch
                                                stabilization.</li>
                                        </ul>
                                    </div>
                                </div>

                                <!-- 4. DELIVERABLES -->
                                <h2 class="text-[#C8A951] mt-12 mb-8">4. Deliverables</h2>
                                <div class="overflow-x-auto mb-24 bg-white/5 rounded-lg border border-white/5 p-4">
                                    <table class="w-full text-left border-collapse">
                                        <thead>
                                            <tr class="border-b border-white/20 text-[#C8A951]">
                                                <th class="p-4">Deliverable</th>
                                                <th class="p-4">Description</th>
                                                <th class="p-4">Format</th>
                                            </tr>
                                        </thead>
                                        <tbody class="text-sm text-slate-200">
                                            <tr class="border-b border-white/5">
                                                <td class="p-4 font-bold">D1: The Vault</td>
                                                <td class="p-4">Security core, Auth, Encrypted Storage</td>
                                                <td class="p-4">Staging URL</td>
                                            </tr>
                                            <tr class="border-b border-white/5">
                                                <td class="p-4 font-bold">D2: State Engines</td>
                                                <td class="p-4">Form generation for MD, IL, MN</td>
                                                <td class="p-4">API + UI</td>
                                            </tr>
                                            <tr class="border-b border-white/5">
                                                <td class="p-4 font-bold">D3: Mobile Apps</td>
                                                <td class="p-4">iOS and Android binaries (TestFlight)</td>
                                                <td class="p-4">.ipa / .apk</td>
                                            </tr>
                                            <tr class="border-b border-white/5">
                                                <td class="p-4 font-bold">D4: The Platform</td>
                                                <td class="p-4">Production release, fully tested</td>
                                                <td class="p-4">Live URL</td>
                                            </tr>
                                            <tr class="border-b border-white/5">
                                                <td class="p-4 font-bold">D5: Documentation</td>
                                                <td class="p-4">API Specs, Admin Guide, Compliance Pack</td>
                                                <td class="p-4">PDF / Markdown</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <!-- 5. ASSUMPTIONS -->
                                <h2 class="text-[#C8A951] mt-12 mb-6">5. Assumptions</h2>
                                <div class="bg-white/5 p-8 rounded-lg border border-white/5">
                                    <ul class="list-disc pl-6 text-blue-200 space-y-4">
                                        <li><strong>Launch States Only:</strong> Logic is strictly limited to
                                            Maryland,
                                            Illinois, and Minnesota for V1.</li>
                                        <li><strong>No Legal Advice:</strong> The "Shepherd" provides procedural
                                            guidance,
                                            not legal advice. Disclaimer implementation is mandatory.</li>
                                        <li><strong>Third-Party Costs:</strong> Client pays direct consumption costs
                                            for
                                            Plaid, Lob, and Cloud IDs.</li>
                                        <li><strong>Content:</strong> Client is responsible for final validation of
                                            court
                                            form templates.</li>
                                    </ul>
                                </div>

                                <!-- NEXT BUTTON (SOW -> COST) -->
                                <div class="w-full mt-16 mb-12 relative z-10"
                                    style="display: flex; justify-content: flex-end;">
                                    <button onclick="switchTab('cost')"
                                        class="group relative inline-flex items-center justify-center gap-3 h-11 px-6 overflow-hidden bg-gradient-to-r from-[#D4AF37] to-[#C8A951] text-[#050b14] shadow-[0_4px_20px_rgba(200,169,81,0.4)] hover:shadow-[0_0_40px_rgba(200,169,81,0.8)] transition-all duration-500 ease-out border border-[#C8A951] rounded-sm">

                                        <!-- TEXT -->
                                        <span
                                            class="relative z-10 font-serif font-bold text-sm tracking-[0.15em] uppercase">
                                            Next
                                        </span>

                                        <!-- ICON (Elegant Arrow) -->
                                        <svg class="w-4 h-4 relative z-10 transform group-hover:translate-x-1 transition-transform duration-300"
                                            fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3">
                                            </path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB 2: COST -->
                <div id="cost" class="tab-content" style="padding-top: 1rem !important; position: relative;">
                    <!-- TOP STATS - INLINE STYLES TO OVERRIDE CSS -->
                    <div
                        style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 24px; margin-bottom: 48px; max-width: 1200px; margin-left: auto; margin-right: auto;">

                        <!-- True Market Value -->
                        <div
                            style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 8px; padding: 32px 24px; text-align: center;">
                            <div
                                style="font-size: 14px; color: #C8A951; text-transform: uppercase; letter-spacing: 0.2em; margin-bottom: 12px; font-weight: 500;">
                                True Market Value</div>
                            <div
                                style="font-size: 32px; font-family: Cinzel, serif; color: #94a3b8; text-decoration: line-through; font-weight: 400;">
                                $650k+</div>
                            <div
                                style="font-size: 12px; color: white; text-transform: uppercase; letter-spacing: 0.15em; margin-top: 8px;">
                                Big Law Comparable</div>
                        </div>

                        <!-- Fixed Bid Price - HERO -->
                        <div
                            style="background: rgba(200,169,81,0.08); border: 2px solid #C8A951; border-radius: 8px; padding: 32px 24px; text-align: center; box-shadow: 0 0 40px rgba(200,169,81,0.15);">
                            <div
                                style="font-size: 16px; color: #C8A951; text-transform: uppercase; letter-spacing: 0.25em; margin-bottom: 12px; font-weight: 600;">
                                Fixed Bid Price</div>
                            <div style="font-size: 36px; font-family: Cinzel, serif; color: white; font-weight: 600;">
                                $200,000</div>
                        </div>

                        <!-- Sirsi Efficiency -->
                        <div
                            style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 8px; padding: 32px 24px; text-align: center;">
                            <div
                                style="font-size: 14px; color: #C8A951; text-transform: uppercase; letter-spacing: 0.2em; margin-bottom: 12px; font-weight: 500;">
                                Sirsi Efficiency</div>
                            <div style="font-size: 32px; font-family: Cinzel, serif; color: #10b981; font-weight: 400;">
                                Included</div>
                            <div
                                style="font-size: 12px; color: white; text-transform: uppercase; letter-spacing: 0.15em; margin-top: 8px;">
                                SOC 2, Auth, Vault Core</div>
                        </div>

                        <!-- Total Hours -->
                        <div
                            style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 8px; padding: 32px 24px; text-align: center;">
                            <div
                                style="font-size: 14px; color: #C8A951; text-transform: uppercase; letter-spacing: 0.2em; margin-bottom: 12px; font-weight: 500;">
                                Total Hours</div>
                            <div style="font-size: 32px; font-family: Cinzel, serif; color: white; font-weight: 400;">
                                925+</div>
                            <div
                                style="font-size: 12px; color: white; text-transform: uppercase; letter-spacing: 0.15em; margin-top: 8px;">
                                Direct Engineering Output</div>
                        </div>
                    </div>

                    <!-- 1. COMPARATIVE MARKET ANALYSIS -->
                    <div class="mb-20">
                        <div class="flex items-center gap-4 mb-8">
                            <div class="h-px bg-white/10 flex-1"></div>
                            <h2 class="text-3xl font-serif text-[#C8A951] uppercase tracking-widest">1.
                                Comparative
                                Market Analysis</h2>
                            <div class="h-px bg-white/10 flex-1"></div>
                        </div>

                        <table id="market-analysis-table">
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>FinalWishes (111 VS)</th>
                                    <th>"Big Law" Custom Tech</th>
                                    <th>Typical Dev Agency</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Total Cost</td>
                                    <td class="u-text-emerald">$200,000 (Fixed)</td>
                                    <td>$650,000+</td>
                                    <td>$350,000+</td>
                                </tr>
                                <tr>
                                    <td>Time to Market</td>
                                    <td class="u-text-gold">5 Months</td>
                                    <td>18-24 Months</td>
                                    <td>9-12 Months</td>
                                </tr>
                                <tr>
                                    <td>Model</td>
                                    <td>Co-Founder/Partner</td>
                                    <td>Billable Hour ($800/hr)</td>
                                    <td>Time & Materials</td>
                                </tr>
                                <tr>
                                    <td>IP Ownership</td>
                                    <td class="u-text-emerald">100% Client Owned</td>
                                    <td>Firm Retains IP</td>
                                    <td>Vendor Lock-in</td>
                                </tr>
                                <tr>
                                    <td>Security</td>
                                    <td>SOC 2 Type II Ready</td>
                                    <td>"Enterprise" bloat</td>
                                    <td>Basic / Afterthought</td>
                                </tr>
                                <tr>
                                    <td>AI Capability</td>
                                    <td>Gemini 3.0 Native</td>
                                    <td>None / Rigid Logic</td>
                                    <td>Generic Chatbot</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- 2. ATOMIC DEVELOPMENT BREAKDOWN -->
                    <div style="margin-bottom: 80px;">
                        <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 32px;">
                            <div style="height: 1px; background: rgba(255,255,255,0.1); flex: 1;"></div>
                            <h2
                                style="font-size: 28px; font-family: Cinzel, serif; color: #C8A951; text-transform: uppercase; letter-spacing: 0.15em;">
                                2. Atomic Development Breakdown</h2>
                            <div style="height: 1px; background: rgba(255,255,255,0.1); flex: 1;"></div>
                        </div>
                        <div
                            style="width: 100%; text-align: center; display: flex; justify-content: center; margin-bottom: 48px;">
                            <p id="allocation-text" style="text-align: center !important; margin: 0;">
                                Transparent allocation of <strong style="color: white;">925 hours</strong>
                                across 6
                                key phases.
                            </p>
                        </div>

                        <div
                            style="display: flex; flex-direction: column; gap: 24px; max-width: 900px; margin: 0 auto;">
                            <!-- PHASE 0 -->
                            <div
                                style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 12px; overflow: hidden;">
                                <div style="padding: 24px 32px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; background: rgba(255,255,255,0.03);"
                                    onclick="this.nextElementSibling.classList.toggle('hidden')">
                                    <div style="display: flex; align-items: center; gap: 24px;">
                                        <div
                                            style="height: 48px; width: 48px; border-radius: 4px; background: rgba(200,169,81,0.1); border: 1px solid #C8A951; display: flex; align-items: center; justify-content: center; color: #C8A951; font-family: Cinzel, serif; font-weight: bold; font-size: 20px;">
                                            0</div>
                                        <div>
                                            <h3
                                                style="color: white; font-weight: 600; font-size: 24px; font-family: Cinzel, serif; margin: 0;">
                                                Design & Identity</h3>
                                            <p
                                                style="color: #C8A951; text-transform: uppercase; letter-spacing: 0.1em; font-size: 14px; margin: 4px 0 0 0;">
                                                Weeks 1-4 • 200 Hours</p>
                                        </div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div
                                            style="font-size: 24px; font-weight: bold; color: white; font-family: Cinzel, serif;">
                                            $30,000</div>
                                        <div style="font-size: 14px; color: #C8A951;">Allocated Value</div>
                                    </div>
                                </div>
                                <div class="hidden"
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding: 24px 32px; background: rgba(0,0,0,0.2);">
                                    <table
                                        style="width: 100%; font-size: 24px; text-align: center; border-collapse: collapse;">
                                        <tr style="color: white; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th style="padding-bottom: 16px; text-align: center;">Activity</th>
                                            <th style="padding-bottom: 16px; text-align: center;">Role</th>
                                            <th style="padding-bottom: 16px; text-align: center;">Hrs</th>
                                            <th style="padding-bottom: 16px; text-align: center;">Cost</th>
                                        </tr>
                                        <tr>
                                            <td style="padding: 16px 0; color: white; text-align: center;">Brand
                                                Identity (Logo, Typography)</td>
                                            <td style="color: white; text-align: center;">Sr. Designer</td>
                                            <td style="color: white; text-align: center;">40</td>
                                            <td style="color: #10b981; text-align: center;">$6,000</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 16px 0; color: white; text-align: center;">UX/UI
                                                Design System</td>
                                            <td style="color: white; text-align: center;">Sr. Designer</td>
                                            <td style="color: white; text-align: center;">80</td>
                                            <td style="color: #10b981; text-align: center;">$12,000</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 16px 0; color: white; text-align: center;">
                                                High-Fidelity Prototyping</td>
                                            <td style="color: white; text-align: center;">Product Design</td>
                                            <td style="color: white; text-align: center;">40</td>
                                            <td style="color: #10b981; text-align: center;">$6,000</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 16px 0; color: white; text-align: center;">Asset
                                                Production</td>
                                            <td style="color: white; text-align: center;">Visual Design</td>
                                            <td style="color: white; text-align: center;">40</td>
                                            <td style="color: #10b981; text-align: center;">$6,000</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>

                            <!-- PHASE 1 -->
                            <div
                                style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 12px; overflow: hidden;">
                                <div style="padding: 24px 32px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; background: rgba(255,255,255,0.03);"
                                    onclick="this.nextElementSibling.classList.toggle('hidden')">
                                    <div style="display: flex; align-items: center; gap: 24px;">
                                        <div
                                            style="height: 48px; width: 48px; border-radius: 4px; background: rgba(200,169,81,0.1); border: 1px solid #C8A951; display: flex; align-items: center; justify-content: center; color: #C8A951; font-family: Cinzel, serif; font-weight: bold; font-size: 20px;">
                                            1</div>
                                        <div>
                                            <h3
                                                style="color: white; font-weight: 600; font-size: 24px; font-family: Cinzel, serif; margin: 0;">
                                                Foundation & Vault</h3>
                                            <p
                                                style="color: #C8A951; text-transform: uppercase; letter-spacing: 0.1em; font-size: 14px; margin: 4px 0 0 0;">
                                                Weeks 1-4 • 160 Hours</p>
                                        </div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div
                                            style="font-size: 24px; font-weight: bold; color: white; font-family: Cinzel, serif;">
                                            $30,000</div>
                                        <div style="font-size: 14px; color: #C8A951;">Allocated Value</div>
                                    </div>
                                </div>
                                <div class="hidden"
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding: 24px 32px; background: rgba(0,0,0,0.2);">
                                    <table
                                        style="width: 100%; font-size: 24px; text-align: center; border-collapse: collapse;">
                                        <tr style="color: white; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th style="padding-bottom: 12px;">Activity</th>
                                            <th style="padding-bottom: 12px;">Role</th>
                                            <th style="padding-bottom: 12px; text-align: right;">Hrs</th>
                                            <th style="padding-bottom: 12px; text-align: right;">Cost</th>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">System Architecture</td>
                                            <td style="color: white;">Sr. Architect</td>
                                            <td style="text-align: right; color: white;">40</td>
                                            <td style="text-align: right; color: #10b981;">$8,000</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">Schema Design (SQL/NoSQL)
                                            </td>
                                            <td style="color: white;">Backend Eng</td>
                                            <td style="text-align: right; color: white;">30</td>
                                            <td style="text-align: right; color: #10b981;">$5,500</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">Vault Implementation
                                                (KMS)
                                            </td>
                                            <td style="color: white;">Security Eng</td>
                                            <td style="text-align: right; color: white;">35</td>
                                            <td style="text-align: right; color: #10b981;">$7,250</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">OpenSign Setup</td>
                                            <td style="color: white;">DevOps</td>
                                            <td style="text-align: right; color: white;">15</td>
                                            <td style="text-align: right; color: #10b981;">$2,250</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">Frontend Shell (React)
                                            </td>
                                            <td style="color: white;">Frontend Eng</td>
                                            <td style="text-align: right; color: white;">40</td>
                                            <td style="text-align: right; color: #10b981;">$7,000</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>

                            <!-- PHASE 2 -->
                            <div
                                style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 12px; overflow: hidden;">
                                <div style="padding: 24px 32px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; background: rgba(255,255,255,0.03);"
                                    onclick="this.nextElementSibling.classList.toggle('hidden')">
                                    <div style="display: flex; align-items: center; gap: 24px;">
                                        <div
                                            style="height: 48px; width: 48px; border-radius: 4px; background: rgba(200,169,81,0.1); border: 1px solid #C8A951; display: flex; align-items: center; justify-content: center; color: #C8A951; font-family: Cinzel, serif; font-weight: bold; font-size: 20px;">
                                            2</div>
                                        <div>
                                            <h3
                                                style="color: white; font-weight: 600; font-size: 24px; font-family: Cinzel, serif; margin: 0;">
                                                Core Logic & "The Shepherd"</h3>
                                            <p
                                                style="color: #C8A951; text-transform: uppercase; letter-spacing: 0.1em; font-size: 14px; margin: 4px 0 0 0;">
                                                Weeks 5-10 • 185 Hours</p>
                                        </div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div
                                            style="font-size: 24px; font-weight: bold; color: white; font-family: Cinzel, serif;">
                                            $35,000</div>
                                        <div style="font-size: 14px; color: #C8A951;">Allocated Value</div>
                                    </div>
                                </div>
                                <div class="hidden"
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding: 24px 32px; background: rgba(0,0,0,0.2);">
                                    <table
                                        style="width: 100%; font-size: 24px; text-align: center; border-collapse: collapse;">
                                        <tr style="color: white; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th style="padding-bottom: 12px;">Activity</th>
                                            <th style="padding-bottom: 12px;">Role</th>
                                            <th style="padding-bottom: 12px; text-align: right;">Hrs</th>
                                            <th style="padding-bottom: 12px; text-align: right;">Cost</th>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">State Engines (MD, IL,
                                                MN)
                                            </td>
                                            <td style="color: white;">Logic Eng</td>
                                            <td style="text-align: right; color: white;">60</td>
                                            <td style="text-align: right; color: #10b981;">$11,000</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">Gemini 3.0 RAG Pipeline
                                            </td>
                                            <td style="color: white;">AI Engineer</td>
                                            <td style="text-align: right; color: white;">45</td>
                                            <td style="text-align: right; color: #10b981;">$9,500</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">Legal Prompt Engineering
                                            </td>
                                            <td style="color: white;">Prompt Eng</td>
                                            <td style="text-align: right; color: white;">30</td>
                                            <td style="text-align: right; color: #10b981;">$6,000</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">Frontend Guidance UI</td>
                                            <td style="color: white;">Frontend Eng</td>
                                            <td style="text-align: right; color: white;">50</td>
                                            <td style="text-align: right; color: #10b981;">$8,500</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>

                            <!-- PHASE 3 -->
                            <div
                                style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 12px; overflow: hidden;">
                                <div style="padding: 24px 32px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; background: rgba(255,255,255,0.03);"
                                    onclick="this.nextElementSibling.classList.toggle('hidden')">
                                    <div style="display: flex; align-items: center; gap: 24px;">
                                        <div
                                            style="height: 48px; width: 48px; border-radius: 4px; background: rgba(200,169,81,0.1); border: 1px solid #C8A951; display: flex; align-items: center; justify-content: center; color: #C8A951; font-family: Cinzel, serif; font-weight: bold; font-size: 20px;">
                                            3</div>
                                        <div>
                                            <h3
                                                style="color: white; font-weight: 600; font-size: 24px; font-family: Cinzel, serif; margin: 0;">
                                                Living Legacy & Universal App</h3>
                                            <p
                                                style="color: #C8A951; text-transform: uppercase; letter-spacing: 0.1em; font-size: 14px; margin: 4px 0 0 0;">
                                                Weeks 11-16 • 220 Hours</p>
                                        </div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div
                                            style="font-size: 24px; font-weight: bold; color: white; font-family: Cinzel, serif;">
                                            $38,000</div>
                                        <div style="font-size: 14px; color: #C8A951;">Allocated Value</div>
                                    </div>
                                </div>
                                <div class="hidden"
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding: 24px 32px; background: rgba(0,0,0,0.2);">
                                    <table
                                        style="width: 100%; font-size: 24px; text-align: center; border-collapse: collapse;">
                                        <tr style="color: white; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th style="padding-bottom: 12px;">Activity</th>
                                            <th style="padding-bottom: 12px;">Role</th>
                                            <th style="padding-bottom: 12px; text-align: right;">Hrs</th>
                                            <th style="padding-bottom: 12px; text-align: right;">Cost</th>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">React Native Shell</td>
                                            <td style="color: white;">Mobile Eng</td>
                                            <td style="text-align: right; color: white;">80</td>
                                            <td style="text-align: right; color: #10b981;">$14,000</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">Living Legacy Features
                                            </td>
                                            <td style="color: white;">Full Stack</td>
                                            <td style="text-align: right; color: white;">60</td>
                                            <td style="text-align: right; color: #10b981;">$10,500</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">Asset Distribution UI
                                            </td>
                                            <td style="color: white;">React Eng</td>
                                            <td style="text-align: right; color: white;">50</td>
                                            <td style="text-align: right; color: #10b981;">$8,500</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">Doc Scanner / Camera</td>
                                            <td style="color: white;">Mobile Eng</td>
                                            <td style="text-align: right; color: white;">30</td>
                                            <td style="text-align: right; color: #10b981;">$5,000</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>

                            <!-- PHASE 4 -->
                            <div
                                style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 12px; overflow: hidden;">
                                <div style="padding: 24px 32px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; background: rgba(255,255,255,0.03);"
                                    onclick="this.nextElementSibling.classList.toggle('hidden')">
                                    <div style="display: flex; align-items: center; gap: 24px;">
                                        <div
                                            style="height: 48px; width: 48px; border-radius: 4px; background: rgba(200,169,81,0.1); border: 1px solid #C8A951; display: flex; align-items: center; justify-content: center; color: #C8A951; font-family: Cinzel, serif; font-weight: bold; font-size: 20px;">
                                            4</div>
                                        <div>
                                            <h3
                                                style="color: white; font-weight: 600; font-size: 24px; font-family: Cinzel, serif; margin: 0;">
                                                QA, Security & Launch</h3>
                                            <p
                                                style="color: #C8A951; text-transform: uppercase; letter-spacing: 0.1em; font-size: 14px; margin: 4px 0 0 0;">
                                                Weeks 17-20 • 160 Hours</p>
                                        </div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div
                                            style="font-size: 24px; font-weight: bold; color: white; font-family: Cinzel, serif;">
                                            $32,000</div>
                                        <div style="font-size: 14px; color: #C8A951;">Allocated Value</div>
                                    </div>
                                </div>
                                <div class="hidden"
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding: 24px 32px; background: rgba(0,0,0,0.2);">
                                    <table
                                        style="width: 100%; font-size: 24px; text-align: center; border-collapse: collapse;">
                                        <tr style="color: white; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th style="padding-bottom: 12px;">Activity</th>
                                            <th style="padding-bottom: 12px;">Role</th>
                                            <th style="padding-bottom: 12px; text-align: right;">Hrs</th>
                                            <th style="padding-bottom: 12px; text-align: right;">Cost</th>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">Pen Testing (Ext)</td>
                                            <td style="color: white;">Sec Analyst</td>
                                            <td style="text-align: right; color: white;">40</td>
                                            <td style="text-align: right; color: #10b981;">$12,000</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">E2E Testing (Cypress)
                                            </td>
                                            <td style="color: white;">QA Eng</td>
                                            <td style="text-align: right; color: white;">60</td>
                                            <td style="text-align: right; color: #10b981;">$10,000</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">SOC 2 Policy Gen</td>
                                            <td style="color: white;">Compliance</td>
                                            <td style="text-align: right; color: white;">20</td>
                                            <td style="text-align: right; color: #10b981;">$4,000</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">App Store Submission</td>
                                            <td style="color: white;">Mobile Eng</td>
                                            <td style="text-align: right; color: white;">40</td>
                                            <td style="text-align: right; color: #10b981;">$6,000</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            <!-- PHASE 5 -->
                            <div
                                style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 12px; overflow: hidden;">
                                <div style="padding: 24px 32px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; background: rgba(255,255,255,0.03);"
                                    onclick="this.nextElementSibling.classList.toggle('hidden')">
                                    <div style="display: flex; align-items: center; gap: 24px;">
                                        <div
                                            style="height: 48px; width: 48px; border-radius: 4px; background: rgba(200,169,81,0.1); border: 1px solid #C8A951; display: flex; align-items: center; justify-content: center; color: #C8A951; font-family: Cinzel, serif; font-weight: bold; font-size: 20px;">
                                            5</div>
                                        <div>
                                            <h3
                                                style="color: white; font-weight: 600; font-size: 24px; font-family: Cinzel, serif; margin: 0;">
                                                Contingency & PM</h3>
                                            <p
                                                style="color: #C8A951; text-transform: uppercase; letter-spacing: 0.1em; font-size: 14px; margin: 4px 0 0 0;">
                                                Project Oversight • Ongoing</p>
                                        </div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div
                                            style="font-size: 24px; font-weight: bold; color: white; font-family: Cinzel, serif;">
                                            $35,000</div>
                                        <div style="font-size: 14px; color: #C8A951;">Allocated Value</div>
                                    </div>
                                </div>
                                <div class="hidden"
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding: 24px 32px; background: rgba(0,0,0,0.2);">
                                    <table
                                        style="width: 100%; font-size: 24px; text-align: center; border-collapse: collapse;">
                                        <tr style="color: white; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th style="padding-bottom: 12px;">Activity</th>
                                            <th style="padding-bottom: 12px;">Role</th>
                                            <th style="padding-bottom: 12px; text-align: right;">Hrs</th>
                                            <th style="padding-bottom: 12px; text-align: right;">Cost</th>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">15% Project Contingency
                                            </td>
                                            <td style="color: white;">Risk Mgmt</td>
                                            <td style="text-align: right; color: white;">-</td>
                                            <td style="text-align: right; color: #10b981;">$28,000</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 0; color: white;">Project Management</td>
                                            <td style="color: white;">Lead Dev</td>
                                            <td style="text-align: right; color: white;">50</td>
                                            <td style="text-align: right; color: #10b981;">$7,000</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 3. DISCOUNT REALIZATION - SIMPLE CALCULATION BOX -->
                    <div style="margin-bottom: 96px;">
                        <h2
                            style="text-align: center; margin-bottom: 48px; font-size: 28px; font-family: Cinzel, serif; color: #C8A951; text-transform: uppercase; letter-spacing: 0.15em;">
                            3. Discount Realization</h2>

                        <div
                            style="max-width: 1000px; margin: 0 auto; background: rgba(255,255,255,0.03); border: 1px solid rgba(200,169,81,0.4); padding: 32px; border-radius: 8px;">

                            <!-- Row 1: Starting Point -->
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <span style="font-size: 20px; font-family: Inter, sans-serif; color: white;">Market
                                    Standard ("Big Law")</span>
                                <span
                                    style="font-size: 24px; font-family: Cinzel, serif; color: #94a3b8; text-decoration: line-through;">$650,000</span>
                            </div>

                            <!-- Row 2: Discount 1 -->
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0;">
                                <span style="font-size: 20px; font-family: Inter, sans-serif; color: white;">SirsiNexus
                                    Efficiency</span>
                                <span
                                    style="font-size: 24px; font-family: Cinzel, serif; color: #10b981;">−$350,000</span>
                            </div>

                            <!-- Row 3: Discount 2 -->
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <span style="font-size: 20px; font-family: Inter, sans-serif; color: white;">"Project
                                    111" Credit</span>
                                <span
                                    style="font-size: 24px; font-family: Cinzel, serif; color: #10b981;">−$100,000</span>
                            </div>

                            <!-- Row 4: Final Total -->
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; padding: 24px 0 12px 0;">
                                <span
                                    style="font-size: 20px; font-family: Inter, sans-serif; font-weight: 600; color: #C8A951;">Your
                                    Price</span>
                                <span
                                    style="font-size: 24px; font-family: Cinzel, serif; font-weight: 600; color: #C8A951;">$200,000</span>
                            </div>
                        </div>
                    </div>

                    <!-- 4. INFRASTRUCTURE BOM -->
                    <div style="margin-bottom: 96px;">
                        <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 32px;">
                            <div style="height: 1px; background: rgba(255,255,255,0.1); flex: 1;"></div>
                            <h2
                                style="font-size: 28px; font-family: Cinzel, serif; color: #C8A951; text-transform: uppercase; letter-spacing: 0.15em;">
                                4. Infrastructure BoM (OpEx)</h2>
                            <div style="height: 1px; background: rgba(255,255,255,0.1); flex: 1;"></div>
                        </div>

                        <div
                            style="border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); overflow: hidden; max-width: 1000px; margin: 0 auto;">
                            <table style="width: 100%; text-align: left; border-collapse: collapse;">
                                <thead>
                                    <tr
                                        style="background: rgba(0,0,0,0.2); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                        <th
                                            style="padding: 20px; font-size: 16px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: #C8A951;">
                                            Service</th>
                                        <th
                                            style="padding: 20px; font-size: 16px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: #C8A951;">
                                            Specific Item</th>
                                        <th
                                            style="padding: 20px; font-size: 16px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: #C8A951;">
                                            Est. Unit Cost</th>
                                        <th
                                            style="padding: 20px; font-size: 16px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: #C8A951;">
                                            Purpose</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-weight: 600; color: white;">
                                            Compute</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Google
                                            Cloud
                                            Run</td>
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-family: Cinzel, serif; color: #C8A951;">
                                            $18/mo</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">
                                            Serverless
                                            backend</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-weight: 600; color: white;">
                                            Database</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Cloud SQL
                                            (Postgres)</td>
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-family: Cinzel, serif; color: #C8A951;">
                                            $9/mo</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Secure
                                            PII
                                            storage</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-weight: 600; color: white;">
                                            NoSQL</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Firestore
                                        </td>
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-family: Cinzel, serif; color: #10b981;">
                                            Free Tier</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">User
                                            metadata
                                        </td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-weight: 600; color: white;">
                                            Storage</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Cloud
                                            Storage
                                        </td>
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-family: Cinzel, serif; color: #C8A951;">
                                            $0.026/GB</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Encrypted
                                            vault</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-weight: 600; color: white;">
                                            AI</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Vertex AI
                                            (Gemini)</td>
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-family: Cinzel, serif; color: #C8A951;">
                                            $5/1M tokens</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Legal
                                            guidance</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-weight: 600; color: white;">
                                            E-Sign</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">OpenSign
                                            (Self-Hosted)</td>
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-family: Cinzel, serif; color: #10b981;">
                                            $0 (OSS)</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Unlimited
                                            signing</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-weight: 600; color: white;">
                                            Mail</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Lob API
                                        </td>
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-family: Cinzel, serif; color: #C8A951;">
                                            $1.55/letter</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Certified
                                            mail</td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-weight: 600; color: white;">
                                            Identity</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Persona /
                                            Jumio</td>
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-family: Cinzel, serif; color: #C8A951;">
                                            $1.50/check</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Fraud
                                            prevention</td>
                                    </tr>
                                    <tr>
                                        <td
                                            style="padding: 16px 20px; font-size: 24px; font-weight: 600; color: white;">
                                            Maintenance</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">111
                                            Venture
                                            Studio</td>
                                        <td
                                            style="padding: 16px 20px; font-size: 18px; font-family: Cinzel, serif; color: #C8A951;">
                                            $1,500/mo</td>
                                        <td style="padding: 16px 20px; font-size: 24px; color: white;">Ongoing
                                            support, updates, monitoring</td>
                                    </tr>
                                </tbody>
                                <tfoot style="background: rgba(200,169,81,0.1);">
                                    <tr>
                                        <td colspan="4"
                                            style="padding: 20px; text-align: center; font-weight: 700; font-size: 24px; color: #C8A951; text-transform: uppercase; letter-spacing: 0.1em;">
                                            Total Estimated OpEx: ~$1,560/month + Usage
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>

                    <!-- 5. PARTNERSHIP PLANS - SIMPLE PAYMENT SCHEDULES -->
                    <div style="margin-top: 96px; padding-top: 48px; border-top: 1px solid rgba(200,169,81,0.3);">
                        <h2
                            style="text-align: center; margin-bottom: 64px; font-size: 28px; font-family: Cinzel, serif; color: #C8A951; text-transform: uppercase; letter-spacing: 0.15em;">
                            5. Payment Schedule Options</h2>

                        <div
                            style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; max-width: 1200px; margin: 0 auto;">

                            <!-- PLAN A: 4 Monthly Payments -->
                            <div id="cost-card-plan-a" class="plan-card-static"
                                style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.15); padding: 2rem; text-align: center; display: flex; flex-direction: column;">
                                <h3
                                    style="font-size: 24px; font-family: Cinzel, serif; color: white; margin-bottom: 0.5rem;">
                                    Plan A</h3>
                                <p style="font-size: 14px; color: white; margin-bottom: 1.5rem;">4 Monthly Payments</p>

                                <div
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-bottom: 1.5rem; flex-grow: 1;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 32px; font-family: Cinzel, serif; color: #C8A951;">
                                            $50,000</div>
                                        <div style="font-size: 14px; color: white;">per month × 4 months</div>
                                    </div>
                                    <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 1rem;">
                                        First payment due at signing
                                    </div>
                                </div>

                                <div
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-top: auto;">
                                    <div style="font-size: 16px; color: white; margin-bottom: 0.5rem;">Total</div>
                                    <div
                                        style="font-size: 20px; font-family: Cinzel, serif; color: white; font-weight: 600; margin-bottom: 1.5rem;">
                                        $200,000</div>
                                    <button onclick="selectPlanFromCost('Plan A', this)" class="select-plan-btn"
                                        style="width: 100%; padding: 14px 24px; background: linear-gradient(to right, #C8A951, #E2C76B); color: #000; font-weight: 700; font-size: 12px; text-transform: uppercase; letter-spacing: 0.15em; border: none; border-radius: 4px; cursor: pointer; transition: all 0.3s ease;">
                                        Select Plan
                                    </button>
                                </div>
                            </div>

                            <!-- PLAN B: 5 Monthly Payments -->
                            <div id="cost-card-plan-b" class="plan-card-static"
                                style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.15); padding: 2rem; text-align: center; display: flex; flex-direction: column;">

                                <h3
                                    style="font-size: 24px; font-family: Cinzel, serif; color: white; margin-bottom: 0.5rem;">
                                    Plan B</h3>
                                <p style="font-size: 14px; color: white; margin-bottom: 1.5rem;">5 Monthly Payments</p>

                                <div
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-bottom: 1.5rem; flex-grow: 1;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 32px; font-family: Cinzel, serif; color: #C8A951;">
                                            $40,000</div>
                                        <div style="font-size: 14px; color: white;">per month × 5 months</div>
                                    </div>
                                    <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 1rem;">
                                        First payment due at signing
                                    </div>
                                </div>

                                <div
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-top: auto;">
                                    <div style="font-size: 16px; color: white; margin-bottom: 0.5rem;">Total</div>
                                    <div
                                        style="font-size: 20px; font-family: Cinzel, serif; color: white; font-weight: 600; margin-bottom: 1.5rem;">
                                        $200,000</div>
                                    <button onclick="selectPlanFromCost('Plan B', this)" class="select-plan-btn"
                                        style="width: 100%; padding: 14px 24px; background: linear-gradient(to right, #C8A951, #E2C76B); color: #000; font-weight: 700; font-size: 12px; text-transform: uppercase; letter-spacing: 0.15em; border: none; border-radius: 4px; cursor: pointer; transition: all 0.3s ease;">
                                        Select Plan
                                    </button>
                                </div>
                            </div>

                            <!-- PLAN C: 6 Monthly Payments -->
                            <div id="cost-card-plan-c" class="plan-card-static"
                                style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.15); padding: 2rem; text-align: center; display: flex; flex-direction: column;">

                                <h3
                                    style="font-size: 24px; font-family: Cinzel, serif; color: white; margin-bottom: 0.5rem;">
                                    Plan C</h3>
                                <p style="font-size: 14px; color: white; margin-bottom: 1.5rem;">6 Monthly Payments</p>

                                <div
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-bottom: 1.5rem; flex-grow: 1;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 32px; font-family: Cinzel, serif; color: #C8A951;">
                                            $33,333.33</div>
                                        <div style="font-size: 14px; color: white;">per month × 6 months</div>
                                    </div>
                                    <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 1rem;">
                                        First payment due at signing
                                    </div>
                                </div>

                                <div
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-top: auto;">
                                    <div style="font-size: 16px; color: white; margin-bottom: 0.5rem;">Total</div>
                                    <div
                                        style="font-size: 20px; font-family: Cinzel, serif; color: white; font-weight: 600; margin-bottom: 1.5rem;">
                                        $200,000</div>
                                    <button onclick="selectPlanFromCost('Plan C', this)" class="select-plan-btn"
                                        style="width: 100%; padding: 14px 24px; background: linear-gradient(to right, #C8A951, #E2C76B); color: #000; font-weight: 700; font-size: 12px; text-transform: uppercase; letter-spacing: 0.15em; border: none; border-radius: 4px; cursor: pointer; transition: all 0.3s ease;">
                                        Select Plan
                                    </button>
                                </div>
                            </div>

                            <!-- NEXT BUTTON (COST -> CONTRACT) -->
                            <div class="w-full mt-16 mb-12 relative z-10"
                                style="display: flex; justify-content: flex-end; grid-column: 1 / -1;">
                                <button onclick="switchTab('contract')"
                                    class="group relative inline-flex items-center justify-center gap-3 h-11 px-6 overflow-hidden bg-gradient-to-r from-[#D4AF37] to-[#C8A951] text-[#050b14] shadow-[0_4px_20px_rgba(200,169,81,0.4)] hover:shadow-[0_0_40px_rgba(200,169,81,0.8)] transition-all duration-500 ease-out border border-[#C8A951] rounded-sm">

                                    <!-- TEXT -->
                                    <span
                                        class="relative z-10 font-serif font-bold text-sm tracking-[0.15em] uppercase">
                                        Next
                                    </span>

                                    <!-- ICON (Elegant Arrow) -->
                                    <svg class="w-4 h-4 relative z-10 transform group-hover:translate-x-1 transition-transform duration-300"
                                        fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3">
                                        </path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB 3: CONTRACT -->
                <div id="contract" class="tab-content" style="position: relative;">
                    <div id="step-1-label" class="text-center mb-8 transition-opacity duration-700">
                        <h2 class="font-serif text-2xl text-[#C8A951] uppercase tracking-widest">
                            Step 2: Review Master Services Agreement</h2>
                        <p class="text-sm text-white/60 mt-2">Scroll through and read the entire agreement
                            before
                            proceeding.</p>
                    </div>

                    <div class="legal-scroll-box" id="legal-scroll-container">
                        <div class="legal-viewer transition-opacity duration-700" id="contract-document">
                            <!-- MSA HEADER -->
                            <div class="text-center mb-12 pb-12 border-b border-gray-200">
                                <h2>MASTER SERVICES AGREEMENT</h2>
                                <p class="text-center opacity-60">Global Effective Date: <span
                                        id="date-msa-global"></span>
                                </p>
                            </div>

                            <div class="mb-12 p-8 bg-white/5 border border-white/10 rounded-lg">
                                <p class="mb-4 italic opacity-80">This <strong>Master Services
                                        Agreement</strong>
                                    (this
                                    "Agreement") is entered into as of <span id="date-msa-effective"></span>
                                    (the
                                    "Effective
                                    Date") by and
                                    between:</p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                    <div class="p-4 bg-white/5 rounded border border-white/5">
                                        <h4 class="text-[#C8A951] font-serif mb-2 underline tracking-wider">
                                            CLIENT
                                        </h4>
                                        <p><strong>FinalWishes Inc.</strong><br>
                                            Principal: Tameeka Lockhart<br>
                                            [Address Code: Pending Verification]<br>
                                            ("Client")</p>
                                    </div>
                                    <div class="p-4 bg-white/5 rounded border border-white/5">
                                        <h4 class="text-[#C8A951] font-serif mb-2 underline tracking-wider">
                                            PROVIDER
                                        </h4>
                                        <p><strong>Sirsi Technologies, Inc</strong><br>
                                            FEIN: 93-1696269<br>
                                            909 Rose Avenue, Suite 400<br>
                                            North Bethesda, MD 20852<br>
                                            ("Provider")</p>
                                    </div>
                                </div>
                            </div>

                            <!-- ROBUST MSA CONTENT (100% COMPLETE - NO OMISSIONS) -->
                            <div class="space-y-12">
                                <section>
                                    <h2>1. RECITALS</h2>
                                    <p><strong>WHEREAS</strong>, Client desires to engage Provider to design,
                                        develop,
                                        and implement a comprehensive estate settlement software platform known
                                        as
                                        <strong>FinalWishes</strong> (the "Platform");
                                    </p>
                                    <p><strong>WHEREAS</strong>, Provider (Sirsi Technologies, Inc) possesses
                                        the
                                        requisite technical expertise, personnel, and infrastructure, including
                                        expertise in artificial intelligence, cloud architecture, and secure
                                        software
                                        development, to perform the Services;</p>
                                    <p><strong>WHEREAS</strong>, the Parties wish to set forth the terms and
                                        conditions
                                        under which Provider will provide such Services to Client.</p>
                                    <p><strong>NOW, THEREFORE</strong>, in consideration of the mutual covenants
                                        contained herein, and for other good and valuable consideration, the
                                        receipt
                                        and
                                        sufficiency of which are hereby acknowledged, the Parties agree as
                                        follows:
                                    </p>
                                </section>

                                <section>
                                    <h2>2. DEFINITIONS</h2>
                                    <p>For purposes of this Agreement, the following terms shall have the
                                        meanings
                                        set
                                        forth below:</p>
                                    <ul>
                                        <li><strong>"Affiliate"</strong> means any entity that directly or
                                            indirectly
                                            controls, is controlled by, or is under common control with a Party,
                                            where
                                            "control" means ownership of more than fifty percent (50%) of the
                                            voting
                                            stock or other ownership interest.</li>
                                        <li><strong>"Background Technology"</strong> means all software, code,
                                            tools,
                                            libraries, frameworks, know-how, methodologies, and Intellectual
                                            Property
                                            Rights owned or licensed by Provider prior to the Effective Date or
                                            developed independently of the Services (including, without
                                            limitation,
                                            Provider’s "Sirsi" component library, "Gemini" guidance patterns,
                                            and
                                            standard deployment scripts).</li>
                                        <li><strong>"Confidential Information"</strong> means any non-public
                                            information
                                            disclosed by one Party (the "Disclosing Party") to the other Party
                                            (the
                                            "Receiving Party") that is designated as confidential or that, given
                                            the
                                            nature of the information or circumstances of disclosure, reasonably
                                            should
                                            be understood to be confidential.</li>
                                        <li><strong>"Deliverables"</strong> means all documents, work product,
                                            code,
                                            software, reports, and other materials that are specifically created
                                            for
                                            and
                                            delivered to Client by Provider pursuant to a Statement of Work.
                                        </li>
                                        <li><strong>"Intellectual Property Rights"</strong> means all patent
                                            rights,
                                            copyright rights, mask work rights, moral rights, rights of
                                            publicity,
                                            trademark, trade dress and service mark rights, goodwill, trade
                                            secret
                                            rights and other intellectual property rights as may now exist or
                                            hereafter
                                            come into existence, and all applications therefore and
                                            registrations,
                                            renewals and extensions thereof, under the laws of any state,
                                            country,
                                            territory or other jurisdiction.</li>
                                        <li><strong>"Services"</strong> means the professional software
                                            development,
                                            consulting, and design services to be performed by Provider as
                                            described
                                            in
                                            a Statement of Work.</li>
                                        <li><strong>"Statement of Work" or "SOW"</strong> means a document
                                            describing
                                            the specific Services to be performed, Deliverables to be provided,
                                            fees
                                            to
                                            be paid, and timeline for performance, which is agreed upon and
                                            signed
                                            by
                                            authorized representatives of both Parties. Each SOW shall be
                                            substantially
                                            in the form of Exhibit A.</li>
                                    </ul>
                                </section>

                                <section>
                                    <h2>3. SERVICES AND ENGAGEMENT</h2>
                                    <p><strong>3.1 Statements of Work.</strong> Provider shall provide the
                                        Services
                                        and
                                        Deliverables to Client as specified in each SOW. Each SOW shall be
                                        effectively
                                        incorporated into this Agreement. In the event of a conflict between the
                                        terms
                                        of this Agreement and an SOW, the terms of the SOW shall control ONLY
                                        regarding
                                        the specific description of Services, fees, and timeline; for all other
                                        legal
                                        terms and conditions, this Agreement shall control.</p>
                                    <p><strong>3.2 Standard of Performance.</strong> Provider represents and
                                        warrants
                                        that the Services will be performed in a professional, workmanlike
                                        manner,
                                        by
                                        qualified personnel, and consistent with the highest industry standards
                                        for
                                        similar enterprise-grade software development services. Provider shall
                                        devote
                                        adequate resources to meet its obligations under this Agreement.</p>
                                    <p><strong>3.3 Change Orders.</strong> Client may, at any time, request
                                        changes
                                        to
                                        the scope of the Services ("Change Request"). If Provider determines
                                        that
                                        such
                                        changes will impact the fees, timeline, or technical architecture,
                                        Provider
                                        shall submit a written "Change Order" detailing the impact. No change
                                        shall
                                        be
                                        effective until the Change Order is signed by both Parties. Minor
                                        changes
                                        requiring less than eight (8) hours of effort may be approved via
                                        written
                                        correspondence (email sufficient).</p>
                                    <p><strong>3.4 Non-Exclusivity.</strong> Client acknowledges that Provider
                                        is a
                                        professional services firm and may provide similar services to third
                                        parties,
                                        provided that Provider does not use Client’s Confidential Information or
                                        specifically commissioned Deliverables for such third parties.</p>
                                </section>

                                <section>
                                    <h2>4. COMPENSATION AND PAYMENT</h2>
                                    <p><strong>4.1 Fees.</strong> Client shall pay Provider the fees set forth
                                        in
                                        the
                                        applicable SOW. Unless otherwise specified in an SOW, fees for
                                        fixed-price
                                        projects shall be payable according to the agreed-upon milestone
                                        schedule.
                                    </p>
                                    <p><strong>4.2 Expenses.</strong> Client shall reimburse Provider for
                                        reasonable,
                                        documented "Pass-Through Expenses" incurred in connection with the
                                        Services
                                        (e.g., specific cloud infrastructure costs, third-party API licensing
                                        fees,
                                        software licenses specifically required for the Project). Provider shall
                                        obtain
                                        Client’s prior written approval for any individual expense exceeding
                                        Five
                                        Hundred Dollars ($500.00). Travel expenses shall only be reimbursable if
                                        pre-approved by Client in writing.</p>
                                    <p><strong>4.3 Payment Terms.</strong> Provider shall submit invoices to
                                        Client
                                        upon
                                        completion of Milestones or monthly for Time & Materials engagements.
                                        Invoices
                                        are due and payable <strong>Net Fifteen (15)</strong> days from the
                                        invoice
                                        date.</p>
                                    <p><strong>4.4 Late Payments.</strong> Undisputed payments not received by
                                        the
                                        due
                                        date shall accrue interest at the lesser of one and one-half percent
                                        (1.5%)
                                        per
                                        month or the maximum rate permitted by law.</p>
                                    <p><strong>4.5 Taxes.</strong> Fees do not include any sales, use,
                                        value-added,
                                        or
                                        similar taxes. Client shall be responsible for paying all such taxes
                                        properly
                                        levied on the Services, excluding taxes based on Provider’s net income,
                                        property, or employees.</p>
                                </section>

                                <section>
                                    <h2>5. INTELLECTUAL PROPERTY RIGHTS</h2>
                                    <p><strong>5.1 Work Made for Hire.</strong> Provider agrees that all
                                        Deliverables
                                        created for Client under this Agreement shall be considered "works made
                                        for
                                        hire" to the extent permitted by law. To the extent that any Deliverable
                                        does
                                        not qualify as a work made for hire under applicable law, Provider
                                        hereby
                                        irrevocably assigns to Client all right, title, and interest in and to
                                        such
                                        Deliverable, including all Intellectual Property Rights therein, free
                                        and
                                        clear
                                        of all liens and encumbrances.</p>
                                    <p><strong>5.2 Background Technology.</strong> Notwithstanding Section 5.1,
                                        Provider
                                        retains all right, title, and interest in and to its Background
                                        Technology.
                                        Provider hereby grants to Client a perpetual, irrevocable,
                                        non-exclusive,
                                        royalty-free, fully paid-up, worldwide, sublicensable license to use,
                                        reproduce,
                                        modify, display, distribute, and create derivative works of any
                                        Background
                                        Technology incorporated into the Deliverables, solely as necessary for
                                        Client to
                                        utilize, exploit, and maintain the Deliverables for their intended
                                        purpose.
                                    </p>
                                    <p><strong>5.3 Third-Party and Open Source Software.</strong> The
                                        Deliverables
                                        may
                                        contain third-party software or open source software. Provider warrants
                                        that
                                        its
                                        use of such software will comply with the applicable licenses (e.g.,
                                        AGPL-3.0,
                                        MIT, Apache 2.0). Provider shall identify any "Copyleft" libraries (that
                                        would
                                        mandate disclosure of Client’s source code) prior to integration and
                                        obtain
                                        Client’s approval.</p>
                                    <p><strong>5.4 AI-Generated Content.</strong> The Parties acknowledge that
                                        Provider
                                        utilizes advanced Artificial Intelligence tools (e.g., Google Gemini,
                                        Anthropic
                                        Claude) to assist in code generation and architecture. Provider warrants
                                        that it
                                        has the full legal right to assign ownership of such AI-generated output
                                        to
                                        Client as part of the Deliverables, and that such use does not violate
                                        the
                                        terms
                                        of service of the AI providers.</p>
                                    <p><strong>5.5 Further Assurances.</strong> Provider agrees to execute any
                                        documents
                                        and take any actions reasonably requested by Client to perfect Client’s
                                        ownership of the Intellectual Property Rights in the Deliverables.</p>
                                </section>

                                <section>
                                    <h2>6. CONFIDENTIALITY</h2>
                                    <p><strong>6.1 Obligations.</strong> The Receiving Party agrees: (i) to hold
                                        the
                                        Disclosing Party’s Confidential Information in strict confidence and
                                        take
                                        reasonable precautions to protect it (including all precautions the
                                        Receiving
                                        Party employs with respect to its own confidential materials); (ii) not
                                        to
                                        divulge any such Confidential Information to any third party (other than
                                        employees, contractors, or agents who have a need to know and are bound
                                        by
                                        written confidentiality obligations); and (iii) not to use such
                                        Confidential
                                        Information except for the performance of this Agreement.</p>
                                    <p><strong>6.2 Exclusions.</strong> Confidential Information shall not
                                        include
                                        information that: (a) is or becomes generally available to the public
                                        without
                                        breach of this Agreement; (b) was in the Receiving Party’s possession
                                        prior
                                        to
                                        disclosure without legal restriction; (c) is captured by the Receiving
                                        Party
                                        from a third party who had the legal right to disclose it; or (d) is
                                        independently developed by the Receiving Party without reference to or
                                        use
                                        of
                                        the Confidential Information.</p>
                                    <p><strong>6.3 Data Security & SOC 2 Compliance.</strong> Provider
                                        acknowledges
                                        that
                                        it may have access to Client’s data, which may include Personally
                                        Identifiable
                                        Information (PII). Provider agrees to implement and maintain
                                        commercially
                                        reasonable technical and organizational security measures—consistent
                                        with
                                        SOC 2
                                        Type II criteria—to protect such data from unauthorized access, use,
                                        modification, or disclosure. This includes, but is not limited to,
                                        encryption of
                                        data at rest and in transit, access controls, and regular security
                                        audits.
                                    </p>
                                    <p><strong>6.4 Compelled Disclosure.</strong> If the Receiving Party is
                                        required
                                        by
                                        law or court order to disclose Confidential Information, it shall give
                                        the
                                        Disclosing Party prompt written notice (if legally permitted) to allow
                                        the
                                        Disclosing Party to seek a protective order.</p>
                                </section>

                                <section>
                                    <h2>7. WARRANTIES AND COVENANTS</h2>
                                    <p><strong>7.1 Provider Warranties.</strong> Provider represents and
                                        warrants
                                        that:<br>(a) <strong>Non-Infringement:</strong> The Deliverables will be
                                        original and will not infringe, misappropriate, or violate any patent,
                                        copyright, trademark, trade secret, or other proprietary right of any
                                        third
                                        party.<br>(b) <strong>Compliance with Laws:</strong> The Services will
                                        be
                                        performed in compliance with all applicable federal, state, and local
                                        laws
                                        and
                                        regulations.<br>(c) <strong>Malicious Code:</strong> Provider will use
                                        industry-standard measures to ensure the Deliverables do not contain any
                                        viruses, malware, trojan horses, time bombs, or other harmful code.</p>
                                    <p><strong>7.2 Performance Warranty (60-Day Bug Fix Guarantee).</strong>
                                        Provider
                                        warrants that, for a period of <strong>sixty (60) days</strong>
                                        following
                                        Client’s Acceptance of the Deliverables (the "Warranty Period"), the
                                        Deliverables will function materially in accordance with the
                                        specifications
                                        set
                                        forth in the SOW. If the Deliverables fail to meet this warranty,
                                        Provider
                                        shall, at its sole expense and as Client’s exclusive remedy for breach
                                        of
                                        this
                                        warranty, promptly correct the non-conformity.</p>
                                    <p><strong>7.3 Disclaimer.</strong> EXCEPT AS EXPRESSLY SET FORTH IN THIS
                                        AGREEMENT,
                                        PROVIDER MAKES NO OTHER WARRANTIES, EXPRESS OR IMPLIED, AND HEREBY
                                        DISCLAIMS
                                        ALL
                                        IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,
                                        AND
                                        NON-INFRINGEMENT.</p>
                                </section>

                                <section>
                                    <h2>8. INDEMNIFICATION</h2>
                                    <p><strong>8.1 By Provider.</strong> Provider shall indemnify, defend, and
                                        hold
                                        harmless Client and its officers, directors, employees, and agents from
                                        and
                                        against any and all losses, damages, liabilities, costs, and expenses
                                        (including
                                        reasonable attorneys’ fees) arising out of or resulting from any
                                        third-party
                                        claim alleging that the Deliverables or Services infringe or
                                        misappropriate
                                        any
                                        U.S. copyright, trademark, or trade secret.</p>
                                    <p><strong>8.2 By Client.</strong> Client shall indemnify, defend, and hold
                                        harmless
                                        Provider from and against any and all losses, damages, liabilities,
                                        costs,
                                        and
                                        expenses arising out of or resulting from: (i) Client’s specific
                                        specifications
                                        or instructions that compelled the infringement; or (ii) content or data
                                        provided by Client to Provider.</p>
                                    <p><strong>8.3 Procedure.</strong> The indemnified party shall: (a) promptly
                                        notify
                                        the indemnifying party in writing of the claim; (b) allow the
                                        indemnifying
                                        party
                                        sole control of the defense and settlement of the claim; and (c) provide
                                        reasonable assistance to the indemnifying party.</p>
                                </section>

                                <section>
                                    <h2>9. LIMITATION OF LIABILITY</h2>
                                    <p><strong>9.1 Exclusion of Consequential Damages.</strong> EXCEPT FOR
                                        BREACHES
                                        OF
                                        CONFIDENTIALITY (SECTION 6) OR INDEMNIFICATION OBLIGATIONS (SECTION 8),
                                        IN
                                        NO
                                        EVENT SHALL EITHER PARTY BE LIABLE TO THE OTHER FOR ANY INDIRECT,
                                        INCIDENTAL,
                                        SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES (INCLUDING LOSS OF PROFITS,
                                        DATA, OR
                                        USE), EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.</p>
                                    <p><strong>9.2 Liability Cap.</strong> EXCEPT FOR PROVIDER'S INDEMNIFICATION
                                        OBLIGATIONS FOR IP INFRINGEMENT (SECTION 8.1), EACH PARTY’S TOTAL
                                        AGGREGATE
                                        LIABILITY ARISING OUT OF OR RELATED TO THIS AGREEMENT, WHETHER IN
                                        CONTRACT,
                                        TORT, OR OTHERWISE, SHALL NOT EXCEED THE TOTAL FEES PAID OR PAYABLE BY
                                        CLIENT TO
                                        PROVIDER UNDER THE APPLICABLE SOW IN THE TWELVE (12) MONTHS IMMEDIATELY
                                        PRECEDING THE EVENT GIVING RISE TO THE CLAIM.</p>
                                </section>

                                <section>
                                    <h2>10. TERM AND TERMINATION</h2>
                                    <p><strong>10.1 Term.</strong> This Agreement shall commence on the
                                        Effective
                                        Date
                                        and shall continue in full force and effect until terminated as provided
                                        herein.
                                    </p>
                                    <p><strong>10.2 Termination for Convenience.</strong> Client may terminate
                                        this
                                        Agreement or any SOW for any reason or no reason upon thirty (30) days'
                                        prior
                                        written notice to Provider. Upon such termination, Client shall pay
                                        Provider
                                        for
                                        all Services performed and non-cancellable expenses incurred up to the
                                        date
                                        of
                                        termination.</p>
                                    <p><strong>10.3 Termination for Cause.</strong> Either Party may terminate
                                        this
                                        Agreement or any SOW immediately upon written notice if the other Party:
                                        (i)
                                        materially breaches this Agreement and fails to cure such breach within
                                        fifteen
                                        (15) days after receiving written notice thereof; or (ii) becomes
                                        insolvent,
                                        makes an assignment for the benefit of creditors, or files for
                                        bankruptcy.
                                    </p>
                                    <p><strong>10.4 Effect of Termination.</strong> Upon termination: (i) Client
                                        shall
                                        pay all outstanding undisputed invoices; (ii) Provider shall deliver to
                                        Client
                                        all completed and partially completed Deliverables; and (iii) each Party
                                        shall
                                        return or destroy the other Party’s Confidential Information.</p>
                                    <p><strong>10.5 Survival.</strong> Sections 2, 4, 5, 6, 7.3, 8, 9, 11, and
                                        12
                                        shall
                                        survive any termination or expiration of this Agreement.</p>
                                </section>

                                <section>
                                    <h2>11. GENERAL PROVISIONS</h2>
                                    <p><strong>11.1 Independent Contractor.</strong> Provider is an independent
                                        contractor. Nothing in this Agreement shall be construed to create a
                                        partnership, joint venture, agency, or employment relationship between
                                        the
                                        Parties.</p>
                                    <p><strong>11.2 Force Majeure.</strong> Neither Party shall be liable for
                                        any
                                        delay
                                        or failure to perform (excluding payment obligations) due to causes
                                        beyond
                                        its
                                        reasonable control, including acts of God, war, terrorism, riot,
                                        embargoes,
                                        acts
                                        of civil or military authorities, fire, floods, or accidents.</p>
                                    <p><strong>11.3 Non-Solicitation.</strong> During the Term and for one (1)
                                        year
                                        thereafter, neither Party shall knowingly solicit for employment or hire
                                        any
                                        employee or contractor of the other Party who was directly involved in
                                        the
                                        provision of Services under this Agreement, without the prior written
                                        consent of
                                        the other Party. General solicitations not targeted at such persons
                                        shall
                                        not be
                                        a violation of this provision.</p>
                                    <p><strong>11.4 Dispute Resolution.</strong><br>(a)
                                        <strong>Negotiation:</strong>
                                        The Parties agree to attempt to resolve any dispute arising out of this
                                        Agreement through good faith negotiation between senior
                                        executives.<br>(b)
                                        <strong>Arbitration:</strong> If negotiation fails within thirty (30)
                                        days,
                                        the
                                        dispute shall be predominantly resolved by binding arbitration
                                        administered
                                        by
                                        the American Arbitration Association (AAA) in accordance with its
                                        Commercial
                                        Arbitration Rules.<br>(c) <strong>Venue & Law:</strong> The seat of
                                        arbitration
                                        shall be <strong>Wilmington, Delaware</strong>. This Agreement shall be
                                        governed
                                        by the laws of the <strong>State of Delaware</strong>, without regard to
                                        its
                                        conflict of laws principles.<br>(d) <strong>No Jury Trial:</strong> EACH
                                        PARTY
                                        HEREBY WAIVES ANY RIGHT TO A JURY TRIAL IN CONNECTION WITH ANY DISPUTE
                                        ARISING
                                        OUT OF THIS AGREEMENT.
                                    </p>
                                    <p><strong>11.5 Assignment.</strong> Neither Party may assign this Agreement
                                        without
                                        the prior written consent of the other Party, except that either Party
                                        may
                                        assign this Agreement to an Affiliate or in connection with a merger,
                                        acquisition, or sale of substantially all of its assets.</p>
                                    <p><strong>11.6 Severability.</strong> If any provision of this Agreement is
                                        held to
                                        be invalid or unenforceable, the remaining provisions shall continue in
                                        full
                                        force and effect.</p>
                                    <p><strong>11.7 Entire Agreement.</strong> This Agreement, together with all
                                        SOWs
                                        and Exhibits, constitutes the entire agreement between the Parties
                                        regarding
                                        the
                                        subject matter hereof and supersedes all prior or contemporaneous
                                        agreements,
                                        understandings, and communications.</p>
                                    <p><strong>11.8 Counterparts.</strong> This Agreement may be executed in
                                        counterparts, each of which shall be deemed an original, but all of
                                        which
                                        together shall constitute one and the same instrument. Electronic
                                        signatures
                                        shall be deemed original signatures.</p>
                                </section>
                            </div>
                            <hr class="border-[#C8A951]/20 my-16">

                            <section id="exhibit-a">
                                <h2 class="text-center font-serif text-3xl text-[#C8A951] mb-12">Exhibit A:
                                    Statement of Work (SOW)</h2>
                                <p class="text-center opacity-60 mb-12">Project Name: FinalWishes Platform
                                    Development<br>SOW Reference: SOW-<span id="year-sow-exhibit"></span>-001 |
                                    Associated
                                    MSA:
                                    MSA-<span id="year-msa-exhibit"></span>-111-FW<br>Date: <span
                                        id="date-exhibit-a"></span></p>

                                <h3>1. Executive Overview</h3>
                                <p>This Statement of Work ("SOW") defines the comprehensive scope for the
                                    <strong>FinalWishes Estate Operating System</strong>. This project aims to
                                    digitize and automate the estate settlement process, focusing on "Launch
                                    States"
                                    (Maryland, Illinois, Minnesota) where electronic filing or substantial
                                    digitization is possible.
                                </p>
                                <p><strong>Objective:</strong> Deliver a "Vault-Grade" secure platform that
                                    guides
                                    users through the 18+ month probate process, automating form generation,
                                    asset
                                    discovery, and stakeholder communication.</p>

                                <h3>2. Detailed Scope of Services</h3>
                                <p><strong>2.1 Core Vault & Data Architecture</strong></p>
                                <p>Provider shall implement a <strong>Multi-Tenant, Zero-Knowledge</strong>
                                    architecture to ensure total data privacy.</p>
                                <ul>
                                    <li><strong>Storage Layer:</strong> Hybrid approach using <strong>Cloud SQL
                                            (PostgreSQL)</strong> for structured PII (Encrypted) and
                                        <strong>Firestore</strong> for real-time document metadata.
                                    </li>
                                    <li><strong>File Vault:</strong> <strong>Cloud Storage</strong> buckets with
                                        per-tenant isolation boundaries. All files encrypted at rest using
                                        <strong>Cloud KMS</strong> (AES-256).
                                    </li>
                                    <li><strong>Security:</strong> Implementation of <strong>SOC 2 Type
                                            II</strong>
                                        controls, including strict IAM roles, audit logging, and encryption in
                                        transit (TLS 1.3).</li>
                                </ul>

                                <p><strong>2.2 Document Inventory & Automation Scope</strong></p>
                                <p>Provider will build automation or manual guidance paths for the following
                                    specific document categories:</p>
                                <p><strong>A. Identity & Vital Records</strong></p>
                                <ul>
                                    <li><strong>Death Certificate:</strong> Manual upload/OCR processing (No
                                        State
                                        API exists).</li>
                                    <li><strong>Social Security/Gov ID:</strong> Secure entry & validation.</li>
                                </ul>
                                <p><strong>B. Probate Court Filings (Launch States)</strong></p>
                                <ul>
                                    <li><strong>Maryland:</strong> Integration/Guidance for
                                        <strong>MDEC</strong>
                                        (Tyler Odyssey) system. Template generation for Petition for
                                        Administration,
                                        Inventory, and Accounts.
                                    </li>
                                    <li><strong>Illinois:</strong> Guidance for <strong>eCourt</strong> (Cook
                                        County) and standard circuit court forms.</li>
                                    <li><strong>Minnesota:</strong> Full guidance for <strong>MNCIS</strong>
                                        statewide e-filing system.</li>
                                    <li><em>Note: Where API filing is unavailable, the Platform will generate
                                            "Ready-to-Print" PDF packages.</em></li>
                                </ul>
                                <p><strong>C. Financial & Asset Documents</strong></p>
                                <ul>
                                    <li><strong>Asset Discovery:</strong> Integration of <strong>Plaid</strong>
                                        for
                                        retrieving balances, transactions, and liabilities from 12,000+
                                        financial
                                        institutions.</li>
                                    <li><strong>Life Insurance/Retirement:</strong> Generation of standard
                                        "Notice
                                        of Death & Claim" letters for major carriers (MetLife, Prudential,
                                        etc.).
                                    </li>
                                    <li><strong>Real Estate:</strong> Manual inventory tracking with integration
                                        to
                                        Zillow/Redfin APIs for valuation estimates (where available).</li>
                                </ul>

                                <h4>2.3 System Integrations</h4>
                                <p>Provider shall integrate the following third-party services to achieve
                                    automation:</p>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Service</th>
                                            <th>Purpose</th>
                                            <th>Integration Level</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>Plaid</strong></td>
                                            <td>Financial Account Linking</td>
                                            <td><strong>Deep Integration</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>OpenSign</strong></td>
                                            <td>E-Signatures</td>
                                            <td><strong>Self-Hosted (Full API)</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>Lob</strong></td>
                                            <td>Certified Mail / Physical Letters</td>
                                            <td><strong>API Triggered</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>SendGrid</strong></td>
                                            <td>Transactional Email</td>
                                            <td><strong>API Triggered</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>Google Document AI</strong></td>
                                            <td>OCR / Data Extraction</td>
                                            <td><strong>API Integrated</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>Vertex AI (Gemini)</strong></td>
                                            <td>Process Guidance</td>
                                            <td><strong>Context-Aware (RAG)</strong></td>
                                        </tr>
                                    </tbody>
                                </table>

                                <h4>2.4 "The Shepherd" Guidance Engine</h4>
                                <p>Provider shall build a logic engine ("The Shepherd") that:</p>
                                <ol>
                                    <li><strong>Ingests State Laws:</strong> Encodes probate timing rules for
                                        MD, IL, and MN.</li>
                                    <li><strong>Generates Timeline:</strong> Creates a dynamic, 18-month Gantt
                                        chart for the Executor.</li>
                                    <li><strong>Proactive Alerts:</strong> Notifies users of upcoming court
                                        deadlines (Inventory due in 90 days, Taxes due in 9 mo).</li>
                                    <li><strong>AI Assistance:</strong> Uses Gemini 3.0 to answer
                                        context-specific questions (e.g., "Is this expense deductible in
                                        Maryland?").</li>
                                </ol>

                                <h3>3. Work Breakdown Structure (WBS)</h3>
                                <p><strong>PHASE 0: STRATEGIC DESIGN & IDENTITY (Weeks 1-4)</strong></p>
                                <ul>
                                    <li>0.1 Brand Identity: Logo, Typography, Palette finalization.</li>
                                    <li>0.2 UX/UI Design System: Figma-based Web + Mobile design system.</li>
                                    <li>0.3 Prototyping: High-fidelity interaction models.</li>
                                    <li>0.4 Asset Production: Custom icons and illustrations.</li>
                                </ul>

                                <p><strong>PHASE 1: FOUNDATION & VAULT ARCHITECTURE (Weeks 1-4)</strong></p>
                                <ul>
                                    <li>1.1 GCP Infrastructure: Provision Cloud Run, Cloud SQL, Firestore, VPC,
                                        Cloud Armor.</li>
                                    <li>1.2 Ops: Setup GitHub Actions CI/CD.</li>
                                    <li>1.3 Auth: Firebase Auth + MFA + Custom Claims.</li>
                                    <li>1.4 Schema: Design Relational (Heirs) vs Document (Metadata) schemas.
                                    </li>
                                    <li>1.5 Vault: Implement AES-256 crypto service and Signed URL logic.</li>
                                    <li>1.6 Web: React + Vite + "Light Royal Neo-Deco" Design System.</li>
                                    <li>1.7 E-Sign: Deploy Self-Hosted OpenSign.</li>
                                </ul>
                                <p><strong>PHASE 2: CORE LOGIC & STATE ENGINES (Weeks 5-10)</strong></p>
                                <ul>
                                    <li>2.1 Asset Module: Plaid Link integration & manual asset overrides.</li>
                                    <li>2.2 Maryland Engine: Encode MD Register of Wills rules & forms.</li>
                                    <li>2.3 Illinois Engine: Encode IL Probate Division rules.</li>
                                    <li>2.4 Minnesota Engine: Encode MN District Court rules.</li>
                                    <li>2.5 Gemini RAG: Build vector store for legal context.</li>
                                    <li>2.6 PDF Service: Go-based PDF stamper for court forms.</li>
                                </ul>
                                <p><strong>PHASE 3: MOBILE & DEEP INTEGRATIONS (Weeks 11-16)</strong></p>
                                <ul>
                                    <li>3.1 Mobile: React Native Expo shell (iOS/Android).</li>
                                    <li>3.2 Bio-Auth: FaceID/TouchID wrapper.</li>
                                    <li>3.3 Scanner: Native camera module for receipt capture.</li>
                                    <li>3.4 Plaid/Lob: Full webhook handling and mail trigger logic.</li>
                                    <li>3.5 Offline: SQLite sync engine for mobile resilience.</li>
                                </ul>
                                <p><strong>PHASE 4: AUDIT, SECURITY & LAUNCH (Weeks 17-20)</strong></p>
                                <ul>
                                    <li>4.1 Pen Test: Third-party security audit & remediation.</li>
                                    <li>4.2 Compliance: SOC 2 evidence collection (logging, access controls).
                                    </li>
                                    <li>4.3 Load Test: Stress testing (k6) to 1,000 concurrent users.</li>
                                    <li>4.4 Store Launch: App Store & Play Store submission.</li>
                                    <li>4.5 Go-Live: DNS switchover and Production migration.</li>
                                </ul>
                                <p><strong>PHASE 5: CONTINGENCY & PROJECT MANAGEMENT (Ongoing)</strong></p>
                                <ul>
                                    <li>5.1 Project Management & Client Liaison.</li>
                                    <li>5.2 Manual QA & Cross-Platform Verification.</li>
                                    <li>5.3 User Feedback Loops & Iterative Refinement.</li>
                                    <li>5.4 Post-Launch Stabilization & Infrastructure Watch.</li>
                                </ul>

                                <h3>4. Deliverables</h3>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Deliverable</th>
                                            <th>Description</th>
                                            <th>Format</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>D1: The Vault</strong></td>
                                            <td>Security core, Auth, Encrypted Storage</td>
                                            <td>Staging URL</td>
                                        </tr>
                                        <tr>
                                            <td><strong>D2: State Engines</strong></td>
                                            <td>Form generation for MD, IL, MN</td>
                                            <td>API + UI</td>
                                        </tr>
                                        <tr>
                                            <td><strong>D3: Mobile Apps</strong></td>
                                            <td>iOS and Android binaries (TestFlight)</td>
                                            <td>.ipa / .apk</td>
                                        </tr>
                                        <tr>
                                            <td><strong>D4: The Platform</strong></td>
                                            <td>Production release, fully tested</td>
                                            <td>Live URL</td>
                                        </tr>
                                        <tr>
                                            <td><strong>D5: Documentation</strong></td>
                                            <td>API Specs, Admin Guide, Compliance Pack</td>
                                            <td>PDF / Markdown</td>
                                        </tr>
                                    </tbody>
                                </table>

                                <h3>5. Assumptions</h3>
                                <ol>
                                    <li><strong>Launch States Only:</strong> Logic is strictly limited to
                                        Maryland, Illinois, and Minnesota for V1.</li>
                                    <li><strong>No Legal Advice:</strong> The "Shepherd" provides procedural
                                        guidance, not legal advice. Disclaimer implementation is mandatory.</li>
                                    <li><strong>Third-Party Costs:</strong> Client pays direct consumption costs
                                        for Plaid, Lob, and Cloud IDs.</li>
                                    <li><strong>Content:</strong> Client is responsible for final validation of
                                        court form templates.</li>
                                </ol>
                            </section>

                            <hr class="border-[#C8A951]/20 my-16">

                            <section id="exhibit-b">
                                <h2 class="text-center font-serif text-3xl text-[#C8A951] mb-12">Exhibit B: Cost
                                    Proposal & ROI Analysis</h2>


                                <h3>1. Executive Summary</h3>
                                <p>This proposal offers a transparent, atomic breakdown of the investment
                                    required
                                    to
                                    build the "Vault-Grade" estate settlement platform. Unlike opaque agency
                                    pricing
                                    or
                                    "billable hour" law firm models, we provide a fixed-price engineering
                                    partnership.
                                </p>

                                <h3>2. Comparative Market Analysis</h3>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Metric</th>
                                            <th>"Big Law" Custom Tech</th>
                                            <th>Typical Dev Agency</th>
                                            <th>Sirsi (111 VS)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>Total Cost</strong></td>
                                            <td>$650,000+</td>
                                            <td>$350,000+</td>
                                            <td><strong>$200,000 (Standard)</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>Time to Market</strong></td>
                                            <td>18-24 Months</td>
                                            <td>9-12 Months</td>
                                            <td><strong>5 Months</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>Model</strong></td>
                                            <td>Billable Hour ($800/hr)</td>
                                            <td>Time & Materials</td>
                                            <td><strong>Co-Founder/Partner</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>IP Ownership</strong></td>
                                            <td>Firm Retains IP</td>
                                            <td>Vendor Lock-in</td>
                                            <td><strong>100% Client Owned</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>AI Capability</strong></td>
                                            <td>None / Rigid Logic</td>
                                            <td>Generic Chatbot</td>
                                            <td><strong>Gemini 3.0 Native</strong></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <blockquote>
                                    Analysis: We deliver 4x the speed at roughly 40% of the cost of a
                                    traditional
                                    enterprise build by leveraging our proprietary "Sirsi" component library and
                                    AI-accelerated development.
                                </blockquote>

                                <h3>3. Atomic Development Cost Breakdown</h3>
                                <p><strong>Phase 0: Design & Identity (Weeks 1-4) - $30,000</strong></p>
                                <ul>
                                    <li>Brand Identity (Logo, Typography, Palette): $6,000</li>
                                    <li>UX/UI Design System (Figma: Web + Mobile): $12,000</li>
                                    <li>High-Fidelity Prototyping: $6,000</li>
                                    <li>Asset Production (Icons, Illustrations): $6,000</li>
                                </ul>
                                <p><strong>Phase 1: Foundation & Vault (Weeks 1-4) - $30,000</strong></p>
                                <ul>
                                    <li>System Architecture: $8,000</li>
                                    <li>Cloud SQL / Firestore Schema: $5,500</li>
                                    <li>Vault Implementation (AES-256): $7,250</li>
                                    <li>OpenSign Setup: $2,250</li>
                                    <li>Frontend Shell: $7,000</li>
                                </ul>
                                <p><strong>Phase 2: Core Logic & "The Shepherd" (Weeks 5-10) - $35,000</strong>
                                </p>
                                <ul>
                                    <li>State Engines (MD, IL, MN): $11,000</li>
                                    <li>Gemini 3.0 RAG Pipeline: $9,500</li>
                                    <li>Legal Prompt Engineering: $6,000</li>
                                    <li>Frontend Guidance UI: $8,500</li>
                                </ul>
                                <p><strong>Phase 3: Living Legacy & Universal App (Weeks 11-16) -
                                        $38,000</strong>
                                </p>
                                <ul>
                                    <li>React Native Universal Shell: $14,000</li>
                                    <li>Living Legacy Features: $10,500</li>
                                    <li>Heir Naming & Distribution UI: $8,500</li>
                                    <li>Document Scanner: $5,000</li>
                                </ul>
                                <p><strong>Phase 4: QA, Security & Launch (Weeks 17-20) - $32,000</strong></p>
                                <ul>
                                    <li>Penetration Testing (External): $12,000</li>
                                    <li>End-to-End Testing (Cypress): $10,000</li>
                                    <li>SOC 2 Policy Generation: $4,000</li>
                                    <li>App Store Submission: $6,000</li>
                                </ul>
                                <p><strong>Phase 5: Contingency & Project Management - $35,000</strong></p>
                                <ul>
                                    <li>15% Project Contingency: $28,000</li>
                                    <li>Project Management & Client Liaison: $7,000</li>
                                </ul>

                                <h3>4. Infrastructure Bill of Materials (BoM)</h3>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Service</th>
                                            <th>Item</th>
                                            <th>Est. Unit Cost</th>
                                            <th>Purpose</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Compute</td>
                                            <td>Cloud Run</td>
                                            <td>~$18/mo</td>
                                            <td>Backend container</td>
                                        </tr>
                                        <tr>
                                            <td>Database</td>
                                            <td>Cloud SQL</td>
                                            <td>~$9/mo</td>
                                            <td>Secure PII storage</td>
                                        </tr>
                                        <tr>
                                            <td>NoSQL</td>
                                            <td>Firestore</td>
                                            <td>Free Tier</td>
                                            <td>User metadata</td>
                                        </tr>
                                        <tr>
                                            <td>Storage</td>
                                            <td>Cloud Storage</td>
                                            <td>$0.026/GB</td>
                                            <td>Document vault</td>
                                        </tr>
                                        <tr>
                                            <td>AI</td>
                                            <td>Vertex AI</td>
                                            <td>~$5/1M tokens</td>
                                            <td>Legal logic</td>
                                        </tr>
                                        <tr>
                                            <td>E-Sign</td>
                                            <td>OpenSign</td>
                                            <td>$20/mo</td>
                                            <td>Unlimited signatures</td>
                                        </tr>
                                    </tbody>
                                </table>

                                <div id="exhibit-b-dynamic"
                                    class="p-8 border border-[#C8A951]/20 rounded bg-white/5 italic text-center opacity-60">
                                    Selection Pending: Please select a partnership plan above to finalize
                                    Exhibit B
                                    and
                                    execute the agreement.
                                </div>
                            </section>
                        </div>
                    </div> <!-- End legal-scroll-box -->

                    <!-- MSA ACKNOWLEDGMENT BLOCK -->
                    <div id="msa-acknowledgment-block"
                        class="p-8 bg-white/5 border border-[#C8A951]/30 rounded text-center my-8 opacity-40 transition-all duration-500"
                        style="pointer-events: none;">
                        <p id="msa-status-line" class="text-white/90 font-medium mb-6">
                            ⏳ <span class="text-[#C8A951] uppercase tracking-wider text-xs">Step 2 of 3:</span>
                            <span id="msa-status-text">Please scroll to the bottom of the agreement to
                                continue.</span>
                        </p>
                        <label id="msa-ack-label" class="flex items-center justify-center gap-3 cursor-pointer mb-4"
                            style="pointer-events: none; opacity: 0.5;">
                            <input type="checkbox" id="msa-read-acknowledge" onchange="unlockPlanSelection()"
                                class="w-5 h-5 accent-[#C8A951] cursor-pointer" disabled>
                            <span class="text-sm text-white/80">I have read and understand the Master Services
                                Agreement
                                above.</span>
                        </label>
                        <button id="proceed-to-step2" disabled onclick="scrollToSignature()"
                            style="background: linear-gradient(to right, #C8A951, #E2C76B); color: #0f172a; padding: 12px 24px; font-weight: bold; font-size: 14px; text-transform: uppercase; letter-spacing: 0.1em; border-radius: 6px; border: none; cursor: not-allowed; opacity: 0.5; transition: all 0.3s;">
                            Proceed to Step 3: Sign
                        </button>
                    </div>

                    <!-- STEP 2: PLAN SELECTION (Now in correct scroll position - after MSA) -->
                    <div id="selection-phase"
                        style="margin-bottom: 64px; margin-top: 48px; max-width: 1200px; margin-left: auto; margin-right: auto; opacity: 0.4; pointer-events: none; transition: all 0.5s;">
                        <h2 id="step-2-plan-label"
                            style="text-align: center; font-family: Cinzel, serif; font-size: 28px; color: #C8A951; margin-bottom: 16px; text-transform: uppercase; letter-spacing: 0.15em;">
                            Step 2: Select Your Partnership Plan</h2>
                        <p
                            style="text-align: center; color: #94a3b8; margin-bottom: 48px; max-width: 600px; margin-left: auto; margin-right: auto; font-size: 14px; line-height: 1.6;">
                            <span id="plan-lock-notice" style="color: #EF4444;">🔒 Complete Step 1 to unlock
                                plan
                                selection.</span><br>
                            Choose a financial structure to amend Exhibit B.
                        </p>

                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem;">
                            <!-- PLAN A: 4 Monthly Payments -->
                            <div id="card-plan-a" class="plan-card-static"
                                style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.15); padding: 2rem; text-align: center; display: flex; flex-direction: column; transition: all 0.3s ease; cursor: pointer;"
                                onmouseover="this.style.borderColor='#C8A951'; this.style.boxShadow='0 0 30px rgba(200,169,81,0.2)';"
                                onmouseout="this.style.borderColor='rgba(255,255,255,0.15)'; this.style.boxShadow='none';">
                                <h3
                                    style="font-size: 24px; font-family: Cinzel, serif; color: white; margin-bottom: 0.5rem;">
                                    Plan A</h3>
                                <p style="font-size: 14px; color: white; margin-bottom: 1.5rem;">4 Monthly Payments</p>

                                <div
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-bottom: 1.5rem; flex-grow: 1;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 32px; font-family: Cinzel, serif; color: #C8A951;">
                                            $50,000</div>
                                        <div style="font-size: 14px; color: white;">per month × 4 months</div>
                                    </div>
                                    <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 1rem;">
                                        First payment due at signing
                                    </div>
                                </div>

                                <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem;">
                                    <div style="font-size: 14px; color: white; margin-bottom: 0.5rem;">Total
                                    </div>
                                    <div
                                        style="font-size: 20px; font-family: Cinzel, serif; color: white; font-weight: 600; margin-bottom: 1.5rem;">
                                        $200,000</div>
                                    <button onclick="selectContractPlan('Plan A', this)" class="select-plan-btn"
                                        style="width: 100%; padding: 14px 24px; background: linear-gradient(to right, #C8A951, #E2C76B); color: #000; font-weight: 700; font-size: 12px; text-transform: uppercase; letter-spacing: 0.15em; border: none; border-radius: 4px; cursor: pointer; transition: all 0.3s ease;">
                                        Select Plan
                                    </button>
                                </div>
                            </div>

                            <!-- PLAN B: 5 Monthly Payments -->
                            <div id="card-plan-b" class="plan-card-static"
                                style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.15); padding: 2rem; text-align: center; display: flex; flex-direction: column; transition: all 0.3s ease; cursor: pointer;"
                                onmouseover="this.style.borderColor='#C8A951'; this.style.boxShadow='0 0 30px rgba(200,169,81,0.2)';"
                                onmouseout="this.style.borderColor='rgba(255,255,255,0.15)'; this.style.boxShadow='none';">
                                <h3
                                    style="font-size: 24px; font-family: Cinzel, serif; color: white; margin-bottom: 0.5rem;">
                                    Plan B</h3>
                                <p style="font-size: 14px; color: white; margin-bottom: 1.5rem;">5 Monthly Payments</p>

                                <div
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-bottom: 1.5rem; flex-grow: 1;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 32px; font-family: Cinzel, serif; color: #C8A951;">
                                            $40,000</div>
                                        <div style="font-size: 14px; color: white;">per month × 5 months</div>
                                    </div>
                                    <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 1rem;">
                                        First payment due at signing
                                    </div>
                                </div>

                                <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem;">
                                    <div style="font-size: 14px; color: white; margin-bottom: 0.5rem;">Total
                                    </div>
                                    <div
                                        style="font-size: 20px; font-family: Cinzel, serif; color: white; font-weight: 600; margin-bottom: 1.5rem;">
                                        $200,000</div>
                                    <button onclick="selectContractPlan('Plan B', this)" class="select-plan-btn"
                                        style="width: 100%; padding: 14px 24px; background: linear-gradient(to right, #C8A951, #E2C76B); color: #000; font-weight: 700; font-size: 12px; text-transform: uppercase; letter-spacing: 0.15em; border: none; border-radius: 4px; cursor: pointer; transition: all 0.3s ease;">
                                        Select Plan
                                    </button>
                                </div>
                            </div>

                            <!-- PLAN C: 6 Monthly Payments -->
                            <div id="card-plan-c" class="plan-card-static"
                                style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.15); padding: 2rem; text-align: center; display: flex; flex-direction: column; transition: all 0.3s ease; cursor: pointer;"
                                onmouseover="this.style.borderColor='#C8A951'; this.style.boxShadow='0 0 30px rgba(200,169,81,0.2)';"
                                onmouseout="this.style.borderColor='rgba(255,255,255,0.15)'; this.style.boxShadow='none';">
                                <h3
                                    style="font-size: 24px; font-family: Cinzel, serif; color: white; margin-bottom: 0.5rem;">
                                    Plan C</h3>
                                <p style="font-size: 14px; color: white; margin-bottom: 1.5rem;">6 Monthly Payments</p>

                                <div
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-bottom: 1.5rem; flex-grow: 1;">
                                    <div style="margin-bottom: 1rem;">
                                        <div style="font-size: 32px; font-family: Cinzel, serif; color: #C8A951;">
                                            $33,333.33</div>
                                        <div style="font-size: 14px; color: white;">per month × 6 months</div>
                                    </div>
                                    <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 1rem;">
                                        First payment due at signing
                                    </div>
                                </div>

                                <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem;">
                                    <div style="font-size: 14px; color: white; margin-bottom: 0.5rem;">Total
                                    </div>
                                    <div
                                        style="font-size: 20px; font-family: Cinzel, serif; color: white; font-weight: 600; margin-bottom: 1.5rem;">
                                        $200,000</div>
                                    <button onclick="selectContractPlan('Plan C', this)" class="select-plan-btn"
                                        style="width: 100%; padding: 14px 24px; background: linear-gradient(to right, #C8A951, #E2C76B); color: #000; font-weight: 700; font-size: 12px; text-transform: uppercase; letter-spacing: 0.15em; border: none; border-radius: 4px; cursor: pointer; transition: all 0.3s ease;">
                                        Select Plan
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- STEP 3: SIGNATURE SECTION -->
                    <div id="step-3-label" class="text-center mt-20 mb-0 opacity-0 transition-opacity duration-1000">
                        <div
                            style="width: 100%; height: 1px; background: linear-gradient(to right, transparent, #C8A951, transparent); margin-bottom: 3rem;">
                        </div>
                        <h2 class="font-serif text-3xl text-[#C8A951] uppercase tracking-widest mb-2">
                            Step 3: Sign Agreement</h2>
                        <p class="text-white/60 text-sm">Review your selection and execute the agreement</p>
                    </div>

                    <div id="signature-block"
                        class="mt-8 scroll-mt-32 opacity-0 pointer-events-none transition-all duration-500"
                        style="max-width: 800px; margin: 0 auto;">

                        <!-- Signature Card -->
                        <div style="background: linear-gradient(145deg, rgba(200,169,81,0.08), rgba(0,0,0,0.4)); 
                                    border: 2px solid rgba(200,169,81,0.5); 
                                    border-radius: 16px; 
                                    padding: 3rem; 
                                    box-shadow: 0 0 60px rgba(200,169,81,0.15), inset 0 1px 0 rgba(255,255,255,0.05);">

                            <!-- Selected Plan Display -->
                            <div
                                style="text-align: center; margin-bottom: 2.5rem; padding-bottom: 2rem; border-bottom: 1px solid rgba(200,169,81,0.3);">
                                <div
                                    style="font-size: 12px; text-transform: uppercase; letter-spacing: 0.2em; color: rgba(255,255,255,0.5); margin-bottom: 0.5rem;">
                                    Your Selected Plan</div>
                                <div id="selected-plan-display"
                                    style="font-family: Cinzel, serif; font-size: 28px; color: #C8A951;">Plan Not
                                    Selected</div>
                            </div>

                            <!-- Agreement Checkbox -->
                            <div style="text-align: center; margin-bottom: 2rem;">
                                <label
                                    style="display: inline-flex; align-items: center; gap: 12px; cursor: pointer; padding: 1rem 2rem; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; transition: all 0.3s;">
                                    <input type="checkbox" id="msa-acknowledge" onchange="toggleExecuteButton()"
                                        style="width: 20px; height: 20px; accent-color: #C8A951; cursor: pointer;">
                                    <span style="color: rgba(255,255,255,0.8); font-size: 14px;">I agree to all terms
                                        and conditions of this Master Services Agreement</span>
                                </label>
                            </div>

                            <!-- Sign Button -->
                            <div style="text-align: center; margin-bottom: 2.5rem;">
                                <button onclick="initiateOpenSign()" id="execute-btn" disabled style="display: inline-flex; align-items: center; gap: 12px; padding: 18px 48px; 
                                           background: linear-gradient(145deg, #C8A951, #B8994A); 
                                           color: #0f172a; font-weight: 700; font-size: 16px; 
                                           text-transform: uppercase; letter-spacing: 0.15em;
                                           border: none; border-radius: 50px; cursor: not-allowed;
                                           box-shadow: 0 8px 30px rgba(200,169,81,0.3);
                                           opacity: 0.5; transition: all 0.3s ease;">
                                    <svg width="24" height="24" fill="none" viewBox="0 0 24 24" stroke="currentColor"
                                        stroke-width="2">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                                    </svg>
                                    Sign Agreement
                                </button>
                                <p style="color: rgba(255,255,255,0.4); font-size: 12px; margin-top: 1rem;">
                                    You will be redirected to OpenSign for secure digital signature
                                </p>
                            </div>

                            <!-- Signature Lines -->
                            <div
                                style="display: flex; justify-content: center; gap: 4rem; padding-top: 2rem; border-top: 1px solid rgba(200,169,81,0.2);">
                                <div style="text-align: center;">
                                    <div
                                        style="border-bottom: 2px solid rgba(200,169,81,0.5); padding-bottom: 8px; margin-bottom: 8px; min-width: 220px;">
                                        <span
                                            style="font-family: 'Georgia', serif; font-style: italic; color: white; font-size: 18px;">Tameeka
                                            Lockhart</span>
                                    </div>
                                    <span
                                        style="color: rgba(255,255,255,0.4); font-size: 11px; text-transform: uppercase; letter-spacing: 0.1em;">
                                        Client · <span id="date-signature">Pending Execution</span>
                                    </span>
                                </div>
                                <div style="text-align: center;">
                                    <div
                                        style="border-bottom: 2px solid rgba(200,169,81,0.5); padding-bottom: 8px; margin-bottom: 8px; min-width: 220px;">
                                        <span
                                            style="font-family: 'Georgia', serif; font-style: italic; color: white; font-size: 18px;">Cylton
                                            Collymore</span>
                                    </div>
                                    <span
                                        style="color: rgba(255,255,255,0.4); font-size: 11px; text-transform: uppercase; letter-spacing: 0.1em;">
                                        Provider · Sirsi Technologies
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Download Link -->
                        <div style="text-align: center; margin-top: 2rem;">
                            <button onclick="downloadMSAPdf(event)"
                                style="color: rgba(200,169,81,0.6); font-size: 12px; background: none; border: none; cursor: pointer; text-decoration: underline;">
                                Download unsigned MSA as PDF
                            </button>
                        </div>
                    </div>
                </div> <!-- End Contract Tab -->
            </div> <!-- End Main Card -->
    </div> <!-- End Immersive Wrapper -->
    </main>
    </div> <!-- End Admin Wrapper -->

    <!-- Scripts -->
    <!-- Sidebar -->
    <script src="/components/sidebar.js"></script>
    <!-- Header -->
    <script src="/components/universal-header.js"></script>

    <script>
        function switchTab(tabId) {
            // Hide all content
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));

            // Show target
            document.getElementById(tabId).classList.add('active');

            // Scroll to top
            const container = document.querySelector('.main-content') || window;
            container.scrollTo({ top: 0, behavior: 'smooth' });

            // Activate btn
            const buttons = document.querySelectorAll('.tab-btn');
            if (tabId === 'sow') buttons[0].classList.add('active');
            if (tabId === 'cost') buttons[1].classList.add('active');
            if (tabId === 'contract') buttons[2].classList.add('active');

            // Handle Stepper Visibility and Update
            const verticalGuide = document.getElementById('vertical-workflow-guide');
            if (verticalGuide) {
                if (tabId === 'contract') {
                    verticalGuide.style.display = 'flex';
                    // FIX 4: Properly sync stepper based on full state
                    const storedPlan = sessionStorage.getItem('selectedPlan') || selectedPlan;
                    const msaAcknowledged = document.getElementById('msa-read-acknowledge')?.checked;

                    if (storedPlan && msaAcknowledged) {
                        currentStep = 3;
                        updateStepperStatus(3);
                    } else if (storedPlan) {
                        currentStep = 2;
                        updateStepperStatus(2);
                    } else {
                        currentStep = 1;
                        updateStepperStatus(1);
                    }
                } else {
                    verticalGuide.style.display = 'none';
                }
            }
        }

        // ============================================
        // GLOBAL STATE
        // ============================================
        let currentStep = 1;
        let msaExecuted = false;
        let selectedPlan = null; // Track selected plan

        // Select plan from COST tab and navigate to MSA
        function selectPlanFromCost(planName, btnElement) {
            selectedPlan = planName;
            // Persist plan selection to sessionStorage for page navigation
            sessionStorage.setItem('selectedPlan', planName);

            // Reset all buttons in COST tab
            const costTab = document.getElementById('cost');
            if (costTab) {
                costTab.querySelectorAll('.select-plan-btn').forEach(b => {
                    b.innerHTML = 'SELECT PLAN';
                    b.style.background = 'linear-gradient(to right, #C8A951, #E2C76B)';
                });
                costTab.querySelectorAll('.plan-card-static').forEach(c => {
                    c.style.borderColor = 'rgba(255,255,255,0.15)';
                    c.style.boxShadow = 'none';
                });
            }

            // Highlight selected card and button
            const card = btnElement.closest('.plan-card-static');
            if (card) {
                card.style.borderColor = '#C8A951';
                card.style.boxShadow = '0 0 30px rgba(200,169,81,0.3)';
            }
            btnElement.innerHTML = '✓ SELECTED';

            // Update stepper to show Step 1 complete
            currentStep = 1;
            updateStepperStatus(1);

            // Update MSA tab to show selected plan and skip the duplicate plan selection
            const selectionPhase = document.getElementById('selection-phase');
            if (selectionPhase) {
                // Hide the plan selection in MSA tab since already selected
                selectionPhase.style.display = 'none';
            }

            // Update any "Selected Plan" display in MSA
            const planLockNotice = document.getElementById('plan-lock-notice');
            if (planLockNotice) {
                planLockNotice.style.color = '#10B981';
                planLockNotice.innerHTML = `✓ ${planName} Selected`;
            }

            // Update the selected plan display in signature card
            const selectedPlanDisplay = document.getElementById('selected-plan-display');
            if (selectedPlanDisplay) {
                selectedPlanDisplay.textContent = planName;
            }

            // Scroll to the Next button so user can proceed when ready
            const nextBtn = costTab.querySelector('button[onclick*="switchTab"]');
            if (nextBtn) {
                nextBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function selectContractPlan(planName, btnElement) {
            currentStep = 3; // Move to Step 3
            updateStepperStatus(3);
            // 1. Reset All UI
            // Reset borders
            document.querySelectorAll('.plan-card-static').forEach(c => {
                c.style.borderColor = 'rgba(255, 255, 255, 0.1)';
                c.style.backgroundColor = 'rgba(0, 0, 0, 0.4)';
            });
            // Reset buttons
            document.querySelectorAll('.select-plan-btn').forEach(b => {
                b.innerHTML = 'SELECT PLAN';
                b.style.backgroundColor = 'transparent';
                b.style.color = '#C8A951';
            });

            // 2. Activate Selected
            const card = btnElement.closest('.plan-card-static');
            card.style.borderColor = '#C8A951';
            card.style.backgroundColor = 'rgba(200, 169, 81, 0.05)';

            btnElement.innerHTML = 'SELECTED';
            btnElement.style.backgroundColor = '#C8A951';
            btnElement.style.color = '#000000';

            // 3. Update Step 3 Label safely
            const step3Label = document.getElementById('step-3-label');
            if (step3Label) {
                step3Label.classList.remove('opacity-0');
                step3Label.classList.add('opacity-100');
            }

            // 5b. Ensure Signature Block is Visible
            const signatureBlock = document.getElementById('signature-block');
            if (signatureBlock) {
                // Ensure it's visible - remove any utility classes that might hide it
                // We rely on standard CSS/HTML visibility here, removing explicit 'hidden' states
                signatureBlock.classList.remove('opacity-0', 'pointer-events-none', 'hidden', 'invisible');
                signatureBlock.style.opacity = '1'; // Ensure opacity is up for transition
                signatureBlock.style.pointerEvents = 'auto';

                signatureBlock.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            // 5. Reveal MSA Action Bar (Draft State) if it exists
            const msaFab = document.getElementById('msa-fab');
            if (msaFab) {
                msaFab.classList.remove('opacity-0', 'pointer-events-none', 'translate-y-8');
                msaFab.classList.add('opacity-100', 'translate-y-0');
                updateMSAState('draft'); // Set to draft explicitly
            }

            // 4. Update Exhibit B
            const dynamicBlock = document.getElementById('exhibit-b-dynamic');
            let planContent = '';

            if (planName === 'Plan A') {
                planContent = `
                    <h3>5. Payment Schedule (Option A: 4 Monthly Payments)</h3>
                    <p>Monthly payment structure spread across 4 months for consistent cash flow management.</p>
                    <table class="w-full text-left border-collapse mt-4">
                        <tr class="border-b border-white/10"><td class="py-2">Month 1 (Signing)</td><td class="text-right text-[#C8A951]">$50,000</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 2</td><td class="text-right text-[#C8A951]">$50,000</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 3</td><td class="text-right text-[#C8A951]">$50,000</td></tr>
                        <tr><td class="py-2">Month 4</td><td class="text-right text-[#C8A951]">$50,000</td></tr>
                    </table>
                    <p class="mt-4 text-sm font-bold opacity-60">Total Contract Value: $200,000 USD</p>
                `;
            } else if (planName === 'Plan B') {
                planContent = `
                    <h3>5. Payment Schedule (Option B: 5 Monthly Payments)</h3>
                    <p>Extended payment structure across 5 months for greater flexibility.</p>
                    <table class="w-full text-left border-collapse mt-4">
                        <tr class="border-b border-white/10"><td class="py-2">Month 1 (Signing)</td><td class="text-right text-[#C8A951]">$40,000</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 2</td><td class="text-right text-[#C8A951]">$40,000</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 3</td><td class="text-right text-[#C8A951]">$40,000</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 4</td><td class="text-right text-[#C8A951]">$40,000</td></tr>
                        <tr><td class="py-2">Month 5</td><td class="text-right text-[#C8A951]">$40,000</td></tr>
                    </table>
                    <p class="mt-4 text-sm font-bold opacity-60">Total Contract Value: $200,000 USD</p>
                `;
            } else if (planName === 'Plan C') {
                planContent = `
                    <h3>5. Payment Schedule (Option C: 6 Monthly Payments)</h3>
                    <p>Maximum flexibility with lowest monthly payment spread across 6 months.</p>
                    <table class="w-full text-left border-collapse mt-4">
                        <tr class="border-b border-white/10"><td class="py-2">Month 1 (Signing)</td><td class="text-right text-[#C8A951]">$33,333.33</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 2</td><td class="text-right text-[#C8A951]">$33,333.33</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 3</td><td class="text-right text-[#C8A951]">$33,333.33</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 4</td><td class="text-right text-[#C8A951]">$33,333.33</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 5</td><td class="text-right text-[#C8A951]">$33,333.33</td></tr>
                        <tr><td class="py-2">Month 6</td><td class="text-right text-[#C8A951]">$33,333.35</td></tr>
                    </table>
                    <p class="mt-4 text-sm font-bold opacity-60">Total Contract Value: $200,000 USD</p>
                `;
            }

            dynamicBlock.innerHTML = planContent;
            dynamicBlock.classList.remove('opacity-60', 'italic', 'text-center');
            dynamicBlock.style.background = 'rgba(200, 169, 81, 0.05)';
            dynamicBlock.style.borderColor = 'rgba(200, 169, 81, 0.5)';

            // 5. Scroll to Step 3 (Signature Block)
            // 5. Scroll to Step 3 (Signature Block)
            setTimeout(() => {
                if (step3Label) step3Label.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 300);
        }

        // Dynamic Date Population & Plan State Restoration
        document.addEventListener('DOMContentLoaded', function () {
            const today = new Date();
            const year = today.getFullYear();

            // Format: December 18, 2025
            const longDate = today.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            // Format: 12/18/2025
            const shortDate = today.toLocaleDateString('en-US', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            });

            // Populate all date elements
            const dateElements = {
                'date-proposal': longDate,
                'date-sow': longDate,
                'year-ref': year,
                'year-msa': year,
                'date-msa-global': longDate,
                'date-msa-effective': longDate,
                'year-sow-exhibit': year,
                'year-msa-exhibit': year,
                'date-exhibit-a': longDate,
                'date-exhibit-b': longDate,
                'date-signature': 'Pending Execution'
            };

            for (const [id, value] of Object.entries(dateElements)) {
                const el = document.getElementById(id);
                if (el) el.textContent = value;
            }

            // RESTORE SELECTED PLAN FROM SESSION STORAGE
            const storedPlan = sessionStorage.getItem('selectedPlan');
            if (storedPlan) {
                selectedPlan = storedPlan;

                // FIX 1: Hide plan selection in MSA since already selected
                const selectionPhase = document.getElementById('selection-phase');
                if (selectionPhase) {
                    selectionPhase.style.display = 'none';
                }

                // Update the selected plan display in signature block
                const selectedPlanDisplay = document.getElementById('selected-plan-display');
                if (selectedPlanDisplay) {
                    selectedPlanDisplay.textContent = storedPlan;
                }
                // Update plan lock notice if exists
                const planLockNotice = document.getElementById('plan-lock-notice');
                if (planLockNotice) {
                    planLockNotice.style.color = '#10B981';
                    planLockNotice.innerHTML = `✓ ${storedPlan} Selected`;
                }
                // Mark the correct plan card as selected in Cost tab
                const costTab = document.getElementById('cost');
                if (costTab) {
                    const planMap = { 'Plan A': 'cost-card-plan-a', 'Plan B': 'cost-card-plan-b', 'Plan C': 'cost-card-plan-c' };

                    const cardId = planMap[storedPlan];
                    if (cardId) {
                        const card = document.getElementById(cardId);
                        if (card) {
                            card.style.borderColor = '#C8A951';
                            card.style.boxShadow = '0 0 30px rgba(200,169,81,0.3)';
                            const btn = card.querySelector('.select-plan-btn');
                            if (btn) btn.innerHTML = '✓ SELECTED';
                        }
                    }
                }
                console.log('Restored plan from session:', storedPlan);
            }
        });


        // ============================================
        // SCROLL DETECTION FOR MSA
        // ============================================
        let msaScrollComplete = false;

        document.addEventListener('DOMContentLoaded', function () {
            const scrollBox = document.getElementById('legal-scroll-container');
            const contractDoc = document.getElementById('contract-document');
            const msaStatusLine = document.getElementById('msa-status-line');
            const msaStatusText = document.getElementById('msa-status-text');
            const msaAckBlock = document.getElementById('msa-acknowledgment-block');
            const msaAckLabel = document.getElementById('msa-ack-label');
            const msaCheckbox = document.getElementById('msa-read-acknowledge');
            const verticalGuide = document.getElementById('vertical-workflow-guide');

            if (scrollBox) {
                // Use scroll position check instead of IntersectionObserver
                // because msaAckBlock is now OUTSIDE the scroll container
                scrollBox.addEventListener('scroll', function () {
                    if (msaScrollComplete) return;

                    const scrollTop = scrollBox.scrollTop;
                    const scrollHeight = scrollBox.scrollHeight;
                    const clientHeight = scrollBox.clientHeight;

                    // Trigger when user is within 50px of the bottom
                    if (scrollTop + clientHeight >= scrollHeight - 50) {
                        msaScrollComplete = true;

                        // Unlock the acknowledgment block
                        if (msaAckBlock) {
                            msaAckBlock.style.opacity = '1';
                            msaAckBlock.style.pointerEvents = 'auto';
                        }

                        // Update Status
                        if (msaStatusLine) {
                            msaStatusLine.innerHTML = `✅ <span class="text-[#10B981] uppercase tracking-wider text-xs">Step 2 of 3:</span> <span id="msa-status-text">Agreement Read. Please check the box below to acknowledge.</span>`;
                        }

                        // Enable the checkbox
                        if (msaAckLabel) {
                            msaAckLabel.style.pointerEvents = 'auto';
                            msaAckLabel.style.opacity = '1';
                        }
                        if (msaCheckbox) {
                            msaCheckbox.disabled = false;
                        }
                    }
                });
            }

            // ============================================
            // VERTICAL PROGRESS TRACKING
            // ============================================
            const verticalProgressBox = document.getElementById('legal-scroll-container');

            if (verticalProgressBox) {
                verticalProgressBox.addEventListener('scroll', function () {
                    const contractTab = document.getElementById('contract');
                    if (!contractTab || contractTab.style.display === 'none') return;

                    const scrollTop = verticalProgressBox.scrollTop;
                    const scrollHeight = verticalProgressBox.scrollHeight - verticalProgressBox.clientHeight;

                    // Always ensure it's unhidden when on the right tab
                    if (verticalGuide) verticalGuide.style.display = 'flex';

                    // Show/Hide Vertical Guide based on scroll
                    if (scrollTop > 20) {
                        verticalGuide.classList.remove('opacity-0', 'pointer-events-none');
                        verticalGuide.classList.add('opacity-100', 'pointer-events-auto');
                    } else {
                        verticalGuide.classList.add('opacity-0', 'pointer-events-none');
                        verticalGuide.classList.remove('opacity-100', 'pointer-events-auto');
                    }

                    // Simple 0-100 calculation for the internal box
                    const progress = (scrollTop / scrollHeight) * 100;

                    let finalProgress = Math.max(0, Math.min(100, progress));

                    // Update vertical fill (Step 1 is the first 33%)
                    const progressFill = document.getElementById('v-progress-fill');
                    if (progressFill && currentStep === 1) {
                        progressFill.style.height = (finalProgress / 3) + "%";
                    }
                });
            }

            // ============================================
            // GLOBAL HYBRID PROGRESS (Steps 2 & 3)
            // ============================================
            const globalScroller = document.getElementById('contract-immersive-wrapper');
            if (globalScroller) {
                globalScroller.addEventListener('scroll', function () {
                    if (currentStep < 2) return; // Wait for Step 1 completion

                    const scrollTop = globalScroller.scrollTop;
                    const scrollHeight = globalScroller.scrollHeight - globalScroller.clientHeight;

                    // Always show guide when on MSA phase
                    const contractTab = document.getElementById('contract');
                    if (contractTab && contractTab.style.display !== 'none' && verticalGuide) {
                        verticalGuide.style.display = 'flex';
                        verticalGuide.classList.remove('opacity-0', 'pointer-events-none');
                        verticalGuide.classList.add('opacity-100', 'pointer-events-auto');
                    }

                    // Calculate progress for Steps 2 & 3
                    // Step 2 starts at ~33% and ends at ~66%
                    // Step 3 starts at ~66% and ends at 100%

                    const progressFill = document.getElementById('v-progress-fill');
                    if (progressFill) {
                        if (currentStep === 2) {
                            // Map scroll from 0 to 50% of page to 33-66% of bar
                            // (This is a heuristic since plans are at the top)
                            let globalProgress = (scrollTop / (scrollHeight * 0.5)) * 33.3;
                            progressFill.style.height = (33.3 + Math.min(33.3, globalProgress)) + "%";
                        } else if (currentStep === 3) {
                            // Map scroll from 50% to 100% of page to 66-100% of bar
                            let globalProgress = ((scrollTop - (scrollHeight * 0.5)) / (scrollHeight * 0.5)) * 33.3;
                            progressFill.style.height = (66.6 + Math.min(33.3, Math.max(0, globalProgress))) + "%";
                        }
                    }
                });
            }
        });

        function updateStepperStatus(step) {
            const vNodes = [
                document.getElementById('v-step-1'),
                document.getElementById('v-step-2'),
                document.getElementById('v-step-3')
            ];
            const vProgressFill = document.getElementById('v-progress-fill');

            vNodes.forEach((node, idx) => {
                if (!node) return;
                const circle = node.querySelector('div');
                const label = node.querySelector('span');

                if (idx < step - 1) {
                    // Completed Steps
                    node.classList.remove('opacity-30', 'grayscale');
                    circle.innerHTML = '✓';
                    circle.className = "w-10 h-10 rounded-full bg-[#10B981] border border-[#10B981] text-white flex items-center justify-center font-bold transition-all duration-500 scale-100";
                    label.style.color = '#10B981';
                    label.className = label.className.replace('text-gold', 'text-[#10B981]').replace('text-white/50', 'text-[#10B981]');
                } else if (idx === step - 1) {
                    // Current Step
                    node.classList.remove('opacity-30', 'grayscale');
                    circle.innerHTML = idx + 1;
                    circle.className = "w-10 h-10 rounded-full bg-gold border border-gold/50 text-navy flex items-center justify-center font-bold shadow-[0_0_20px_rgba(200,169,81,0.3)] transition-all duration-500 scale-110";
                    label.style.color = '#C8A951';
                } else {
                    // Future Steps
                    node.classList.add('opacity-30', 'grayscale');
                    circle.innerHTML = idx + 1;
                    circle.className = "w-10 h-10 rounded-full bg-[#0f172a] border border-white/20 text-white flex items-center justify-center font-bold transition-all duration-500 scale-100";
                    label.style.color = 'rgba(255,255,255,0.5)';
                }
            });

            if (vProgressFill) {
                if (step === 1) {
                    // Handled by internal scroll listener v1.1.0
                } else if (step === 2) {
                    vProgressFill.style.height = '66.6%'; // Move to end of Step 2
                } else if (step === 3) {
                    vProgressFill.style.height = '100%';
                }
            }
        }

        function unlockPlanSelection() {
            const checkbox = document.getElementById('msa-read-acknowledge');
            const proceedBtn = document.getElementById('proceed-to-step2');
            const msaStatusLine = document.getElementById('msa-status-line');
            const step3Label = document.getElementById('step-3-label');
            const signatureBlock = document.getElementById('signature-block');

            // FIX 2 & 3: Validate that a plan was selected before allowing Step 3
            const storedPlan = sessionStorage.getItem('selectedPlan') || selectedPlan;

            if (!storedPlan) {
                console.warn('Cannot proceed to Step 3 without selecting a plan first');
                if (checkbox) checkbox.checked = false;
                alert('Please select a plan from the Cost & Valuation tab before proceeding.');
                return;
            }

            if (checkbox && proceedBtn) {
                if (checkbox.checked) {
                    // MSA acknowledged - move to Step 3
                    currentStep = 3;
                    updateStepperStatus(3);

                    // Ensure plan is displayed in Step 3
                    const selectedPlanDisplay = document.getElementById('selected-plan-display');
                    if (selectedPlanDisplay) {
                        selectedPlanDisplay.textContent = storedPlan;
                    }

                    proceedBtn.disabled = false;
                    proceedBtn.style.opacity = '1';
                    proceedBtn.style.cursor = 'pointer';
                    proceedBtn.style.boxShadow = '0 4px 20px rgba(200, 169, 81, 0.3)';

                    if (msaStatusLine) {
                        msaStatusLine.innerHTML = `✨ <span class="text-[#10B981] uppercase tracking-wider text-xs">Step 2 Complete:</span> <span id="msa-status-text">Acknowledged. Click below to proceed to signature.</span>`;
                    }

                    // Reveal Step 3 label
                    if (step3Label) {
                        step3Label.classList.remove('opacity-0');
                        step3Label.classList.add('opacity-100');
                    }

                    // Reveal signature block
                    if (signatureBlock) {
                        signatureBlock.classList.remove('opacity-0', 'pointer-events-none');
                        signatureBlock.style.opacity = '1';
                        signatureBlock.style.pointerEvents = 'auto';
                    }
                } else {
                    // Unchecked - go back to Step 2
                    currentStep = 2;
                    updateStepperStatus(2);

                    proceedBtn.disabled = true;
                    proceedBtn.style.opacity = '0.5';
                    proceedBtn.style.cursor = 'not-allowed';
                    proceedBtn.style.boxShadow = 'none';

                    if (msaStatusLine) {
                        msaStatusLine.innerHTML = `✅ <span class="text-[#10B981] uppercase tracking-wider text-xs">Step 2 of 3:</span> <span id="msa-status-text">Agreement Read. Please check the box below to acknowledge.</span>`;
                    }

                    // Hide Step 3 label
                    if (step3Label) {
                        step3Label.classList.remove('opacity-100');
                        step3Label.classList.add('opacity-0');
                    }
                }
            }
        }

        function scrollToSignature() {
            // Already at Step 3 from unlockPlanSelection, just scroll to signature
            const signatureBlock = document.getElementById('signature-block');
            const step3Label = document.getElementById('step-3-label');

            // Ensure signature block is visible
            if (signatureBlock) {
                signatureBlock.classList.remove('opacity-0', 'pointer-events-none');
                signatureBlock.style.opacity = '1';
                signatureBlock.style.pointerEvents = 'auto';
            }

            // Ensure Step 3 label is visible
            if (step3Label) {
                step3Label.classList.remove('opacity-0');
                step3Label.classList.add('opacity-100');
            }

            // Scroll to signature
            requestAnimationFrame(() => {
                if (step3Label) {
                    step3Label.scrollIntoView({ behavior: 'smooth', block: 'start' });
                } else if (signatureBlock) {
                    signatureBlock.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        }

        function updateMSAState(state) {
            const msaDownloadLabel = document.getElementById('msa-download-label');
            const msaDownloadBtn = document.getElementById('msa-download-btn');
            const msaEmailLabel = document.getElementById('msa-email-label');
            const msaEmailBtn = document.getElementById('msa-email-btn');
            const msaPrintLabel = document.getElementById('msa-print-label');
            const msaPrintBtn = document.getElementById('msa-print-btn');

            if (state === 'executed') {
                msaExecuted = true;
                // Label updates
                if (msaDownloadLabel) msaDownloadLabel.textContent = 'Download Executed MSA';
                if (msaEmailLabel) msaEmailLabel.textContent = 'Email Executed MSA';
                if (msaPrintLabel) msaPrintLabel.textContent = 'Print Executed MSA';

                // Button tooltips
                if (msaDownloadBtn) msaDownloadBtn.title = 'Download Executed MSA';
                if (msaEmailBtn) msaEmailBtn.title = 'Email Executed MSA to myself';
                if (msaPrintBtn) msaPrintBtn.title = 'Print Executed MSA';

                // Specific Styling for prominence
                if (msaDownloadBtn) msaDownloadBtn.style.background = 'linear-gradient(135deg, #10B981, #059669)';
            } else {
                msaExecuted = false;
                // Draft State (Default)
                if (msaDownloadLabel) msaDownloadLabel.textContent = 'Download Draft';
                if (msaEmailLabel) msaEmailLabel.textContent = 'Email Draft';
                if (msaPrintLabel) msaPrintLabel.textContent = 'Print Draft';

                if (msaDownloadBtn) msaDownloadBtn.title = 'Download Draft';
                if (msaEmailBtn) msaEmailBtn.title = 'Email Draft to myself';
                if (msaPrintBtn) msaPrintBtn.title = 'Print Draft';

                if (msaDownloadBtn) msaDownloadBtn.style.background = 'linear-gradient(135deg, #C8A951, #E2C76B)';
            }
        }

        async function downloadTabPdf(e, tabId, filename) {
            const btn = e ? e.target.closest('button') : null;
            const originalHTML = btn ? btn.innerHTML : '';

            if (btn) {
                btn.innerHTML = '<svg class="animate-spin" width="16" height="16" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" opacity="0.3"></circle><path fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>';
                btn.disabled = true;
                btn.title = "Generating High-Fidelity PDF...";
            }

            try {
                // Determine target element or document
                let elementId = tabId === 'contract' ? 'contract-document' : tabId;

                // Attempt OpenSign Rendering
                const pdfData = await downloadPdfviaOpenSign(elementId, filename);

                if (pdfData) {
                    const link = document.createElement('a');
                    link.href = `data:application/pdf;base64,${pdfData}`;
                    link.download = filename;
                    link.click();
                } else {
                    console.warn('OpenSign Render returned no data, falling back to browser print.');
                    const usePrint = confirm('High-fidelity PDF generation failed or timed out.\n\nWould you like to use the browser\'s standard print dialog instead?');
                    if (usePrint) window.print();
                }
            } catch (err) {
                console.error('Download error:', err);
                const usePrint = confirm('An error occurred during PDF generation.\n\nUse browser standard print instead?');
                if (usePrint) window.print();
            } finally {
                if (btn) {
                    btn.innerHTML = originalHTML;
                    btn.disabled = false;
                    btn.title = tabId === 'contract' ? 'Download as PDF' : 'Download PDF';
                }
            }
        }

        /**
         * Generic PDF download utility via OpenSign Render API
         */
        async function downloadPdfviaOpenSign(elementId, filename) {
            const element = document.getElementById(elementId);
            if (!element) return;

            try {
                // Construct styles
                const styles = Array.from(document.styleSheets)
                    .map(sheet => {
                        try {
                            return Array.from(sheet.cssRules).map(rule => rule.cssText).join('');
                        } catch (e) { return ''; }
                    }).join('');

                const htmlContent = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
                        <style>
                            ${styles}
                            body { background: white !important; color: #1e293b !important; padding: 40px; font-family: 'Inter', sans-serif; }
                            .glass-panel { background: rgba(0, 0, 0, 0.02); border: 1px solid rgba(0, 0, 0, 0.1); }
                            .tab-content { display: block !important; opacity: 1 !important; }
                        </style>
                    </head>
                    <body>
                        <div class="legal-viewer" id="contract-document">
                            ${element.innerHTML}
                        </div>
                    </body>
                    </html>
                `;

                // Call OpenSign Render API
                // Note: In production, this uses Firebase Auth for 'authenticate' middleware
                const user = firebase.auth().currentUser;
                const idToken = user ? await user.getIdToken() : '';

                const response = await fetch('https://sign.sirsi.ai/api/render', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${idToken}`
                    },
                    body: JSON.stringify({
                        html: htmlContent,
                        filename: filename
                    })
                });

                const result = await response.json();
                if (result.success && result.pdfBase64) return result.pdfBase64;
                throw new Error(result.message || 'Rendering failed');
            } catch (error) {
                console.warn('OpenSign Render failed:', error);
                // Fallback to local high-fidelity print or jsPDF
                return null;
            }
        }

        async function downloadMSAPdf(e) {
            const filename = msaExecuted
                ? 'Legacy_Estate_OS_Master_Agreement_EXECUTED.pdf'
                : 'Legacy_Estate_OS_Master_Agreement_DRAFT.pdf';

            const contractDoc = document.getElementById('contract-document');
            if (!contractDoc) {
                alert('Contract document not found.');
                return;
            }

            const btn = e ? e.target.closest('button') : null;
            const originalHTML = btn ? btn.innerHTML : '';

            if (btn) {
                btn.innerHTML = '<svg class="animate-spin" width="16" height="16" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" opacity="0.3"></circle><path fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>';
                btn.disabled = true;
            }

            try {
                // Use html2pdf.js directly - simple and reliable
                const opt = {
                    margin: [0.5, 0.5, 0.5, 0.5],
                    filename: filename,
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2, useCORS: true, letterRendering: true },
                    jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
                };

                await html2pdf().set(opt).from(contractDoc).save();
                console.log('✅ PDF generated via html2pdf.js');
            } catch (err) {
                console.error('PDF generation error:', err);
                // Fallback to browser print
                const usePrint = confirm('PDF generation failed. Use browser print instead?');
                if (usePrint) window.print();
            } finally {
                if (btn) {
                    btn.innerHTML = originalHTML;
                    btn.disabled = false;
                }
            }
        }

        async function emailMSAToSelf(e) {
            const user = firebase.auth().currentUser;
            if (!user || !user.email) {
                alert('Please log in to use this feature.');
                return;
            }

            const contractDoc = document.getElementById('contract-document');
            if (!contractDoc) {
                alert('Contract document not found.');
                return;
            }

            const confirmSend = confirm(`Send the Master Services Agreement to:\n${user.email}?`);
            if (!confirmSend) return;

            const btn = e ? e.target.closest('button') : document.querySelector('#msa-fab button:nth-child(2)');
            const originalHTML = btn.innerHTML;
            btn.innerHTML = '<svg class="animate-spin" width="20" height="20" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke="#C8A951" stroke-width="3" opacity="0.3"></circle><path fill="#C8A951" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>';
            btn.disabled = true;

            try {
                // 1. Attempt OpenSign Render
                let pdfBase64 = await downloadPdfviaOpenSign('contract-document', 'MSA.pdf');

                // 2. Client-side fallback if OpenSign is unavailable/WIP
                if (!pdfBase64 && typeof html2pdf !== 'undefined') {
                    const opt = {
                        margin: [0.5, 0.5, 0.5, 0.5],
                        filename: 'Legacy_Estate_OS_MSA.pdf',
                        html2canvas: { scale: 2, useCORS: true },
                        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
                    };
                    pdfBase64 = await html2pdf().set(opt).from(contractDoc).outputPdf('datauristring').then(d => d.split(',')[1]);
                }

                if (!pdfBase64) {
                    throw new Error('Could not generate PDF attachment. Please try downloading instead.');
                }

                // 3. Call Firebase Function to send email
                const sendContractEmail = firebase.functions().httpsCallable('sendContractEmail');
                await sendContractEmail({
                    email: user.email,
                    pdfBase64: pdfBase64,
                    documentType: 'Master Services Agreement'
                });

                alert(`✅ Agreement sent to ${user.email}!`);
            } catch (err) {
                console.error('Email error:', err);
                alert(err.message || 'Error sending email. Please try downloading instead.');
            } finally {
                btn.innerHTML = originalHTML;
                btn.disabled = false;
            }
        }

        // ============================================
        // ACKNOWLEDGMENT TOGGLE (Step 3 - Execute)
        // ============================================
        function toggleExecuteButton() {
            const checkbox = document.getElementById('msa-acknowledge');
            const button = document.getElementById('execute-btn');

            if (checkbox && button) {
                if (checkbox.checked) {
                    button.disabled = false;
                    button.style.opacity = '1';
                    button.style.cursor = 'pointer';
                    button.style.backgroundColor = '#C8A951'; // Force background
                    button.style.color = '#000000';
                    button.style.boxShadow = '0 4px 20px rgba(200, 169, 81, 0.3)';
                } else {
                    button.disabled = true;
                    button.style.opacity = '0.5';
                    button.style.cursor = 'not-allowed';
                    button.style.boxShadow = 'none';
                    // Keep background but dim it via opacity
                    button.style.backgroundColor = '#C8A951';
                }
            }
        }
    </script>



    <!-- Firebase SDK (Modular) -->
    <script type="module">
        import { AuthService } from '/assets/js/firebase-init.js';
        window.AuthService = AuthService;
    </script>

    <script>
        // ============================================
        // MODAL LOGIC (Simple div-based)
        // ============================================
        let guestModalResolve = null;

        function showGuestModal() {
            return new Promise((resolve) => {
                guestModalResolve = resolve;
                const modal = document.getElementById('guest-signer-modal');
                modal.classList.add('active');
                document.getElementById('guest-name').focus();
            });
        }

        function hideGuestModal() {
            const modal = document.getElementById('guest-signer-modal');
            modal.classList.remove('active');
            document.getElementById('guest-name').value = '';
            document.getElementById('guest-email').value = '';
        }

        function confirmGuestModal() {
            const name = document.getElementById('guest-name').value.trim();
            const email = document.getElementById('guest-email').value.trim();

            if (!name || !email) {
                alert('Both Name and Email are required.');
                return;
            }
            if (!email.includes('@')) {
                alert('Please enter a valid email address.');
                return;
            }

            if (guestModalResolve) {
                guestModalResolve({ name, email });
                hideGuestModal();
            }
        }

        function cancelGuestModal() {
            if (guestModalResolve) {
                guestModalResolve(null); // Return null to indicate cancellation
                hideGuestModal();
            }
        }

        // ============================================
        // OPENSIGN INTEGRATION
        // ============================================

        // Project identifier for multi-tenant vault
        const PROJECT_ID = 'sirsi';

        async function initiateOpenSign() {
            const executeBtn = document.getElementById('execute-btn');
            const originalHTML = executeBtn.innerHTML;
            const signatureBlock = document.getElementById('signature-block');

            try {
                // 1. Identify Signer
                const user = window.AuthService ? window.AuthService.getCurrentUser() : null;
                let signerEmail = '';
                let signerName = 'Guest Signer';

                if (user) {
                    signerEmail = user.email;
                    signerName = user.displayName || 'Valued Client';
                } else {
                    const guestData = await showGuestModal();
                    if (!guestData) return;
                    signerEmail = guestData.email;
                    signerName = guestData.name;
                }

                // 2. UI Loading State
                executeBtn.innerHTML = '<span>⏳ Initializing Vault...</span>';
                executeBtn.disabled = true;

                // 3. Create Envelope via Firebase Functions (sirsi-nexus-live API)
                // Same-origin request via Firebase Hosting rewrites
                const API_BASE = '';
                const firebaseUser = window.firebase?.auth?.()?.currentUser || window.firebaseAuth?.currentUser;
                const isGuest = !firebaseUser;

                const endpoint = isGuest ? `${API_BASE}/api/guest/envelopes` : `${API_BASE}/api/envelopes`;
                const headers = { 'Content-Type': 'application/json' };


                if (!isGuest) {
                    const authToken = await firebaseUser.getIdToken();
                    headers['Authorization'] = `Bearer ${authToken}`;
                }

                // Get selected plan from sessionStorage or from global state
                const storedPlan = sessionStorage.getItem('selectedPlan') || selectedPlan || 'Plan C';

                // Build request body with projectId for multi-tenant vault
                const requestBody = {
                    projectId: PROJECT_ID,
                    docType: 'legacy-msa',
                    signerName: signerName,
                    signerEmail: signerEmail,
                    redirectUrl: window.location.origin + '/payment.html?project=' + PROJECT_ID,
                    metadata: {
                        projectId: PROJECT_ID,
                        selectedPlan: storedPlan,
                        msaVersion: 'v1.0',
                        referringDomain: window.location.hostname,
                        signedAt: new Date().toISOString()
                    }
                };

                console.log('Creating envelope:', { endpoint, isGuest, projectId: PROJECT_ID, requestBody });

                const response = await fetch(endpoint, {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify(requestBody)
                });

                const result = await response.json();
                if (!response.ok) throw new Error(result.message || 'Failed to create signing session');


                console.log('OpenSign Session:', result);

                // 4. Update UI Optimistically
                if (signatureBlock) {
                    const signatureEl = document.getElementById('date-signature');
                    if (signatureEl) signatureEl.textContent = new Date().toLocaleDateString();
                }
                updateMSAState('executed');
                updateStepperStatus(3);

                executeBtn.textContent = '✓ Redirecting to Secure Sign...';
                executeBtn.style.backgroundColor = '#10B981';
                executeBtn.classList.remove('bg-[#C8A951]');
                executeBtn.classList.add('bg-[#10B981]');

                // 5. Prepare Post-Signature Redirect  
                // First month payment amounts based on new plan structure
                let amt = '33333.33'; // Default Plan C: $200K / 6 months
                if (storedPlan === 'Plan A') amt = '50000';    // $200K / 4 months = $50K/mo
                if (storedPlan === 'Plan B') amt = '40000';    // $200K / 5 months = $40K/mo

                sessionStorage.setItem('postSignRedirect', `/payment.html?project=${PROJECT_ID}&amount=${amt}&ref=MSA-V1`);
                sessionStorage.setItem('selectedPlan', storedPlan);
                sessionStorage.setItem('projectId', PROJECT_ID);

                // 6. Store envelope info and redirect to Signing Page
                if (result.envelopeId) {
                    sessionStorage.setItem('envelopeId', result.envelopeId);

                    // Use the CRYPTOGRAPHICALLY SIGNED URL from the API response
                    // This URL contains HMAC signature, timestamp, and nonce for MITM protection
                    let signUrl;
                    if (result.signingUrl) {
                        // Prefer the signed URL from the server
                        signUrl = result.signingUrl;
                        console.log('Using server-signed URL (secure):', signUrl.substring(0, 80) + '...');
                    } else {
                        // Fallback to unsigned URL (legacy compatibility)
                        signUrl = `/sign.html?envelope=${result.envelopeId}&project=${PROJECT_ID}&guest=${isGuest}`;
                        console.warn('Using unsigned URL (legacy mode)');
                    }

                    console.log('Redirecting to sign page with security:', signUrl.includes('_sig') ? 'HMAC-signed' : 'unsigned');
                    window.location.href = signUrl;
                } else {
                    throw new Error('No envelope ID returned from server');
                }


            } catch (error) {
                console.error('OpenSign Error:', error);
                alert('Signature Initialization Error: ' + error.message);
                executeBtn.innerHTML = originalHTML;
                executeBtn.disabled = false;
                executeBtn.style.backgroundColor = '#C8A951';
            }
        }

        // ============================================
        // POST-SIGNATURE PAYMENT REDIRECT
        // ============================================
        // Check URL for signature completion callback
        document.addEventListener('DOMContentLoaded', function () {
            const urlParams = new URLSearchParams(window.location.search);

            // OpenSign will redirect back with status parameters
            if (urlParams.get('signature_complete') === 'true' ||
                urlParams.get('event') === 'signing_complete') {

                // Update UI to show completion
                const signatureBlock = document.getElementById('signature-block');
                const executeBtn = document.getElementById('execute-btn');
                const signatureDateEl = document.getElementById('date-signature');

                if (signatureDateEl) {
                    signatureDateEl.textContent = new Date().toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                }

                if (executeBtn) {
                    executeBtn.innerHTML = '✓ Agreement Executed';
                    executeBtn.disabled = true;
                    executeBtn.style.backgroundColor = '#10B981';
                    executeBtn.classList.remove('bg-[#C8A951]');
                    executeBtn.classList.add('bg-[#10B981]');
                }

                updateMSAState('executed');
                updateStepperStatus(3);

                // Show payment redirect modal -> NOW DEDICATED PAGE
                setTimeout(() => {
                    const amount = document.getElementById('cash-total-display')?.textContent.replace(/[^0-9]/g, '') || '175000';
                    window.location.href = `payment.html?amount=${amount}&ref=MSA-V1`;
                }, 1500);
            }
        });
    </script>




    <!-- Vertical Workflow Guide (Fixed Right) -->
    <div id="vertical-workflow-guide"
        class="fixed right-8 top-1/2 -translate-y-1/2 z-[99999] flex flex-col items-center gap-12 no-print transition-all duration-500 opacity-0 pointer-events-none"
        style="display: none;">
        <!-- Vertical Progress Line (Background) -->
        <div class="absolute top-4 bottom-4 w-[2px] bg-white/10 z-0"></div>
        <div id="v-progress-fill"
            class="absolute top-4 w-[2px] bg-gold z-0 transition-all duration-300 shadow-[0_0_10px_rgba(200,169,81,0.5)]"
            style="height: 0%;"></div>

        <!-- Step 1: Select Plan -->
        <div id="v-step-1" class="relative z-10 group flex flex-col items-center">
            <div
                class="w-12 h-12 rounded-full bg-gold border border-gold/50 text-navy flex items-center justify-center font-bold shadow-[0_0_20px_rgba(200,169,81,0.5)] transition-all duration-500 scale-110">
                1</div>
            <span
                class="absolute right-16 top-1/2 -translate-y-1/2 bg-[#0f172a]/95 backdrop-blur-md border border-gold/40 px-5 py-3 rounded-lg font-serif text-[11px] uppercase tracking-[0.25em] text-gold opacity-0 group-hover:opacity-100 transition-all duration-300 whitespace-nowrap pointer-events-none translate-x-4 group-hover:translate-x-0 shadow-2xl">Select
                Plan</span>
        </div>

        <!-- Step 2: Review MSA -->
        <div id="v-step-2"
            class="relative z-10 group flex flex-col items-center opacity-30 grayscale transition-all duration-500">
            <div
                class="w-12 h-12 rounded-full bg-[#0f172a] border border-white/20 text-white flex items-center justify-center font-bold transition-all duration-500">
                2</div>
            <span
                class="absolute right-16 top-1/2 -translate-y-1/2 bg-[#0f172a]/95 backdrop-blur-md border border-white/20 px-5 py-3 rounded-lg font-serif text-[11px] uppercase tracking-[0.25em] text-white/60 opacity-0 group-hover:opacity-100 transition-all duration-300 whitespace-nowrap pointer-events-none translate-x-4 group-hover:translate-x-0 shadow-2xl">Review
                MSA</span>
        </div>

        <!-- Step 3: Sign -->
        <div id="v-step-3"
            class="relative z-10 group flex flex-col items-center opacity-30 grayscale transition-all duration-500">
            <div
                class="w-12 h-12 rounded-full bg-[#0f172a] border border-white/20 text-white flex items-center justify-center font-bold transition-all duration-500">
                3</div>
            <span
                class="absolute right-16 top-1/2 -translate-y-1/2 bg-[#0f172a]/95 backdrop-blur-md border border-white/20 px-5 py-3 rounded-lg font-serif text-[11px] uppercase tracking-[0.25em] text-white/60 opacity-0 group-hover:opacity-100 transition-all duration-300 whitespace-nowrap pointer-events-none translate-x-4 group-hover:translate-x-0 shadow-2xl">Sign</span>
        </div>
    </div>

    <!-- Guest Signer Modal - Simple div-based, no native dialog quirks -->
    <div id="guest-signer-modal" class="modal-overlay">
        <div class="w-full max-w-md bg-[#0f172a] p-8 rounded-2xl border border-gold/30 text-left">
            <!-- Modal Header -->
            <div class="mb-6 text-center">
                <div class="mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-gold/10 text-gold">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </div>
                <h3 class="font-serif text-2xl text-gold">Signer Identity</h3>
                <p class="mt-2 text-sm text-gray-400">Please provide your details to authenticate this digital
                    signature.</p>
            </div>

            <!-- Modal Form -->
            <div class="space-y-4">
                <div>
                    <label class="mb-1 block text-xs font-semibold uppercase tracking-wider text-gray-500">Full
                        Name</label>
                    <input type="text" id="guest-name"
                        class="w-full rounded-lg border border-white/10 bg-white/5 px-4 py-3 text-white placeholder-gray-600 focus:border-gold focus:outline-none focus:ring-1 focus:ring-gold"
                        placeholder="e.g. John Doe">
                </div>
                <div>
                    <label class="mb-1 block text-xs font-semibold uppercase tracking-wider text-gray-500">Email
                        Address</label>
                    <input type="email" id="guest-email"
                        class="w-full rounded-lg border border-white/10 bg-white/5 px-4 py-3 text-white placeholder-gray-600 focus:border-gold focus:outline-none focus:ring-1 focus:ring-gold"
                        placeholder="e.g. john@example.com">
                </div>

                <!-- Modal Actions -->
                <div class="mt-8 flex gap-3">
                    <button type="button" onclick="cancelGuestModal()"
                        class="flex-1 rounded-lg border border-white/10 bg-white/5 py-3 text-sm font-semibold text-gray-400 hover:bg-white/10 transition-colors">Cancel</button>
                    <button type="button" onclick="confirmGuestModal()"
                        class="flex-1 rounded-lg bg-gold py-3 text-sm font-semibold text-black hover:bg-[#D4AF37] transition-colors shadow-lg shadow-gold/20">Continue
                        to Sign</button>
                </div>
            </div>
        </div>
    </div>

</body>

</html>