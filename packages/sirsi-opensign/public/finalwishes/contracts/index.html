<!DOCTYPE html>
<html lang="en" data-auth-protect="admin">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proposal & Agreement | Admin Console</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700;800&family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap"
        rel="stylesheet">

    <!-- Dependencies -->
    <link href="../../assets/css/tailwind.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- HTML to PDF - Simple, client-side PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <!-- Admin Layout Styles -->
    <link rel="stylesheet" href="../../assets/css/admin-layout.css?v=2.0.1">
    <!-- Professional Print Template for PDF Generation -->
    <link rel="stylesheet" href="print-template.css" media="print">
    <style>
        /* ============================================
           OPENSIGN POPUP/IFRAME CENTERING FIX
           Force any dynamically injected elements to center
           EXCLUDES: dialogs, workflow guides, and page wrappers
           ============================================ */
        /* Target OpenSign iframes, popups, and overlays - NOT dialogs */
        iframe[src*="opensign"],
        iframe[src*="sign"],
        div[id*="opensign"],
        div[class*="opensign"],
        div[class*="signing"],
        div[class*="popup"]:not(dialog *) {
            position: fixed !important;
            top: 50% !important;
            left: 50% !important;
            transform: translate(-50%, -50%) !important;
            margin: 0 !important;
            max-width: 95vw !important;
            max-height: 95vh !important;
            z-index: 999999 !important;
        }

        /* Modal styling - simple flexbox centering */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            display: none;
            z-index: 1000000;
        }

        .modal-overlay.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* CRITICAL OVERRIDES FOR CONTRACT HIERARCHY */

        /* Level 1: Main Page Title (H1) - Handled in layout */

        /* Level 2: Section Headers (e.g. "2. Detailed Scope") */
        .contract-immersive-wrapper h2 {
            font-family: 'Inter', sans-serif !important;
            /* FIXED: FORCE INTER */
            color: #C8A951 !important;
            font-size: 2.25rem !important;
            font-weight: 600 !important;
            /* REFINED: SemiBold instead of ExtraBold */
            text-transform: uppercase !important;
            letter-spacing: 0.05em !important;
            /* Tighter spacing */
            margin-top: 4rem !important;
            margin-bottom: 2rem !important;
            border: none !important;
            line-height: 2.5rem !important;
            text-align: center !important;
            /* Center all section headers */
        }

        /* Level 3: Subsections (e.g. "2.1 Core Vault") */
        /* FIX: Making this larger than H4 */
        .contract-immersive-wrapper h3 {
            font-family: 'Inter', sans-serif !important;
            /* FIXED: FORCE INTER */
            color: #93c5fd !important;
            /* Blue-300 */
            font-size: 1.375rem !important;
            /* text-lg */
            font-weight: 700 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.15em !important;
            margin-top: 3rem !important;
            margin-bottom: 1.5rem !important;
            padding-bottom: 0.5rem !important;
        }

        /* Level 4: Item Groups (e.g. "A. Identity") */
        .contract-immersive-wrapper h4 {
            font-family: 'Inter', sans-serif !important;
            color: #C8A951 !important;
            font-size: 1.125rem !important;
            /* text-lg (18px) - Clearly smaller than H3 */
            font-weight: 700 !important;
            margin-top: 1.5rem !important;
            margin-bottom: 0.5rem !important;
            text-transform: uppercase !important;
            letter-spacing: 0.05em !important;
        }

        /* Fix list spacing */
        .contract-immersive-wrapper ul {
            margin-bottom: 2rem !important;
        }

        .contract-immersive-wrapper li {
            margin-bottom: 0.75rem !important;
        }

        /* FORCE WIDER WIDTHS */
        .max-w-4xl {
            max-width: 80rem !important;
            /* max-w-7xl override */
        }

        /* Force grid to behave */
        .grid-cols-12 {
            display: grid !important;
            grid-template-columns: repeat(12, minmax(0, 1fr)) !important;
            gap: 2rem !important;
        }

        /* Fix the 2-column sections */
        .grid-cols-1.md\:grid-cols-2 {
            grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
            gap: 3rem !important;
        }

        /* Fix lists specifically */
        ul.list-disc {
            margin-left: 1.5rem !important;
            margin-bottom: 2rem !important;
        }

        ul.list-disc li {
            padding-left: 0.5rem !important;
            margin-bottom: 0.75rem !important;
        }

        /* Card overrides for space */
        .bg-white\/5 {
            padding: 2rem !important;
        }

        /* Ensure table text is readable */
        td,
        th {
            padding: 1rem !important;
            text-align: left !important;
            font-family: 'Inter', sans-serif !important;
            font-size: 1rem !important;
        }

        /* GLOBAL: Standardize ALL body text sizes in contract wrapper */
        .contract-immersive-wrapper p,
        .contract-immersive-wrapper li,
        .contract-immersive-wrapper td,
        .contract-immersive-wrapper th,
        .contract-immersive-wrapper span:not(.neo-text-gold),
        .text-blue-200,
        .text-blue-100,
        .text-slate-300,
        .text-slate-200,
        .text-slate-400,
        .text-slate-500 {
            font-size: 1.125rem !important;
            line-height: 1.75 !important;
            color: rgba(255, 255, 255, 0.9) !important;
        }

        /* Preserve small labels and badges */
        .text-xs,
        .text-sm {
            font-size: inherit !important;
        }

        /* Ensure table cells match */
        .contract-immersive-wrapper table td,
        .contract-immersive-wrapper table th {
            font-size: 1.125rem !important;
        }



        /* ========================================== */
        /* COST & VALUATION TAB: UNIFIED TYPOGRAPHY  */
        /* ========================================== */

        /*
         * UNIFIED TYPE SCALE (Based on 16px root):
         * - Labels: 12px (text-xs)
         * - Body/Table: 16px (text-base)
         * - Subheads: 18px (text-lg)
         * - Card Values: 24px (text-2xl)
         * - Section Titles: 28px (text-3xl)
         * - Big Values: 36px (text-4xl)
         * - Hero Values: 48px (text-5xl)
         */

        /* TOP STAT CARDS - Uniform Styling */
        #cost .stat-card.contract-stat {
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid rgba(255, 255, 255, 0.15) !important;
            padding: 1.5rem 1rem !important;
            text-align: center !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
            min-height: 120px !important;
        }

        #cost .stat-card.contract-stat>div:first-child {
            /* Label - LARGER for readability */
            font-family: 'Inter', sans-serif !important;
            font-size: 14px !important;
            font-weight: 600 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.08em !important;
            color: #C8A951 !important;
            margin-bottom: 0.5rem !important;
        }

        #cost .stat-card.contract-stat>div:nth-child(2) {
            /* Main Value - proportional */
            font-family: 'Cinzel', serif !important;
            font-size: 24px !important;
            font-weight: 500 !important;
            color: white !important;
            line-height: 1.2 !important;
        }

        #cost .stat-card.contract-stat>div:last-child:not(:nth-child(2)) {
            /* Sublabel */
            font-family: 'Inter', sans-serif !important;
            font-size: 12px !important;
            text-transform: uppercase !important;
            letter-spacing: 0.05em !important;
            color: #94a3b8 !important;
            margin-top: 0.25rem !important;
        }

        /* SECTION HEADERS - Consistent Gold titles */
        #cost h2 {
            font-family: 'Cinzel', serif !important;
            font-size: 24px !important;
            font-weight: 500 !important;
            color: #C8A951 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.1em !important;
        }

        /* ALL TABLES - Unified Font Size */
        #cost table {
            font-size: 16px !important;
        }

        #cost table th {
            font-family: 'Cinzel', serif !important;
            font-size: 14px !important;
            font-weight: 600 !important;
            color: #C8A951 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.05em !important;
            padding: 1rem !important;
        }

        #cost table td {
            font-family: 'Inter', sans-serif !important;
            font-size: 16px !important;
            color: #e2e8f0 !important;
            padding: 1rem !important;
        }

        #cost table td.font-bold,
        #cost table td strong {
            color: white !important;
        }

        /* DISCOUNT REALIZATION BOX - Balanced Professional Layout */
        #cost .discount-box-container {
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid rgba(200, 169, 81, 0.5) !important;
            padding: 2rem !important;
            max-width: 600px !important;
            margin: 0 auto !important;
        }

        #cost .discount-box-container .discount-label {
            font-family: 'Inter', sans-serif !important;
            font-size: 16px !important;
            font-weight: 500 !important;
            color: #e2e8f0 !important;
            text-align: left !important;
        }

        #cost .discount-box-container .discount-value {
            font-family: 'Cinzel', serif !important;
            font-size: 20px !important;
            font-weight: 500 !important;
            color: #C8A951 !important;
            text-align: right !important;
        }

        #cost .discount-box-container .discount-value.strikethrough {
            color: #64748b !important;
            text-decoration: line-through !important;
            text-decoration-color: #ef4444 !important;
        }

        #cost .discount-box-container .discount-final-label {
            font-family: 'Inter', sans-serif !important;
            font-size: 18px !important;
            font-weight: 600 !important;
            color: #e2e8f0 !important;
        }

        #cost .discount-box-container .discount-final-value {
            font-family: 'Cinzel', serif !important;
            font-size: 32px !important;
            font-weight: 600 !important;
            color: #C8A951 !important;
        }

        /* PARTNERSHIP PLAN CARDS */
        #cost .plan-grid-container {
            display: grid !important;
            grid-template-columns: repeat(3, 1fr) !important;
            gap: 2rem !important;
            align-items: stretch !important;
        }

        #cost .plan-grid-container .plan-card-item {
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            padding: 2rem !important;
            text-align: center !important;
            display: flex !important;
            flex-direction: column !important;
            transition: all 0.3s ease !important;
        }

        #cost .plan-grid-container .plan-card-item:hover {
            border-color: #C8A951 !important;
            transform: translateY(-4px) !important;
        }

        #cost .plan-grid-container .plan-card-item.recommended {
            background: linear-gradient(135deg, rgba(200, 169, 81, 0.15) 0%, rgba(0, 0, 0, 0.5) 100%) !important;
            border: 2px solid #C8A951 !important;
            transform: scale(1.03) !important;
            box-shadow: 0 0 60px rgba(200, 169, 81, 0.2) !important;
        }

        #cost .plan-grid-container .plan-card-item .plan-header {
            font-family: 'Cinzel', serif !important;
            font-size: 36px !important;
            font-weight: 600 !important;
            color: white !important;
            margin-bottom: 0.5rem !important;
        }

        #cost .plan-grid-container .plan-card-item .plan-subtitle {
            font-family: 'Inter', sans-serif !important;
            font-size: 11px !important;
            text-transform: uppercase !important;
            letter-spacing: 0.15em !important;
            color: #C8A951 !important;
            margin-bottom: 1.5rem !important;
        }

        #cost .plan-grid-container .plan-card-item .plan-amount-label {
            font-family: 'Inter', sans-serif !important;
            font-size: 14px !important;
            text-transform: uppercase !important;
            letter-spacing: 0.1em !important;
            color: #C8A951 !important;
        }

        #cost .plan-grid-container .plan-card-item .plan-amount-value {
            font-family: 'Cinzel', serif !important;
            font-size: 22px !important;
            color: white !important;
        }

        #cost .plan-grid-container .plan-card-item .plan-total-value {
            font-family: 'Cinzel', serif !important;
            font-size: 28px !important;
            font-weight: 600 !important;
            color: white !important;
        }

        /* ATOMIC BREAKDOWN PHASE CARDS - Larger fonts, white text */
        #cost .space-y-6>div h3 {
            font-size: 22px !important;
            font-weight: 600 !important;
            color: white !important;
        }

        #cost .space-y-6>div .text-right>div:first-child {
            font-size: 22px !important;
            font-family: 'Cinzel', serif !important;
            color: white !important;
        }

        #cost .space-y-6>div .text-xs {
            font-size: 16px !important;
            color: white !important;
        }

        #cost .space-y-6>div table {
            font-size: 18px !important;
        }

        #cost .space-y-6>div table th,
        #cost .space-y-6>div table td {
            font-size: 18px !important;
            padding: 0.75rem !important;
            color: white !important;
        }

        /* GLOBAL COST TAB: No grey/blue text, minimum 18px */
        #cost .text-slate-300,
        #cost .text-slate-400,
        #cost .text-slate-500,
        #cost .text-blue-100,
        #cost .text-blue-200 {
            color: white !important;
        }

        #cost .text-xs {
            font-size: 16px !important;
        }

        #cost .text-sm {
            font-size: 18px !important;
        }

        #cost .text-base {
            font-size: 20px !important;
        }

        #cost .text-lg {
            font-size: 22px !important;
        }

        #cost .text-xl {
            font-size: 24px !important;
        }

        /* ============================================
           ROYAL NEO-DECO COMPONENTS (SOW REFINEMENT)
           ============================================ */

        .neo-glass-panel {
            background: rgba(255, 255, 255, 0.05) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(12px);
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.5);
        }

        .neo-glass-panel p {
            margin: 0 !important;
            /* Clear default paragraph vertical margins */
            line-height: 1.5;
        }

        .neo-card-gold {
            background: linear-gradient(145deg, rgba(20, 30, 60, 0.9), rgba(10, 15, 30, 0.9)) !important;
            border: 2px solid rgba(200, 169, 81, 0.6) !important;
            border-radius: 12px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            flex: 1;
            min-height: 100%;
            padding: 2.5rem;
            position: relative;
            cursor: pointer;
        }

        .neo-card-gold:hover {
            border-color: #C8A951 !important;
            box-shadow: 0 0 20px rgba(200, 169, 81, 0.15);
            transform: translateY(-2px);
        }

        .neo-card-blue {
            background: rgba(13, 18, 30, 0.8) !important;
            border: 1px solid rgba(255, 255, 255, 0.15) !important;
            border-radius: 12px;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            flex: 1;
            min-height: 100%;
            padding: 2rem;
            position: relative;
            cursor: pointer;
        }

        .neo-card-blue:hover {
            border-color: rgba(147, 197, 253, 0.5) !important;
            transform: translateY(-2px);
        }

        /* Fix the content inside cards to push footer down */
        .neo-card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* Ensure the detailed scope headers don't look generic */
        .scope-section-header {
            color: #C8A951 !important;
            font-family: 'Cinzel', serif !important;
            font-size: 1.5rem !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            margin-top: 1rem;
        }
    </style>
    <link rel="stylesheet" href="../../assets/css/finalwishes.css">
    <link rel="stylesheet" href="../../assets/css/theme.css">

    <!-- Contract Specific Styles -->
    <style>
        /* Override Admin Layout for Inner Content to maintain Premium Dark Theme */
        .contract-immersive-wrapper {
            /* ROYAL NEO-DECO THEME */
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 2rem;
            --glass-border: rgba(255, 255, 255, 0.1);
            --color-gold: #C8A951;
            --color-gold-dark: #A08332;
            --color-blue-navy: #0f172a;
            --color-white: #ffffff;
            --radius: 4px;

            /* NEO HERO CARD */
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border-color: rgba(200, 169, 81, 0.5);

            /* FIXED: Symmetrical 'Wide Channel' Gradient */
            /* Widened center band with soft 20% transition ramps */
            background: linear-gradient(90deg,
                    #0f172a 0%,
                    #0f172a 10%,
                    #121b2e 25%,
                    #1e3a8a 40%,
                    #1e3a8a 60%,
                    #121b2e 75%,
                    #0f172a 90%,
                    #0f172a 100%);
            background-color: #0f172a;
            background-attachment: fixed;
            /* Fixed background - consistent across entire page */
            color: rgba(255, 255, 255, 0.9);
            font-family: 'Inter', sans-serif;
            flex: 1;
            min-height: 100vh;
            font-size: 18px;
            line-height: 1.6;
            padding: 2rem;
        }

        /* Override admin layout background for this page - WIDE CENTER CHANNEL */
        .main-content {
            background: linear-gradient(90deg,
                    #0f172a 0%,
                    #0f172a 10%,
                    #121b2e 25%,
                    #1e3a8a 40%,
                    #1e3a8a 60%,
                    #121b2e 75%,
                    #0f172a 90%,
                    #0f172a 100%) !important;
            background-attachment: fixed !important;
        }

        /* NEW: Internal Scroll Viewer Box */
        .legal-scroll-box {
            height: 60vh;
            /* Fixed height for the document viewer */
            min-height: 400px;
            overflow-y: auto;
            overflow-x: hidden;
            background: rgba(15, 23, 42, 0.4);
            border: 1px solid rgba(200, 169, 81, 0.3);
            border-radius: 12px;
            padding: 4rem;
            position: relative;
            box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.6);
            margin-bottom: 3rem;
            scrollbar-width: thin;
            scrollbar-color: #C8A951 rgba(15, 23, 42, 0.5);
        }

        /* Custom Scrollbar for Chrome/Safari */
        .legal-scroll-box::-webkit-scrollbar {
            width: 8px;
        }

        .legal-scroll-box::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 10px;
        }

        .legal-scroll-box::-webkit-scrollbar-thumb {
            background: #C8A951;
            border-radius: 10px;
            border: 2px solid rgba(15, 23, 42, 0.5);
        }

        /* Ensure tab contents handle the new layout */
        .tab-content {
            /* Removed height: 100% - it conflicts with block display and clips content */
            display: flex;
            flex-direction: column;
        }

        /* Allow main content to scroll */
        .main-content {
            overflow-y: auto !important;
        }

        /* MISSING CLASS DEFINITION */
        .neo-stat-card-hero {
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid rgba(200, 169, 81, 0.5) !important;
            border-radius: 8px !important;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1) !important;
            backdrop-filter: blur(5px) !important;
            transition: all 0.3s ease !important;
        }

        .neo-stat-card-hero:hover {
            border-color: #C8A951 !important;
            box-shadow: 0 0 20px rgba(200, 169, 81, 0.2) !important;
        }

        /* TYPOGRAPHY OVERRIDES WITHIN WRAPPER */
        .contract-immersive-wrapper h1,
        .contract-immersive-wrapper h2,
        .contract-immersive-wrapper h3,
        .contract-immersive-wrapper h4,
        .contract-immersive-wrapper .serif {
            font-family: 'Cinzel', serif !important;
            color: white !important;
        }

        /* INTERACTIVE PLAN CARDS */
        .plan-card-interactive {
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .plan-card-interactive:hover {
            border-color: #C8A951;
            box-shadow: 0 0 25px rgba(200, 169, 81, 0.15);
            transform: translateY(-2px);
        }

        .selected-plan-card {
            border: 2px solid #C8A951 !important;
            background: linear-gradient(135deg, rgba(200, 169, 81, 0.15) 0%, rgba(0, 0, 0, 0.6) 100%) !important;
            transform: scale(1.02) !important;
            box-shadow: 0 0 40px rgba(200, 169, 81, 0.25) !important;
            z-index: 10;
        }

        .selected-plan-card::after {
            content: "✓";
            position: absolute;
            top: -12px;
            right: -12px;
            background: #10B981;
            color: #0f172a;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 16px;
            border: 2px solid #0f172a;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn {
            0% {
                transform: scale(0);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* INTERACTIVE ANIMATIONS */
        .plan-card-static.plan-card-anim {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            z-index: 1;
            border-radius: 2.5rem !important;
            -webkit-border-radius: 2.5rem !important;
            -moz-border-radius: 2.5rem !important;
        }

        .plan-card-anim:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px -5px rgba(0, 0, 0, 0.5);
            border-color: rgba(200, 169, 81, 0.4);
            z-index: 5;
        }

        .plan-card-anim.selected-anim {
            transform: scale(1.02);
            border-color: #C8A951 !important;
            background: linear-gradient(135deg, rgba(200, 169, 81, 0.1) 0%, rgba(0, 0, 0, 0.8) 100%) !important;
            box-shadow: 0 0 40px rgba(200, 169, 81, 0.2);
            z-index: 10;
        }

        /* PLAN CARD BUTTONS */
        .select-plan-btn {
            border-radius: 9999px !important;
            background: linear-gradient(to right, #C8A951, #E2C76B) !important;
            color: #000 !important;
            font-weight: 700 !important;
            box-shadow: 0 10px 15px -3px rgba(200, 169, 81, 0.2);
        }

        .select-plan-btn:hover {
            box-shadow: 0 10px 25px -3px rgba(200, 169, 81, 0.4);
            transform: scale(1.02);
        }

        /* All plan buttons should be gold */
        #card-plan-c .select-plan-btn {
            background: linear-gradient(to right, #C8A951, #E2C76B) !important;
            box-shadow: 0 10px 15px -3px rgba(200, 169, 81, 0.2);
        }

        #card-plan-c .select-plan-btn:hover {
            box-shadow: 0 10px 25px -3px rgba(200, 169, 81, 0.4);
        }

        /* DOWNLOAD BUTTONS */
        .download-btn-neo {
            position: absolute;
            top: 2rem;
            right: 2rem;
            border: 1px solid rgba(200, 169, 81, 0.4);
            color: #C8A951;
            padding: 0.6rem 1.2rem;
            font-family: 'Cinzel', serif;
            font-size: 0.75rem;
            letter-spacing: 0.1em;
            background: rgba(15, 23, 42, 0.6);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            transition: all 0.3s ease;
            z-index: 50;
            backdrop-filter: blur(8px);
            border-radius: 2px;
            text-transform: uppercase;
            font-weight: 600;
        }

        .download-btn-neo:hover {
            background: rgba(200, 169, 81, 0.15);
            border-color: #C8A951;
            box-shadow: 0 0 20px rgba(200, 169, 81, 0.25);
            color: #fbbf24;
            transform: translateY(-1px);
        }

        .download-btn-neo svg {
            width: 16px;
            height: 16px;
            opacity: 0.8;
        }

        .download-btn-neo:hover svg {
            opacity: 1;
        }

        /* TABLE OVERRIDES FOR DARK MODE */
        .contract-immersive-wrapper table {
            border-collapse: collapse;
        }

        .contract-immersive-wrapper th {
            background: rgba(255, 255, 255, 0.05) !important;
            color: #C8A951 !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
        }

        .contract-immersive-wrapper td {
            color: rgba(255, 255, 255, 0.9) !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05) !important;
        }

        .contract-immersive-wrapper tr:hover td {
            background: rgba(255, 255, 255, 0.05) !important;
            color: #fff !important;
        }

        .contract-immersive-wrapper .gold-text {
            color: #C8A951 !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .contract-immersive-wrapper h1 {
            font-size: 3.5rem;
            letter-spacing: -0.02em;
        }

        .contract-immersive-wrapper h2 {
            font-size: 2.25rem;
            margin-bottom: 1.5rem;
            color: #C8A951 !important;
        }

        .contract-immersive-wrapper h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: white;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 0.5rem;
        }

        .contract-immersive-wrapper p {
            margin-bottom: 1.5rem;
            color: rgba(255, 255, 255, 0.85);
            font-size: 1.125rem;
        }

        /* CARD STYLES */
        .main-card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(200, 169, 81, 0.3);
            box-shadow: 0 25px 60px -12px rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(16px);
            border-radius: 4px;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }

        /* TABS */
        .nav-tabs {
            display: flex;
            justify-content: center;
            border-bottom: 2px solid rgba(255, 255, 255, 0.05);
            background: rgba(0, 0, 0, 0.2);
        }

        .tab-btn {
            padding: 1.75rem 3rem;
            font-family: 'Cinzel', serif;
            font-weight: 700;
            color: #cbd5e1;
            border-bottom: 4px solid transparent;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 1.125rem;
            cursor: pointer;
            background: transparent;
            border-top: none;
            border-left: none;
            border-right: none;
        }

        .tab-btn:hover {
            color: #C8A951;
            background: rgba(255, 255, 255, 0.03);
        }

        .tab-btn.active {
            color: #C8A951;
            border-bottom-color: #C8A951;
            background: linear-gradient(180deg, rgba(200, 169, 81, 0.1) 0%, rgba(0, 0, 0, 0) 100%);
        }

        /* CONTENT SECTIONS */
        .tab-content {
            display: none;
            padding: 1rem 5rem 5rem !important;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(15px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* DYNAMIC SELECTION STYLES */
        .plan-card-interactive {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 2rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .plan-card-interactive:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(200, 169, 81, 0.4);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.5);
        }

        .selected-plan-card {
            background: rgba(200, 169, 81, 0.05) !important;
            border-color: #C8A951 !important;
            box-shadow: 0 0 40px -10px rgba(200, 169, 81, 0.3) !important;
            transform: scale(1.02);
            z-index: 5;
        }

        .selected-plan-card::after {
            content: 'SELECTED';
            position: absolute;
            bottom: 0;
            right: 0;
            background: #C8A951;
            color: #0f172a;
            font-size: 10px;
            font-weight: 900;
            padding: 4px 12px;
            letter-spacing: 0.1em;
            clip-path: polygon(15% 0, 100% 0, 100% 100%, 0 100%);
        }

        /* SUB-COMPONENTS */
        .stat-card.contract-stat {
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            padding: 2rem;
            text-align: center;
            box-shadow: none !important;
        }

        .plan-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 4px;
        }

        .plan-card.active {
            border: 2px solid #C8A951;
            background: linear-gradient(135deg, rgba(200, 169, 81, 0.15) 0%, rgba(0, 0, 0, 0) 100%);
        }

        /* LEGAL TEXT VIEWER */
        .legal-viewer {
            background: rgba(15, 23, 42, 0.4);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(200, 169, 81, 0.2);
            color: rgba(255, 255, 255, 0.9);
            padding: 4rem;
            font-family: 'Inter', sans-serif;
            line-height: 1.8;
            border-radius: 4px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            margin-bottom: 2rem;
        }

        /* Ensure text in legal viewer is readable (Light mode paper) */
        .legal-viewer h2 {
            color: #C8A951 !important;
            border-bottom: 1px solid rgba(200, 169, 81, 0.3);
            padding-bottom: 1rem;
            font-size: 2.25rem;
            margin-top: 4rem;
            font-family: 'Cinzel', serif !important;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            text-align: center;
        }

        .legal-viewer h3 {
            color: #C8A951 !important;
            font-family: 'Cinzel', serif !important;
            font-size: 1.5rem;
            border-bottom: none;
            margin-top: 3rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .legal-viewer p,
        .legal-viewer li {
            color: rgba(255, 255, 255, 0.8) !important;
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
        }

        .legal-viewer ul {
            list-style-type: none;
            padding-left: 0;
            margin-bottom: 2rem;
        }

        .legal-viewer ul li {
            position: relative;
            padding-left: 2rem;
        }

        .legal-viewer ul li::before {
            content: '•';
            color: #C8A951;
            position: absolute;
            left: 0.5rem;
            font-weight: bold;
        }

        .legal-viewer table {
            color: white !important;
            border-collapse: collapse;
            width: 100%;
            margin: 2rem 0;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .legal-viewer th {
            color: #C8A951 !important;
            background: rgba(0, 0, 0, 0.3);
            font-family: 'Cinzel', serif !important;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding: 1.25rem !important;
        }

        .legal-viewer td {
            color: rgba(255, 255, 255, 0.8) !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            padding: 1rem !important;
        }

        /* CHECK LISTS */
        ul.check-list li {
            position: relative;
            padding-left: 2rem;
            margin-bottom: 1rem;
            font-size: 1.125rem;
        }

        ul.check-list li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: #C8A951;
            font-weight: bold;
        }

        /* GLOBAL TYPOGRAPHY OVERRIDE - NO MORE SERIFS */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        .font-serif {
            font-family: 'Inter', sans-serif !important;
        }

        /* REWRITTEN TABLE STYLES - SINGLE FONT SOURCE OF TRUTH */
        #market-analysis-table {
            width: 100%;
            border-collapse: collapse;
            font-family: 'Inter', sans-serif !important;
            /* FORCE INTER */
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            overflow: hidden;
            border-spacing: 0;
        }

        #market-analysis-table thead tr {
            background-color: rgba(0, 0, 0, 0.4);
            /* Darker header */
            border-bottom: 2px solid rgba(200, 169, 81, 0.4);
            /* Stronger separator */
        }

        #market-analysis-table th {
            font-family: 'Inter', sans-serif !important;
            font-weight: 800;
            /* Extra Bold Headers */
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 2rem 1.5rem;
            /* More vertical padding */
            text-align: center;
            font-size: 1.25rem !important;
            /* 20px - Larger Headers */
            line-height: 1.2;
        }

        #market-analysis-table th:nth-child(1) {
            text-align: left;
            color: #C8A951;
            width: 25%;
            font-size: 1.1rem !important;
            /* Slightly smaller for 'METRIC' label */
            opacity: 0.8;
        }

        #market-analysis-table th:nth-child(2) {
            color: white;
            width: 28%;
            /* Give hero column more space */
            background: rgba(255, 255, 255, 0.05);
            /* Highlight Hero Header */
        }

        #market-analysis-table th:nth-child(3),
        #market-analysis-table th:nth-child(4) {
            color: #94a3b8;
            width: 23.5%;
            font-weight: 600;
            font-size: 1.1rem !important;
            /* De-emphasize competitors */
        }

        #market-analysis-table tbody tr {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: background-color 0.2s;
        }

        #market-analysis-table tbody tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        #market-analysis-table td {
            font-family: 'Inter', sans-serif !important;
            padding: 1.75rem 1.5rem;
            /* Larger cells */
            text-align: center;
            font-size: 1.125rem !important;
            /* 18px Body Text */
            color: rgba(255, 255, 255, 0.9);
            vertical-align: middle;
        }

        #market-analysis-table td:nth-child(1) {
            text-align: left;
            font-weight: 700;
            color: white;
            font-size: 1.25rem !important;
            /* Metric Name Large */
        }

        #market-analysis-table td:nth-child(2) {
            color: white;
            font-weight: 600;
            background-color: rgba(200, 169, 81, 0.08);
            /* Stronger Highlight */
            border-left: 1px solid rgba(200, 169, 81, 0.15);
            border-right: 1px solid rgba(200, 169, 81, 0.15);
            font-size: 1.25rem !important;
            /* Hero Values Large */
        }

        #market-analysis-table td:nth-child(3),
        #market-analysis-table td:nth-child(4) {
            color: #cbd5e1;
            font-weight: 400;
        }

        /* Special Values Helper Class */
        .u-cinzel-accent {
            font-family: 'Cinzel', serif !important;
        }

        .u-text-gold {
            color: #C8A951 !important;
        }

        .u-text-emerald {
            color: #10b981 !important;
        }

        /* Allocation Text */
        #allocation-text {
            text-align: center !important;
            font-family: 'Inter', sans-serif !important;
            font-style: italic;
            font-size: 22px !important;
            /* Larger */
            color: white;
            line-height: 1.5;
        }

        /* ============================================
           PRINT / PDF STYLES
           These override all glassmorphism for clean print output
           ============================================ */
        @media print {

            /* Professional 1-inch margins with header/footer */
            @page {
                size: letter;
                margin: 1in 1in 1in 1in;

                /* Page header */
                @top-center {
                    content: "Master Services Agreement — FinalWishes Platform";
                    font-family: 'Inter', sans-serif;
                    font-size: 9pt;
                    color: #666;
                }

                /* Page footer with page numbers */
                @bottom-center {
                    content: "Page " counter(page) " of " counter(pages);
                    font-family: 'Inter', sans-serif;
                    font-size: 9pt;
                    color: #666;
                }

                /* Confidential notice */
                @bottom-left {
                    content: "CONFIDENTIAL";
                    font-family: 'Inter', sans-serif;
                    font-size: 8pt;
                    color: #999;
                }
            }

            /* First page without page break before title */
            @page :first {
                margin-top: 1in;
            }

            /* Hide non-essential UI */
            #sidebar-root,
            #universal-header-root,
            .tab-container,
            #msa-fab,
            #msa-action-bar,
            #msa-acknowledgment-block,
            #selection-phase,
            #signature-block,
            #step-1-label,
            #step-2-label,
            #step-3-label,
            .no-print,
            button,
            nav,
            header,
            footer,
            .sidebar,
            .nav-tabs,
            .download-btn-neo,
            .floating-action-bar,
            .admin-sidebar,
            .main-header,
            #msa-fab,
            #vertical-workflow-guide {
                display: none !important;
            }

            /* Hide ALL tab contents by default during print */
            .tab-content {
                display: none !important;
                visibility: hidden !important;
            }

            /* ONLY show the active tab content */
            .tab-content.active {
                display: block !important;
                visibility: visible !important;
                background: white !important;
                color: black !important;
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
            }

            /* Reset body and backgrounds */
            body,
            html {
                background: white !important;
                color: #1e293b !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .admin-wrapper,
            .main-content,
            .contract-immersive-wrapper,
            .contract-tabs-wrapper,
            .tab-content {
                background: white !important;
                padding: 0 !important;
                margin: 0 !important;
                width: 100% !important;
                max-width: 100% !important;
            }

            /* Make the contract tab always visible */
            .tab-content#contract {
                display: block !important;
                opacity: 1 !important;
            }

            /* Strip glassmorphism from legal-viewer */
            .legal-viewer,
            #contract-document {
                background: white !important;
                backdrop-filter: none !important;
                -webkit-backdrop-filter: none !important;
                border: none !important;
                box-shadow: none !important;
                padding: 0 !important;
                margin: 0 !important;
                color: #1e293b !important;
            }

            /* Typography for print */
            .legal-viewer h2,
            .legal-viewer h3,
            .legal-viewer h4 {
                color: #0f172a !important;
                border-bottom-color: #0f172a !important;
                page-break-after: avoid;
            }

            .legal-viewer p,
            .legal-viewer li,
            .legal-viewer td {
                color: #1e293b !important;
                font-size: 11pt !important;
                line-height: 1.6 !important;
            }

            .legal-viewer ul li::before {
                color: #0f172a !important;
            }

            /* Tables for print */
            .legal-viewer table {
                background: white !important;
                border: 1px solid #cbd5e1 !important;
            }

            .legal-viewer th {
                background: #f1f5f9 !important;
                color: #0f172a !important;
                border-bottom: 2px solid #0f172a !important;
            }

            .legal-viewer td {
                border-bottom: 1px solid #e2e8f0 !important;
            }

            /* Gold accents become dark gold/brown for print */
            [style*="C8A951"] {
                color: #92710d !important;
            }

            /* Page breaks - H2 sections start on new pages */
            .legal-viewer h2,
            #contract-document h2 {
                page-break-before: always;
            }

            /* First H2 should not have page break */
            .legal-viewer h2:first-of-type,
            #contract-document h2:first-of-type {
                page-break-before: auto;
            }

            /* Prevent headers from being orphaned at bottom of page */
            h2,
            h3,
            h4 {
                page-break-after: avoid;
            }

            p,
            li {
                orphans: 3;
                widows: 3;
            }

            /* Expand legal-scroll-box to show ALL content (not scroll) */
            .legal-scroll-box {
                height: auto !important;
                max-height: none !important;
                overflow: visible !important;
            }

            section {
                page-break-inside: avoid;
            }

            /* Exhibit blocks for print */
            #exhibit-b-dynamic {
                background: #f8fafc !important;
                border: 1px solid #cbd5e1 !important;
                color: #1e293b !important;
            }

            body {
                background: white !important;
            }

            .main-card {
                background: white !important;
                border: none !important;
                box-shadow: none !important;
                padding: 0 !important;
            }
        }

        /* ============================================
           CONTRACT HEADING CLASSES (Desktop)
           Class-based styling for responsive override
           ============================================ */
        .contract-main-heading {
            color: #C8A951;
            margin-bottom: 24px;
            font-size: 34px;
            line-height: 1.2;
            font-family: 'Inter', sans-serif;
            font-weight: 800;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            max-width: 100%;
            white-space: nowrap;
            text-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
        }

        .contract-gold-divider {
            height: 1px;
            width: 128px;
            background: #C8A951;
            margin: 24px auto;
            opacity: 0.5;
        }

        .contract-subtitle {
            font-size: 16px;
            color: white;
            text-transform: uppercase;
            letter-spacing: 0.25em;
            font-weight: 600;
            text-align: center;
            font-family: 'Inter', sans-serif;
        }

        .sow-heading {
            font-size: 3.75rem;
            margin-bottom: 1.5rem;
            line-height: 1;
        }

        /* ============================================
           MOBILE RESPONSIVE STYLES
           First-class mobile experience - v3.0 SWIFTUI
           ============================================ */

        /* TABLET BREAKPOINT (1024px and below) */
        @media (max-width: 1024px) {

            /* Tab content - bound padding */
            .tab-content {
                padding: 1.5rem 1.5rem 3rem !important;
            }

            /* Plan grid - 2 columns on tablet */
            #cost .plan-grid-container,
            #selection-phase>div>div:last-child {
                grid-template-columns: repeat(2, 1fr) !important;
            }

            /* Legal viewer - tighter padding */
            .legal-viewer {
                padding: 1.5rem !important;
            }

            /* Main heading - scale down */
            .contract-immersive-wrapper h1 {
                font-size: 2rem !important;
                line-height: 1.2 !important;
                padding: 0 1rem !important;
            }

            /* Phase accordion headers */
            .contract-immersive-wrapper h2,
            .tab-content h2 {
                font-size: 1.5rem !important;
            }

            /* Hero objective card */
            .neo-stat-card-hero {
                padding: 1.5rem !important;
                margin: 1.5rem auto !important;
            }
        }

        /* MOBILE BREAKPOINT (768px and below) */
        @media (max-width: 768px) {

            /* ===== CONTAINER & LAYOUT ===== */
            .main-content {
                margin-left: 0 !important;
                padding: 0 !important;
            }

            /* Wrapper padding control */
            .contract-immersive-wrapper {
                padding-left: 0 !important;
                padding-right: 0 !important;
            }

            /* ===== TAB NAVIGATION - HORIZONTAL SCROLL ===== */
            .nav-tabs,
            .tab-container {
                flex-direction: row !important;
                flex-wrap: nowrap !important;
                gap: 0 !important;
                width: 100% !important;
                overflow-x: auto !important;
                -webkit-overflow-scrolling: touch !important;
            }

            .tab-btn {
                flex: 1 1 0 !important;
                min-width: max-content !important;
                padding: 0.75rem 0.5rem !important;
                font-size: 0.65rem !important;
                border-bottom: 2px solid transparent !important;
                text-align: center !important;
                white-space: nowrap !important;
            }

            .tab-btn:last-child {
                border-bottom: 2px solid transparent !important;
            }

            .tab-btn.active {
                border-bottom-color: #C8A951 !important;
                background: rgba(200, 169, 81, 0.1) !important;
            }

            /* ===== TAB CONTENT - COMPACT PADDING ===== */
            .tab-content {
                padding: 0.75rem 0.625rem !important;
            }

            /* ============================================
               UNIFIED TYPOGRAPHY SCALE - Mobile (375px)
               Base: 11px (0.6875rem)
               Scale: 9px → 10px → 11px → 12px → 13px → 14px
               ============================================ */

            /* ===== LEVEL 1: Main Contract Heading (14px) ===== */
            .contract-main-heading {
                font-size: 0.875rem !important;
                line-height: 1.2 !important;
                margin-bottom: 0.25rem !important;
                letter-spacing: 0.01em !important;
            }

            .contract-gold-divider {
                width: 40px !important;
                margin: 0.375rem auto !important;
                height: 1px !important;
            }

            .contract-subtitle {
                font-size: 0.5rem !important;
                letter-spacing: 0.06em !important;
            }

            /* ===== LEVEL 2: Section Headings (13px) ===== */
            .sow-heading,
            .tab-content h2.text-6xl,
            [style*="font-size: 3.75rem"],
            h2[style*="font-size: 3.75rem"] {
                font-size: 0.8125rem !important;
                line-height: 1.2 !important;
                margin-bottom: 0.375rem !important;
            }

            /* Section titles like "1. Executive Overview" */
            .tab-content h2,
            .contract-immersive-wrapper h2,
            #cost h2 {
                font-size: 0.75rem !important;
                padding: 0 !important;
                margin-top: 0.625rem !important;
                margin-bottom: 0.375rem !important;
                line-height: 1.25 !important;
            }

            /* ===== LEVEL 3: Subsection headings (12px) ===== */
            .tab-content h3,
            .contract-immersive-wrapper h3,
            #cost h3 {
                font-size: 0.6875rem !important;
                margin-top: 0.5rem !important;
                margin-bottom: 0.25rem !important;
                line-height: 1.3 !important;
            }

            /* ===== LEVEL 4: Category headings (11px) ===== */
            .tab-content h4,
            #cost h4 {
                font-size: 0.625rem !important;
                margin-top: 0.375rem !important;
                margin-bottom: 0.25rem !important;
            }

            /* ===== BODY TEXT: Base (11px) ===== */
            .tab-content p,
            .tab-content li,
            .contract-immersive-wrapper p,
            #cost p,
            #cost li {
                font-size: 0.6875rem !important;
                line-height: 1.45 !important;
                margin-bottom: 0.25rem !important;
            }

            /* ===== LABELS & METADATA (9-10px) ===== */
            .tab-content .flex.flex-wrap.justify-center {
                flex-direction: row !important;
                flex-wrap: wrap !important;
                gap: 0.125rem 0.375rem !important;
                align-items: center !important;
                justify-content: center !important;
                padding: 0.25rem !important;
            }

            .tab-content .flex.flex-wrap.justify-center>div,
            .tab-content .flex.flex-wrap.justify-center span,
            .tab-content .flex.flex-wrap.justify-center strong {
                font-size: 0.5625rem !important;
            }

            /* ===== HERO CARD (Primary Objective) ===== */
            .neo-stat-card-hero,
            [style*="max-width: 55rem"] {
                padding: 0.5rem !important;
                margin: 0.375rem 0 !important;
                max-width: 100% !important;
            }

            .neo-stat-card-hero p,
            .neo-stat-card-hero div,
            .neo-stat-card-hero span {
                font-size: 0.625rem !important;
                line-height: 1.4 !important;
            }

            .neo-stat-card-hero [style*="letter-spacing"],
            .neo-stat-card-hero .uppercase {
                font-size: 0.5rem !important;
                letter-spacing: 0.1em !important;
            }

            /* ===== GRID LAYOUTS - SINGLE COLUMN ===== */
            /* 2-column grids to single */
            .grid-cols-2,
            .md\:grid-cols-2,
            [class*="grid-cols-2"],
            .grid.grid-cols-1.md\:grid-cols-2 {
                display: flex !important;
                flex-direction: column !important;
                gap: 0.5rem !important;
            }

            /* Plan grids */
            #cost .plan-grid-container,
            #selection-phase>div>div:last-child,
            .grid-cols-3,
            [style*="grid-template-columns: repeat(3"] {
                display: flex !important;
                flex-direction: column !important;
                gap: 0.5rem !important;
            }

            /* Plan cards - full width */
            .plan-card-static,
            .plan-card-interactive,
            #card-plan-a,
            #card-plan-b,
            #card-plan-c {
                width: 100% !important;
                margin-bottom: 0 !important;
            }

            /* Stat cards - horizontal scroll on mobile, keep 4 side by side */
            .grid-cols-4,
            [style*="grid-template-columns: repeat(4"],
            #cost>div:first-child {
                display: flex !important;
                flex-wrap: nowrap !important;
                overflow-x: auto !important;
                -webkit-overflow-scrolling: touch !important;
                gap: 0.375rem !important;
                padding-bottom: 0.25rem !important;
            }

            /* Stat card children - compact for horizontal scroll */
            #cost>div:first-child>div {
                flex: 0 0 110px !important;
                min-width: 110px !important;
                padding: 0.5rem 0.375rem !important;
            }

            /* Stat card values - scale down fonts */
            #cost>div:first-child>div [style*="font-size: 32px"],
            #cost>div:first-child>div [style*="font-size: 36px"] {
                font-size: 1rem !important;
            }

            #cost>div:first-child>div [style*="font-size: 14px"],
            #cost>div:first-child>div [style*="font-size: 16px"] {
                font-size: 0.5rem !important;
            }

            #cost>div:first-child>div [style*="font-size: 12px"] {
                font-size: 0.4rem !important;
            }

            /* Category cards (Identity, Probate, etc.) */
            .bg-white\/5.p-8,
            [class*="bg-white/5"][class*="p-8"] {
                padding: 0.625rem !important;
            }

            /* ===== LEGAL VIEWER ===== */
            .legal-viewer {
                padding: 0.625rem !important;
                font-size: 0.7rem !important;
                line-height: 1.5 !important;
            }

            .legal-viewer h2 {
                font-size: 0.85rem !important;
                margin-top: 1rem !important;
            }

            .legal-viewer h3 {
                font-size: 0.75rem !important;
            }

            .legal-scroll-box {
                max-height: 50vh !important;
                padding: 0.5rem !important;
            }

            /* ===== TABLES - HORIZONTAL SCROLL ===== */
            .legal-viewer table,
            #cost table,
            table {
                display: block !important;
                overflow-x: auto !important;
                -webkit-overflow-scrolling: touch !important;
                width: 100% !important;
                font-size: 0.75rem !important;
            }

            #cost table th,
            #cost table td,
            .tab-content table th,
            .tab-content table td {
                font-size: 0.75rem !important;
                padding: 0.5rem !important;
                white-space: nowrap !important;
            }

            /* Market analysis table - balanced mobile typography */
            #market-analysis-table {
                font-size: 0.6rem !important;
            }

            #market-analysis-table th {
                font-size: 0.5rem !important;
                padding: 0.375rem 0.25rem !important;
                letter-spacing: 0.02em !important;
            }

            /* First column header - METRIC label */
            #market-analysis-table th:nth-child(1) {
                font-size: 0.45rem !important;
            }

            /* Hero column header - FinalWishes */
            #market-analysis-table th:nth-child(2) {
                font-size: 0.55rem !important;
                color: #C8A951 !important;
            }

            /* Competitor headers */
            #market-analysis-table th:nth-child(3),
            #market-analysis-table th:nth-child(4) {
                font-size: 0.45rem !important;
                color: #94a3b8 !important;
            }

            #market-analysis-table td {
                font-size: 0.55rem !important;
                padding: 0.375rem 0.25rem !important;
            }

            /* Metric names - first column */
            #market-analysis-table td:nth-child(1) {
                font-size: 0.55rem !important;
                font-weight: 600 !important;
            }

            /* Hero values - FinalWishes column */
            #market-analysis-table td:nth-child(2) {
                font-size: 0.6rem !important;
                font-weight: 600 !important;
                color: white !important;
            }

            /* Competitor values - muted */
            #market-analysis-table td:nth-child(3),
            #market-analysis-table td:nth-child(4) {
                font-size: 0.5rem !important;
                color: #94a3b8 !important;
            }

            /* ===== ATOMIC BREAKDOWN - Unified Scale ===== */
            #cost .space-y-6>div h3 {
                font-size: 0.6875rem !important;
                font-weight: 600 !important;
            }

            #cost .space-y-6>div .text-right>div:first-child {
                font-size: 0.6875rem !important;
                font-weight: 500 !important;
            }

            #cost .space-y-6>div .text-xs,
            #cost .space-y-6>div .text-sm {
                font-size: 0.5625rem !important;
            }

            #cost .space-y-6>div table {
                font-size: 0.5625rem !important;
            }

            #cost .space-y-6>div table th,
            #cost .space-y-6>div table td {
                font-size: 0.5625rem !important;
                padding: 0.25rem 0.1875rem !important;
            }

            /* Cost tab - Unified text scale */
            #cost .text-xs {
                font-size: 0.5rem !important;
            }

            #cost .text-sm {
                font-size: 0.5625rem !important;
            }

            #cost .text-base {
                font-size: 0.625rem !important;
            }

            #cost .text-lg {
                font-size: 0.6875rem !important;
            }

            #cost .text-xl {
                font-size: 0.75rem !important;
            }

            #cost .text-2xl {
                font-size: 0.8125rem !important;
            }

            /* ===== STEP LABELS (MSA TAB) - Unified ===== */
            #step-1-label,
            #step-2-label,
            #step-3-label {
                padding: 0.5rem !important;
            }

            #step-1-label h2,
            #step-2-label h2,
            #step-2-plan-label,
            #step-3-label h2 {
                font-size: 0.75rem !important;
                letter-spacing: 0.01em !important;
            }

            #step-1-label p,
            #step-2-label p,
            #step-3-label p {
                font-size: 0.5625rem !important;
                line-height: 1.4 !important;
            }

            /* ===== ACKNOWLEDGMENT BLOCK ===== */
            #msa-acknowledgment-block {
                padding: 0.5rem !important;
            }

            #msa-acknowledgment-block label {
                font-size: 0.625rem !important;
                gap: 0.375rem !important;
                align-items: flex-start !important;
            }

            #msa-acknowledgment-block input[type="checkbox"] {
                width: 1rem !important;
                height: 1rem !important;
                flex-shrink: 0 !important;
                margin-top: 0.0625rem !important;
            }

            /* ===== SIGNATURE BLOCK ===== */
            #signature-block {
                padding: 0.5rem !important;
            }

            #signature-block table {
                display: flex !important;
                flex-direction: column !important;
            }

            #signature-block table tr {
                display: flex !important;
                flex-direction: column !important;
                margin-bottom: 1rem !important;
            }

            #signature-block table td {
                width: 100% !important;
                text-align: center !important;
                padding: 0.25rem 0 !important;
                font-size: 0.625rem !important;
            }

            /* ===== BUTTONS ===== */
            .select-plan-btn,
            #execute-btn,
            #proceed-to-step2,
            button.w-full {
                padding: 0.875rem 1rem !important;
                font-size: 0.8rem !important;
            }

            /* ===== WORKFLOW GUIDE - HIDE ON MOBILE ===== */
            #vertical-workflow-guide {
                display: none !important;
            }

            /* ===== MODAL - MOBILE ADJUSTMENTS ===== */
            .modal-overlay>div {
                max-width: 90vw !important;
                max-height: 90vh !important;
                overflow-y: auto !important;
                padding: 1.25rem !important;
            }

            .modal-overlay input {
                font-size: 0.875rem !important;
                padding: 0.625rem !important;
            }

            .modal-overlay h3 {
                font-size: 1.125rem !important;
            }

            .modal-overlay p {
                font-size: 0.75rem !important;
            }

            .modal-overlay button {
                font-size: 0.75rem !important;
                padding: 0.625rem 1rem !important;
            }

            /* ===== UTILITY OVERRIDES ===== */
            /* Max-width containers - full width on mobile */
            [style*="max-width: 600px"],
            [style*="max-width: 1000px"],
            [style*="max-width: 55rem"],
            [style*="max-width: 50rem"] {
                max-width: 100% !important;
            }

            /* Section margins - tighter */
            [style*="margin-bottom: 96px"] {
                margin-bottom: 2rem !important;
            }

            [style*="margin-bottom: 64px"] {
                margin-bottom: 1.5rem !important;
            }

            [style*="margin-bottom: 48px"] {
                margin-bottom: 1.25rem !important;
            }

            /* Allocation/summary text */
            #allocation-text {
                font-size: 0.875rem !important;
                padding: 0 0.5rem !important;
            }

            /* Header top area */
            .contract-immersive-wrapper>div:first-child {
                padding: 0.5rem !important;
                margin-bottom: 1rem !important;
            }

            /* Gold separator line */
            [style*="width: 128px"][style*="background: #C8A951"] {
                width: 64px !important;
                margin: 0.75rem auto !important;
            }
        }

        /* SMALL PHONE BREAKPOINT (480px and below) */
        @media (max-width: 480px) {

            /* Main heading even smaller */
            .contract-immersive-wrapper h1,
            [style*="font-size: 42px"] {
                font-size: 1.125rem !important;
            }

            /* SOW title */
            .tab-content h2.text-6xl {
                font-size: 1rem !important;
            }

            /* Stat cards - single column */
            .grid-cols-4,
            [style*="grid-template-columns: repeat(4"],
            .grid-cols-2 {
                grid-template-columns: 1fr !important;
            }

            /* Even smaller fonts */
            .legal-viewer {
                font-size: 0.8rem !important;
            }

            .legal-viewer h2 {
                font-size: 1rem !important;
            }

            /* Tab buttons */
            .tab-btn {
                font-size: 0.7rem !important;
                padding: 0.625rem 0.75rem !important;
            }

            /* Very tight padding */
            .tab-content {
                padding: 0.875rem 0.75rem !important;
            }

            /* Body text */
            .tab-content p,
            .tab-content li {
                font-size: 0.8rem !important;
            }

            /* Tables even smaller */
            table th,
            table td {
                font-size: 0.65rem !important;
                padding: 0.375rem !important;
            }
        }
    </style>

    <!-- Note: PDF generation now uses browser's native print dialog with @media print CSS -->
    <!-- Future: OpenSign API will provide server-side PDF generation for signed documents -->
</head>

<body>
    <div class="admin-wrapper">
        <!-- Sidebar Component -->
        <div id="sidebar-root" data-active="proposal-contract"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header Component -->
            <header id="universal-header-root" data-title="Partnership Agreement"
                data-subtitle="Sirsi Engineering • Strategic Partnership" class="project-title-display"
                data-search-placeholder="Search contract terms..."></header>

            <!-- Immersive Contract View -->
            <div id="contract-immersive-wrapper" class="contract-immersive-wrapper pb-48">

                <!-- Header Component -->
                <div class="flex flex-col items-center justify-center mb-20 pt-20 px-4 relative w-full mx-auto">

                    <!-- Title -->
                    <div class="contract-title-wrapper"
                        style="text-align: center; width: 100%; margin: 0 auto; display: flex; flex-direction: column; align-items: center;">
                        <h1 id="main-contract-heading" class="contract-main-heading">
                            Technical Partnership Agreement
                        </h1>
                        <div class="contract-gold-divider"></div>
                        <p id="proposal-subtitle" class="contract-subtitle">
                            Prepared for Tameeka Lockhart • <span id="date-proposal"></span>
                        </p>
                    </div>
                </div>

                <div class="main-card">

                    <!-- TABS -->
                    <div class="nav-tabs">
                        <button class="tab-btn active" onclick="switchTab('sow')">Statement of Work</button>
                        <button class="tab-btn" onclick="switchTab('cost')">Cost & Valuation</button>
                        <button class="tab-btn" onclick="switchTab('contract')">Master Agreement (MSA)</button>
                        <button class="tab-btn" id="vault-tab-btn" onclick="switchTab('vault')">Sirsi Vault</button>
                    </div>

                    <!-- TAB 1: SOW -->
                    <div id="sow" class="tab-content active text-blue-100"
                        style="padding-top: 1rem !important; position: relative;">
                        <div
                            style="display: flex; flex-direction: column; max-width: 1200px; margin: 0 auto; padding: 0 24px;">
                            <div style="width: 100%;">
                                <!-- HEADER -->
                                <div
                                    style="border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 24px; margin-bottom: 32px; text-align: center;">
                                    <h2 id="sow-main-heading"
                                        style="font-size: 3.5rem; color: #C8A951; margin-bottom: 24px; font-family: Cinzel, serif; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 700;">
                                        Statement of Work (SOW)</h2>
                                    <div
                                        style="display: flex; flex-wrap: wrap; justify-content: center; gap: 32px; font-size: 14px; font-family: monospace; color: #93c5fd;">
                                        <div><strong style="color: white;">Project:</strong> <span
                                                class="project-name-insert">FinalWishes</span> Platform
                                            <br><strong style="color: white;">Reference:</strong> MSA-2026-FW-001
                                        </div>
                                        <div><strong style="color: white;">Date:</strong> <span id="date-sow"></span>
                                        </div>
                                        <div><strong style="color: white;">Ref:</strong> SOW-<span
                                                id="year-ref"></span>-001</div>
                                        <div><strong style="color: white;">MSA:</strong> MSA-<span
                                                id="year-msa"></span>-111-FW</div>
                                    </div>
                                </div>

                                <!-- 1. CHOOSE YOUR PATH -->
                                <h2
                                    class="text-[#C8A951] mt-12 mb-8 text-3xl font-extrabold uppercase tracking-widest text-center">
                                    1. Choose Your Path</h2>

                                <p class="mb-8 text-lg leading-relaxed text-center"
                                    style="font-family: 'Inter', sans-serif !important; font-size: 1.125rem !important; line-height: 1.75 !important; color: rgba(255, 255, 255, 0.9) !important; max-width: 55rem; margin: 0 auto 2rem auto;">
                                <div class="mb-12">
                                    <div class="neo-card-gold"
                                        style="max-width: 900px; margin: 0 auto; text-align: center; background: linear-gradient(145deg, rgba(20, 40, 80, 0.4), rgba(10, 20, 40, 0.4)) !important;">
                                        <div
                                            style="display: inline-block; background: #C8A951; color: #000; padding: 4px 16px; border-radius: 4px; font-weight: bold; font-size: 11px; margin-bottom: 24px; text-transform: uppercase; letter-spacing: 0.2em;">
                                            Execution Plan: Unified Platform</div>
                                        <h3
                                            style="font-family: 'Cinzel', serif; font-size: 42px; color: white; margin-bottom: 12px; font-weight: 700;">
                                            FinalWishes Platform</h3>
                                        <p
                                            style="font-size: 18px; color: #C8A951; text-transform: uppercase; letter-spacing: 0.3em; margin-bottom: 32px;">
                                            Cross-Platform Excellence • iOS + Android + Web</p>

                                        <div
                                            style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; margin-bottom: 40px;">
                                            <div
                                                style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 8px;">
                                                <div
                                                    style="color: #94a3b8; font-size: 12px; text-transform: uppercase; margin-bottom: 8px;">
                                                    Fixed Investment</div>
                                                <div style="color: white; font-family: Cinzel, serif; font-size: 28px;">
                                                    $95,000</div>
                                            </div>
                                            <div
                                                style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 8px;">
                                                <div
                                                    style="color: #94a3b8; font-size: 12px; text-transform: uppercase; margin-bottom: 8px;">
                                                    Deployment</div>
                                                <div style="color: white; font-family: Cinzel, serif; font-size: 28px;">
                                                    16 Weeks</div>
                                            </div>
                                            <div
                                                style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 8px;">
                                                <div
                                                    style="color: #94a3b8; font-size: 12px; text-transform: uppercase; margin-bottom: 8px;">
                                                    Engineering</div>
                                                <div style="color: white; font-family: Cinzel, serif; font-size: 28px;">
                                                    480+ Hrs</div>
                                            </div>
                                        </div>

                                        <div
                                            style="text-align: left; max-width: 700px; margin: 0 auto; color: rgba(255,255,255,0.9); line-height: 1.8; font-size: 16px;">
                                            <p class="mb-6">This engagement delivers the complete <strong
                                                    class="project-name-insert">FinalWishes</strong> Platform,
                                                integrating secure legacy storage with advanced settlement automation.
                                                iPhone, Android, and Desktop Web. This phase establishes the
                                                <strong>"Living Legacy"</strong> core features while implementing the
                                                industrial-grade plumbing for the full <strong>Estate Operating
                                                    System</strong>.
                                            </p>
                                            <div
                                                style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 24px;">
                                                <ul style="list-style: none; padding: 0;">
                                                    <li style="margin-bottom: 12px;"><span
                                                            style="color: #10B981; margin-right: 8px;">✓</span> Video &
                                                        Photo Memorials</li>
                                                    <li style="margin-bottom: 12px;"><span
                                                            style="color: #10B981; margin-right: 8px;">✓</span> Secure
                                                        Lockbox (KMS Encrypted)</li>
                                                    <li style="margin-bottom: 12px;"><span
                                                            style="color: #10B981; margin-right: 8px;">✓</span> AI
                                                        Obituary Assistant (Gemini)</li>
                                                </ul>
                                                <ul style="list-style: none; padding: 0;">
                                                    <li style="margin-bottom: 12px;"><span
                                                            style="color: #10B981; margin-right: 8px;">✓</span>
                                                        Cross-Platform (React Native)</li>
                                                    <li style="margin-bottom: 12px;"><span
                                                            style="color: #10B981; margin-right: 8px;">✓</span> "The
                                                        Shepherd" AI Foundation</li>
                                                    <li style="margin-bottom: 12px;"><span
                                                            style="color: #10B981; margin-right: 8px;">✓</span> Estate
                                                        Data Structures (SOC 2)</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 2. STRATEGIC POSITIONING -->
                                <h2
                                    class="text-[#C8A951] mt-12 mb-8 text-3xl font-extrabold uppercase tracking-widest text-center">
                                    2. Strategic Positioning</h2>

                                <div class="neo-glass-panel" style="max-width: 900px; margin: 0 auto 4rem auto;">
                                    <p class="mb-8 text-lg leading-relaxed">
                                        FinalWishes is not merely a digital archive; it is a <strong>Legacy Management
                                            Application</strong> designed to curate the "Soul" of the Principal—their
                                        memories, values, and final messages—on a foundation built for scale. By
                                        leveraging <strong>Sirsi's Master Logic Components</strong> and <strong>Google
                                            Cloud's enterprise infrastructure</strong>, we deliver a suite that
                                        typically requires an $180,000+ agency budget.
                                    </p>
                                    <div
                                        style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 8px; padding: 1.5rem 2rem;">
                                        <p
                                            style="color: #10b981; font-weight: 600; margin-bottom: 0.75rem; font-size: 14px; text-transform: uppercase; letter-spacing: 0.1em;">
                                            💡 The Google Stack Advantage</p>
                                        <p
                                            style="color: rgba(255,255,255,0.9); font-size: 15px; line-height: 1.7; margin: 0;">
                                            We utilize Google's $50M+ annual engineering investment in <strong>Gemini
                                                AI, YouTube API, and Google Photos</strong>. Your platform gains
                                            world-class media handling and intelligence capabilities out of the box,
                                            ensuring permanent preservation of life's most important moments.
                                        </p>
                                    </div>
                                </div>

                                <!-- 3. STRATEGIC ADD-ON MODULES -->
                                <h2
                                    class="text-[#C8A951] mt-16 mb-8 text-3xl font-extrabold uppercase tracking-widest text-center">
                                    3. Strategic Add-On Modules</h2>

                                <div class="neo-glass-panel" style="max-width: 800px; margin: 0 auto 3rem auto;">
                                    <p class="text-center text-blue-100 font-medium">
                                        Enhance your platform with specialized modules designed for long-term growth and
                                        operational efficiency.
                                    </p>
                                    <p class="text-center text-sm text-white/50 mt-1">
                                        Select any modules below to add them to your contract. Pricing is fixed-bid.
                                    </p>
                                </div>

                                <!-- Add-on Running Total -->
                                <div id="addon-total-bar"
                                    class="hidden mb-8 p-4 bg-[#10B981]/10 border border-[#10B981]/30 rounded-lg text-center">
                                    <span class="text-white/70 text-sm">Selected Add-Ons Total:</span>
                                    <span id="addon-total-value"
                                        class="text-[#10B981] font-bold text-2xl ml-2">$0</span>
                                    <span class="text-white/50 text-sm ml-2">| Combined with Core: </span>
                                    <span id="addon-grand-total" class="text-[#C8A951] font-bold text-xl">$95,000</span>
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-16">

                                    <!-- Branding & Identity Add-on -->
                                    <div id="addon-card-branding" onclick="toggleAddon('branding', this)"
                                        class="addon-card p-6 bg-white/5 border border-white/10 rounded-xl hover:border-[#C8A951]/50 cursor-pointer transition-all relative">
                                        <div class="flex justify-between items-start mb-4">
                                            <div class="p-3 bg-gold/10 rounded-lg text-gold">
                                                <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor" stroke-width="2">
                                                    <path
                                                        d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01" />
                                                </svg>
                                            </div>
                                            <div
                                                class="w-6 h-6 rounded border-2 border-white/30 flex items-center justify-center checkbox-indicator transition-colors">
                                            </div>
                                        </div>
                                        <h4 class="text-white font-bold text-lg mb-1">Branding & Identity</h4>
                                        <div class="flex items-baseline gap-2 mb-3">
                                            <span class="text-[#C8A951] font-bold text-2xl">Starting at $30,000</span>
                                            <span class="text-gray-500 text-xs">| 8 weeks</span>
                                        </div>
                                        <p class="text-xs text-blue-200 mb-3 italic">Establishing the visual soul of the
                                            platform.</p>
                                        <ul
                                            class="text-xs text-gray-400 leading-relaxed list-disc list-inside space-y-1">
                                            <li>Comprehensive Logo System & Brand Marks</li>
                                            <li>Global Voice & Tone Guidelines</li>
                                            <li>Cross-Platform UI/UX Component Kit</li>
                                            <li>Marketing Assets & Social Templates</li>
                                        </ul>
                                    </div>

                                    <!-- Maintenance & Support Add-on -->
                                    <div id="addon-card-maintenance" onclick="toggleAddon('maintenance', this)"
                                        class="addon-card p-6 bg-white/5 border border-white/10 rounded-xl hover:border-[#C8A951]/50 cursor-pointer transition-all relative">
                                        <div class="flex justify-between items-start mb-4">
                                            <div class="p-3 bg-gold/10 rounded-lg text-gold">
                                                <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor" stroke-width="2">
                                                    <path
                                                        d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                                    <path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                                </svg>
                                            </div>
                                            <div
                                                class="w-6 h-6 rounded border-2 border-white/30 flex items-center justify-center checkbox-indicator transition-colors">
                                            </div>
                                        </div>
                                        <h4 class="text-white font-bold text-lg mb-1">Maintenance & Support <span
                                                class="text-[#C8A951] text-xs font-normal">(Max 20Hrs/Mo)</span></h4>
                                        <div class="flex items-baseline gap-2 mb-3">
                                            <span class="text-[#C8A951] font-bold text-2xl">$18,000</span>
                                            <span class="text-gray-500 text-xs">| 12 months</span>
                                        </div>
                                        <p class="text-xs text-blue-200 mb-3 italic">Dedicated engineering insurance for
                                            platform longevity.</p>
                                        <ul
                                            class="text-xs text-gray-400 leading-relaxed list-disc list-inside space-y-1">
                                            <li>24/7 Server Uptime Monitoring</li>
                                            <li>Critical Security Patching</li>
                                            <li>4-Hour Emergency Response SLA</li>
                                            <li>Monthly System Health Reports</li>
                                        </ul>
                                    </div>

                                    <!-- Estate Administration Add-on -->
                                    <div id="addon-card-estate" onclick="toggleAddon('estate', this)"
                                        class="addon-card p-6 bg-white/5 border border-white/10 rounded-xl hover:border-[#C8A951]/50 cursor-pointer transition-all relative">
                                        <div class="flex justify-between items-start mb-4">
                                            <div class="p-3 bg-gold/10 rounded-lg text-gold">
                                                <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor" stroke-width="2">
                                                    <path
                                                        d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                                                </svg>
                                            </div>
                                            <div
                                                class="w-6 h-6 rounded border-2 border-white/30 flex items-center justify-center checkbox-indicator transition-colors">
                                            </div>
                                        </div>
                                        <h4 class="text-white font-bold text-lg mb-1">Estate Administration</h4>
                                        <div class="flex items-baseline gap-2 mb-3">
                                            <span class="text-[#C8A951] font-bold text-2xl">$65,000</span>
                                            <span class="text-gray-500 text-xs">| 8 weeks</span>
                                        </div>
                                        <p class="text-xs text-blue-200 mb-3 italic">A comprehensive operating system
                                            for the Executor role.</p>
                                        <ul
                                            class="text-xs text-gray-400 leading-relaxed list-disc list-inside space-y-1">
                                            <li>Role-Based Executor Dashboards</li>
                                            <li>Real-Time Asset Inventory Tracking</li>
                                            <li>Beneficiary Communication Hub</li>
                                            <li>Automated Task Workflows & Alerts</li>
                                        </ul>
                                    </div>

                                    <!-- Probate Engine Add-on -->
                                    <div id="addon-card-probate" onclick="toggleAddon('probate', this)"
                                        class="addon-card p-6 bg-white/5 border border-white/10 rounded-xl hover:border-[#C8A951]/50 cursor-pointer transition-all relative">
                                        <div class="flex justify-between items-start mb-4">
                                            <div class="p-3 bg-gold/10 rounded-lg text-gold">
                                                <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor" stroke-width="2">
                                                    <path
                                                        d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                                </svg>
                                            </div>
                                            <div
                                                class="w-6 h-6 rounded border-2 border-white/30 flex items-center justify-center checkbox-indicator transition-colors">
                                            </div>
                                        </div>
                                        <h4 class="text-white font-bold text-lg mb-1">Probate Engine</h4>
                                        <div class="flex items-baseline gap-2 mb-3">
                                            <span class="text-[#C8A951] font-bold text-2xl">$35,000</span>
                                            <span class="text-gray-500 text-xs">| per state | 10+ weeks</span>
                                        </div>
                                        <p class="text-xs text-blue-200 mb-3 italic">Automating the legal bureaucracy of
                                            state-specific courts.</p>
                                        <ul
                                            class="text-xs text-gray-400 leading-relaxed list-disc list-inside space-y-1">
                                            <li>State-Specific Court Form Automation</li>
                                            <li>Statute & Deadline Tracking Logic</li>
                                            <li>"The Shepherd" Legal Guidance Modules</li>
                                            <li><em class="text-white/60">Built on Sirsi Minimum Probate IP</em></li>
                                        </ul>
                                    </div>

                                    <!-- Probate AI Enhancement -->
                                    <div id="addon-card-ai" onclick="toggleAddon('ai', this)"
                                        class="addon-card p-6 bg-white/5 border border-white/10 rounded-xl hover:border-[#C8A951]/50 cursor-pointer transition-all relative">
                                        <div class="flex justify-between items-start mb-4">
                                            <div class="p-3 bg-gold/10 rounded-lg text-gold">
                                                <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor" stroke-width="2">
                                                    <path
                                                        d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                                                </svg>
                                            </div>
                                            <div
                                                class="w-6 h-6 rounded border-2 border-white/30 flex items-center justify-center checkbox-indicator transition-colors">
                                            </div>
                                        </div>
                                        <h4 class="text-white font-bold text-lg mb-1">Probate AI Enhancement</h4>
                                        <div class="flex items-baseline gap-2 mb-3">
                                            <span class="text-[#C8A951] font-bold text-2xl">$25,000</span>
                                            <span class="text-gray-500 text-xs text-nowrap">| 4 wks | Req. Probate
                                                Eng.</span>
                                        </div>
                                        <p class="text-xs text-blue-200 mb-3 italic">Intelligent automation for document
                                            parsing and form completion.</p>
                                        <ul
                                            class="text-xs text-gray-400 leading-relaxed list-disc list-inside space-y-1">
                                            <li>Legal Document Analysis & Extraction</li>
                                            <li>Automated Form Pre-filling via RAG</li>
                                            <li>Predictive Deadline Management</li>
                                            <li>Smart Case Categorization</li>
                                        </ul>
                                    </div>

                                    <!-- Secure Communication Suite (NEW) -->
                                    <div id="addon-card-comms" onclick="toggleAddon('comms', this)"
                                        class="addon-card p-6 bg-white/5 border border-white/10 rounded-xl hover:border-[#C8A951]/50 cursor-pointer transition-all relative">
                                        <div class="flex justify-between items-start mb-4">
                                            <div class="p-3 bg-gold/10 rounded-lg text-gold">
                                                <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor" stroke-width="2">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                                                </svg>
                                            </div>
                                            <div
                                                class="w-6 h-6 rounded border-2 border-white/30 flex items-center justify-center checkbox-indicator transition-colors">
                                            </div>
                                        </div>
                                        <h4 class="text-white font-bold text-lg mb-1">Secure Comms Suite</h4>
                                        <div class="flex items-baseline gap-2 mb-3">
                                            <span class="text-[#C8A951] font-bold text-2xl">$30,000</span>
                                            <span class="text-gray-500 text-xs">| 4 weeks</span>
                                        </div>
                                        <p class="text-xs text-blue-200 mb-3 italic">Military-grade privacy for the
                                            family's most sensitive moments.</p>
                                        <ul
                                            class="text-xs text-gray-400 leading-relaxed list-disc list-inside space-y-1">
                                            <li>Private Encrypted Messaging (Executor/Kin)</li>
                                            <li>"Dead Man's Switch" Email Forwarding</li>
                                            <li>Integrated Read Receipts & Audit Logs</li>
                                            <li>Secure Document Sharing Portal</li>
                                        </ul>
                                    </div>

                                    <!-- Virtual Memorial Services (NEW) -->
                                    <div id="addon-card-memorial" onclick="toggleAddon('memorial', this)"
                                        class="addon-card p-6 bg-white/5 border border-white/10 rounded-xl hover:border-[#C8A951]/50 cursor-pointer transition-all relative">
                                        <div class="flex justify-between items-start mb-4">
                                            <div class="p-3 bg-gold/10 rounded-lg text-gold">
                                                <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor" stroke-width="2">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                                </svg>
                                            </div>
                                            <div
                                                class="w-6 h-6 rounded border-2 border-white/30 flex items-center justify-center checkbox-indicator transition-colors">
                                            </div>
                                        </div>
                                        <h4 class="text-white font-bold text-lg mb-1">Virtual Memorial Services</h4>
                                        <div class="flex items-baseline gap-2 mb-3">
                                            <span class="text-[#C8A951] font-bold text-2xl">$45,000</span>
                                            <span class="text-gray-500 text-xs">| 6 weeks</span>
                                        </div>
                                        <p class="text-xs text-blue-200 mb-3 italic">Digital infrastructure for
                                            gathering, grieving, and remembering.</p>
                                        <ul
                                            class="text-xs text-gray-400 leading-relaxed list-disc list-inside space-y-1">
                                            <li>Integrated YouTube Live Streaming</li>
                                            <li>Digital Guestbook & Condolence Board</li>
                                            <li>Event Scheduling & RSVPs (Google Meet)</li>
                                            <li>Permanent Video Tribute Hosting</li>
                                        </ul>
                                    </div>

                                    <!-- Advanced Asset Discovery -->
                                    <div id="addon-card-financial" onclick="toggleAddon('financial', this)"
                                        class="addon-card p-6 bg-white/5 border border-white/10 rounded-xl hover:border-[#C8A951]/50 cursor-pointer transition-all relative">
                                        <div class="flex justify-between items-start mb-4">
                                            <div class="p-3 bg-gold/10 rounded-lg text-gold">
                                                <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                    stroke="currentColor" stroke-width="2">
                                                    <path
                                                        d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                                </svg>
                                            </div>
                                            <div
                                                class="w-6 h-6 rounded border-2 border-white/30 flex items-center justify-center checkbox-indicator transition-colors">
                                            </div>
                                        </div>
                                        <h4 class="text-white font-bold text-lg mb-1">Advanced Asset Discovery</h4>
                                        <div class="flex items-baseline gap-2 mb-3">
                                            <span class="text-[#C8A951] font-bold text-2xl">$60,000+</span>
                                            <span class="text-gray-500 text-xs">| 8-12 weeks | Custom</span>
                                        </div>
                                        <p class="text-xs text-blue-200 mb-3 italic">Fintech-level integration for total
                                            asset visibility.</p>
                                        <ul
                                            class="text-xs text-gray-400 leading-relaxed list-disc list-inside space-y-1">
                                            <li>Multi-Institution Asset Discovery</li>
                                            <li>Real-Time Balance Aggregation</li>
                                            <li>Liability Inventory Management</li>
                                            <li><span class="text-green-400">Note: Basic API access (Plaid/Stripe) is
                                                    FREE in Core.</span></li>
                                        </ul>
                                    </div>

                                </div>


                                <!-- 4. DETAILED SCOPE -->
                                <h2 class="text-[#C8A951] mt-12 mb-6">4. Detailed Scope of Services</h2>

                                <!-- ========== OPTION A: LEGACY CORE SCOPE ========== -->
                                <div id="scope-option-a" class="neo-glass-panel">

                                    <!-- 3.1 Legacy Media Vault -->
                                    <h3
                                        class="text-blue-300 text-sm tracking-[0.2em] uppercase font-sans font-bold mb-6 border-b border-white/10 pb-2 mt-12">
                                        3.1 Legacy Media Vault</h3>
                                    <p class="mb-4">Provider shall implement a <strong>YouTube and Google
                                            Photos-powered</strong>
                                        media management system for preserving legacy content.</p>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                                        <!-- Video Memorials -->
                                        <div
                                            class="bg-white/5 p-8 rounded-lg border border-white/5 hover:border-[#C8A951]/30 transition-colors">
                                            <h4
                                                class="text-[#C8A951] font-bold mb-4 text-lg border-b border-white/10 pb-2">
                                                Video Memorials</h4>
                                            <ul class="list-disc pl-5 text-sm text-blue-200 space-y-3">
                                                <li><strong class="text-white">YouTube Integration:</strong> Unlisted
                                                    video uploads via YouTube API with automatic transcoding.</li>
                                                <li><strong class="text-white">In-App Recording:</strong> Record
                                                    directly from iPhone camera, upload seamlessly.</li>
                                                <li><strong class="text-white">Editing:</strong> Deep link to YouTube
                                                    Studio for trim, crop, and audio adjustments.</li>
                                                <li><strong class="text-white">Memoir Playlists:</strong> Curate videos
                                                    into ordered memorial playlists.</li>
                                            </ul>
                                        </div>
                                        <!-- Photo Galleries -->
                                        <div
                                            class="bg-white/5 p-8 rounded-lg border border-white/5 hover:border-[#C8A951]/30 transition-colors">
                                            <h4
                                                class="text-[#C8A951] font-bold mb-4 text-lg border-b border-white/10 pb-2">
                                                Photo Galleries</h4>
                                            <ul class="list-disc pl-5 text-sm text-blue-200 space-y-3">
                                                <li><strong class="text-white">Google Photos API:</strong> Create and
                                                    manage "Legacy Albums" via API.</li>
                                                <li><strong class="text-white">Auto-Organization:</strong> Vision API
                                                    auto-tags family, events, and locations.</li>
                                                <li><strong class="text-white">Editing:</strong> Deep link to Google
                                                    Photos app for filters and enhancements.</li>
                                                <li><strong class="text-white">Sharing:</strong> Generate shareable
                                                    album links for heirs.</li>
                                            </ul>
                                        </div>
                                    </div>

                                    <!-- 3.2 Secure Digital Lockbox -->
                                    <h3
                                        class="text-blue-300 text-sm tracking-[0.2em] uppercase font-sans font-bold mb-6 border-b border-white/10 pb-2 mt-16">
                                        3.2 Secure Digital Lockbox</h3>
                                    <p class="mb-4">Provider shall build a secure vault for sensitive non-financial
                                        information.</p>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                                        <div class="bg-white/5 p-6 rounded-lg border border-white/5">
                                            <h4 class="text-[#C8A951] font-bold mb-3">🔐 Passwords & Accounts</h4>
                                            <p class="text-sm text-blue-200">Encrypted storage for social media logins,
                                                email accounts, and subscription services. Client-side encryption with
                                                Cloud KMS.</p>
                                        </div>
                                        <div class="bg-white/5 p-6 rounded-lg border border-white/5">
                                            <h4 class="text-[#C8A951] font-bold mb-3">📍 Secure Locations</h4>
                                            <p class="text-sm text-blue-200">"Where I keep things" notes—safe
                                                combinations, hidden keys, safety deposit boxes, buried items.</p>
                                        </div>
                                        <div class="bg-white/5 p-6 rounded-lg border border-white/5">
                                            <h4 class="text-[#C8A951] font-bold mb-3">💎 Heirloom Registry</h4>
                                            <p class="text-sm text-blue-200">Photo-documented inventory of family
                                                heirlooms with designated recipients and stories.</p>
                                        </div>
                                    </div>

                                    <!-- 3.3 Final Directives -->
                                    <h3
                                        class="text-blue-300 text-sm tracking-[0.2em] uppercase font-sans font-bold mb-6 border-b border-white/10 pb-2 mt-16">
                                        3.3 Final Directives & Documents</h3>
                                    <p class="mb-4">Provider shall implement secure document upload and management
                                        capabilities.</p>
                                    <ul class="list-disc pl-6 mb-12 text-blue-200 space-y-4 text-base leading-relaxed">
                                        <li><strong class="text-white">Will & Testament:</strong> Secure upload of legal
                                            documents with version control.</li>
                                        <li><strong class="text-white">Personal Directives:</strong> Living wills, DNR
                                            preferences, medical power of attorney.</li>
                                        <li><strong class="text-white">Final Wishes Statements:</strong> Funeral
                                            preferences, burial/cremation desires, memorial instructions.</li>
                                        <li><strong class="text-white">Ethical Will:</strong> Letters of love, life
                                            lessons, and values to pass on to heirs.</li>
                                    </ul>

                                    <!-- 3.4 AI Assistance -->
                                    <h3
                                        class="text-blue-300 text-sm tracking-[0.2em] uppercase font-sans font-bold mb-6 border-b border-white/10 pb-2 mt-16">
                                        3.4 AI-Powered Assistance</h3>
                                    <div class="bg-white/5 p-8 rounded-lg border border-white/5 mb-12">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                            <div class="flex gap-4">
                                                <div class="text-[#C8A951] pt-1">
                                                    <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                        stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2"
                                                            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z">
                                                        </path>
                                                    </svg>
                                                </div>
                                                <div>
                                                    <h4 class="text-white font-bold mb-1">Obituary Drafting</h4>
                                                    <p class="text-sm text-blue-200">Gemini AI assists in crafting
                                                        meaningful obituaries from photos, videos, and notes.</p>
                                                </div>
                                            </div>
                                            <div class="flex gap-4">
                                                <div class="text-[#C8A951] pt-1">
                                                    <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                        stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2"
                                                            d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z">
                                                        </path>
                                                    </svg>
                                                </div>
                                                <div>
                                                    <h4 class="text-white font-bold mb-1">Memory Prompts</h4>
                                                    <p class="text-sm text-blue-200">AI-guided questions to help capture
                                                        life stories and important memories.</p>
                                                </div>
                                            </div>
                                            <div class="flex gap-4">
                                                <div class="text-[#C8A951] pt-1">
                                                    <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                        stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2"
                                                            d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z">
                                                        </path>
                                                    </svg>
                                                </div>
                                                <div>
                                                    <h4 class="text-white font-bold mb-1">Voice Transcription</h4>
                                                    <p class="text-sm text-blue-200">Speech-to-Text API converts voice
                                                        recordings to searchable text.</p>
                                                </div>
                                            </div>
                                            <div class="flex gap-4">
                                                <div class="text-[#C8A951] pt-1">
                                                    <svg width="24" height="24" fill="none" viewBox="0 0 24 24"
                                                        stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2"
                                                            d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z">
                                                        </path>
                                                    </svg>
                                                </div>
                                                <div>
                                                    <h4 class="text-white font-bold mb-1">Auto-Captioning</h4>
                                                    <p class="text-sm text-blue-200">Generate subtitles for video
                                                        memorials automatically.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 3.5 Time Capsule -->
                                    <h3
                                        class="text-blue-300 text-sm tracking-[0.2em] uppercase font-sans font-bold mb-6 border-b border-white/10 pb-2 mt-16">
                                        3.5 Time Capsule & Scheduled Delivery</h3>
                                    <ul class="list-disc pl-6 mb-12 text-blue-200 space-y-4 text-base leading-relaxed">
                                        <li><strong class="text-white">Future-Dated Messages:</strong> Schedule
                                            video/text messages for birthdays, anniversaries, or milestones.</li>
                                        <li><strong class="text-white">Conditional Release:</strong> Content unlocked
                                            upon verified death or specified trigger.</li>
                                        <li><strong class="text-white">Heir Notifications:</strong> Firebase Cloud
                                            Messaging alerts when content becomes available.</li>
                                    </ul>

                                    <!-- 3.6 Platform & Technology -->
                                    <h3
                                        class="text-blue-300 text-sm tracking-[0.2em] uppercase font-sans font-bold mb-6 border-b border-white/10 pb-2 mt-16">
                                        3.6 Platform & Technology Stack</h3>
                                    <div class="overflow-x-auto mb-12 bg-white/5 rounded-lg border border-white/5 p-4">
                                        <table class="w-full text-left border-collapse">
                                            <thead>
                                                <tr class="border-b border-white/20 text-[#C8A951]">
                                                    <th class="p-3">Component</th>
                                                    <th class="p-3">Technology</th>
                                                    <th class="p-3">Benefit</th>
                                                </tr>
                                            </thead>
                                            <tbody class="text-sm text-slate-200" style="color: #e2e8f0;">
                                                <tr class="border-b border-white/5 bg-white/5">
                                                    <td class="p-3 font-bold">Mobile App</td>
                                                    <td class="p-3">React Native (Expo) — iOS + Android + Web</td>
                                                    <td class="p-3">Unified codebase across all platforms</td>
                                                </tr>
                                                <tr class="border-b border-white/5">
                                                    <td class="p-3 font-bold">Video Platform</td>
                                                    <td class="p-3">YouTube API (Unlisted)</td>
                                                    <td class="p-3">Free transcoding, unlimited storage</td>
                                                </tr>
                                                <tr class="border-b border-white/5 bg-white/5">
                                                    <td class="p-3 font-bold">Photo Platform</td>
                                                    <td class="p-3">Google Photos API</td>
                                                    <td class="p-3">Free storage, auto-organization</td>
                                                </tr>
                                                <tr class="border-b border-white/5">
                                                    <td class="p-3 font-bold">AI Engine</td>
                                                    <td class="p-3">Gemini 3.0 (Vertex AI)</td>
                                                    <td class="p-3">Best-in-class language model</td>
                                                </tr>
                                                <tr class="border-b border-white/5 bg-white/5">
                                                    <td class="p-3 font-bold">Backend</td>
                                                    <td class="p-3">Go on Cloud Run</td>
                                                    <td class="p-3">Serverless, auto-scaling</td>
                                                </tr>
                                                <tr class="border-b border-white/5">
                                                    <td class="p-3 font-bold">Database</td>
                                                    <td class="p-3">Cloud SQL (PostgreSQL)</td>
                                                    <td class="p-3">Secure PII storage</td>
                                                </tr>
                                                <tr class="border-b border-white/5 bg-white/5">
                                                    <td class="p-3 font-bold">Encryption</td>
                                                    <td class="p-3">Cloud KMS (AES-256)</td>
                                                    <td class="p-3">Bank-grade security</td>
                                                </tr>
                                                <tr>
                                                    <td class="p-3 font-bold">Authentication</td>
                                                    <td class="p-3">Firebase Auth + MFA</td>
                                                    <td class="p-3">Secure, biometric-ready</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- 5. WORK BREAKDOWN STRUCTURE (WBS) -->
                                <h2
                                    class="text-[#C8A951] mt-12 mb-8 text-3xl font-extrabold uppercase tracking-widest text-center">
                                    5. Work Breakdown Structure (WBS)</h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                                    <!-- PHASE 1 -->
                                    <div class="bg-white/5 p-8 rounded border border-[#C8A951]/30">
                                        <div class="mb-6">
                                            <h4 class="text-white text-lg font-bold mb-1">PHASE 1: FOUNDATION & VAULT
                                            </h4>
                                            <p class="text-[#C8A951] text-sm font-medium">WEEKS 1-4</p>
                                        </div>
                                        <ul class="space-y-4 text-sm text-blue-200 list-disc pl-5">
                                            <li><strong class="text-white">1.1 GCP Infrastructure:</strong> Provision
                                                Cloud Run, Cloud SQL, Firestore, VPC.</li>
                                            <li><strong class="text-white">1.2 Ops:</strong> Setup GitHub Actions CI/CD
                                                workflows.</li>
                                            <li><strong class="text-white">1.3 Auth:</strong> Firebase Auth + MFA +
                                                Custom Claims.</li>
                                            <li><strong class="text-white">1.4 Schema:</strong> Design Relational
                                                (Heirs) vs Document (Metadata).</li>
                                            <li><strong class="text-white">1.5 Vault:</strong> Implement AES-256 crypto
                                                service.</li>
                                            <li><strong class="text-white">1.6 E-Sign:</strong> Deploy Self-Hosted
                                                OpenSign.</li>
                                        </ul>
                                    </div>

                                    <!-- PHASE 2 -->
                                    <div class="bg-white/5 p-8 rounded border border-white/10">
                                        <div class="mb-6">
                                            <h4 class="text-white text-lg font-bold mb-1">PHASE 2: CORE LOGIC & AI
                                            </h4>
                                            <p class="text-blue-300 text-sm font-medium">WEEKS 5-10</p>
                                        </div>
                                        <ul class="space-y-4 text-sm text-blue-200 list-disc pl-5">
                                            <li><strong class="text-white">2.1 Memorial Module:</strong> Video & Photo
                                                integration logic.</li>
                                            <li><strong class="text-white">2.2 Legacy Engine:</strong> Build
                                                time-capsule and scheduling logic.</li>
                                            <li><strong class="text-white">2.3 Gemini AI:</strong> Connect RAG pipeline
                                                for obituary assistance.</li>
                                            <li><strong class="text-white">2.4 PDF Service:</strong> Go-based document
                                                generation for legacy exports.</li>
                                        </ul>
                                    </div>

                                    <!-- PHASE 3 -->
                                    <div class="bg-white/5 p-8 rounded border border-white/10">
                                        <div class="mb-6">
                                            <h4 class="text-white text-lg font-bold">PHASE 3: TRI-PLATFORM DEPLOYMENT
                                            </h4>
                                            <p class="text-blue-300 text-sm font-medium">WEEKS 9-11</p>
                                        </div>
                                        <ul class="space-y-4 text-sm text-blue-200 list-disc pl-5">
                                            <li><strong class="text-white">3.1 React Native:</strong> Unified app build
                                                for iOS & Android.</li>
                                            <li><strong class="text-white">3.2 Web Shell:</strong> Responsive dashboard
                                                for desktop users.</li>
                                            <li><strong class="text-white">3.3 Biometrics:</strong> Enable
                                                FaceID/TouchID for Vault access.</li>
                                        </ul>
                                    </div>

                                    <!-- PHASE 4 -->
                                    <div class="bg-white/5 p-8 rounded border border-white/10">
                                        <div class="mb-6">
                                            <h4 class="text-white text-lg font-bold uppercase">PHASE 4: QA, INTEGRATION
                                                & LAUNCH
                                            </h4>
                                            <p class="text-blue-300 text-sm font-medium">WEEKS 13-16</p>
                                        </div>
                                        <ul class="space-y-4 text-sm text-blue-200 list-disc pl-5">
                                            <li><strong class="text-white">4.1 Testing:</strong> End-to-end testing
                                                and security code review.</li>
                                            <li><strong class="text-white">4.2 PM:</strong> Final client syncing and
                                                project handoff.</li>
                                            <li><strong class="text-white">4.3 Go-Live:</strong> App Store submissions,
                                                DNS switchover and production deployment.</li>
                                        </ul>
                                    </div>
                                </div>

                                <!-- 6. DELIVERABLES -->
                                <h2 class="text-[#C8A951] mt-12 mb-8">6. Deliverables</h2>
                                <div class="overflow-x-auto mb-24 bg-white/5 rounded-lg border border-white/5 p-4">
                                    <table class="w-full text-left border-collapse">
                                        <thead>
                                            <h3 class="text-3xl font-serif text-[#C8A951] mb-2 project-name-insert">
                                                FinalWishes Platform</h3>
                                            <tr class="border-b border-white/20 text-[#C8A951]">
                                                <th class="p-4">Deliverable</th>
                                                <th class="p-4">Description</th>
                                                <th class="p-4">Format</th>
                                            </tr>
                                        </thead>
                                        <tbody class="text-sm text-slate-200">
                                            <tr class="border-b border-white/5">
                                                <td class="p-4 font-bold">D1: The Vault</td>
                                                <td class="p-4">Security core, Auth, Encrypted Storage</td>
                                                <td class="p-4">Staging URL</td>
                                            </tr>
                                            <tr class="border-b border-white/5">
                                                <td class="p-4 font-bold">D2: Mobile Apps</td>
                                                <td class="p-4">iOS and Android binaries (TestFlight)</td>
                                                <td class="p-4">.ipa / .apk</td>
                                            </tr>
                                            <tr class="border-b border-white/5">
                                                <td class="p-4 font-bold">D3: The Platform</td>
                                                <td class="p-4">Production release, fully tested</td>
                                                <td class="p-4">Live URL</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <!-- 6. ASSUMPTIONS -->
                                <h2 class="text-[#C8A951] mt-12 mb-6">7. Assumptions</h2>
                                <div
                                    class="bg-white/5 p-8 rounded-lg border border-white/5 shadow-[0_0_30px_rgba(200,169,81,0.05)]">
                                    <ul class="list-disc pl-6 text-blue-200 space-y-4">
                                        <li><strong>AI Curation:</strong> "The Shepherd" provides memory curation and
                                            procedural legacy
                                            guidance assistance, not legal or financial advice.</li>
                                        <li><strong>Third-Party Costs:</strong> Client pays direct consumption costs for
                                            external APIs (Google Cloud, YouTube API, SendGrid) above the developer
                                            tier.</li>
                                        <li><strong>Media Persistence:</strong> Permanent video preservation is achieved
                                            via the YouTube/Google Photos integration; baseline storage is provided as
                                            part of the Google ecosystem.</li>
                                        <li><strong>Ownership:</strong> Client retains 100% IP ownership of the
                                            developed platform and all User-Generated Content (UGC) upon final payment.
                                        </li>
                                    </ul>
                                </div>

                                <!-- NEXT BUTTON (SOW -> COST) -->
                                <div class="w-full mt-16 mb-12 relative z-10"
                                    style="display: flex; justify-content: flex-end;">
                                    <button onclick="switchTab('cost')"
                                        class="group relative inline-flex items-center justify-center gap-3 h-11 px-6 overflow-hidden bg-gradient-to-r from-[#D4AF37] to-[#C8A951] text-[#050b14] shadow-[0_4px_20px_rgba(200,169,81,0.4)] hover:shadow-[0_0_40px_rgba(200,169,81,0.8)] transition-all duration-500 ease-out border border-[#C8A951] rounded-sm">

                                        <!-- TEXT -->
                                        <span
                                            class="relative z-10 font-serif font-bold text-sm tracking-[0.15em] uppercase">
                                            Next
                                        </span>

                                        <!-- ICON (Elegant Arrow) -->
                                        <svg class="w-4 h-4 relative z-10 transform group-hover:translate-x-1 transition-transform duration-300"
                                            fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3">
                                            </path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB 2: COST -->
                <div id="cost" class="tab-content" style="padding-top: 1rem !important; position: relative;">

                    <!-- ========== PACKAGE OVERVIEW ========== -->
                    <div style="max-width: 1000px; margin: 0 auto 48px auto;">

                        <!-- Header -->
                        <div style="text-align: center; margin-bottom: 32px;">
                            <h2
                                style="font-size: 28px; font-family: Cinzel, serif; color: #C8A951; text-transform: uppercase; letter-spacing: 0.15em;">
                                Project Valuation</h2>
                            <p style="font-size: 16px; color: rgba(255,255,255,0.7);">Transparent pricing and
                                deliverables allocation</p>
                        </div>

                        <!-- Single Package Card -->
                        <div id="cost-package-a" class="neo-glass-panel"
                            style="padding: 32px; transition: all 0.3s ease; position: relative; background: rgba(200,169,81,0.05); border: 2px solid #C8A951; box-shadow: 0 0 40px rgba(200,169,81,0.15);">

                            <!-- Selected Badge -->
                            <div id="badge-a"
                                style="position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; font-size: 11px; font-weight: 700; padding: 4px 16px; border-radius: 20px; text-transform: uppercase; letter-spacing: 0.1em;">
                                Selected
                            </div>

                            <div style="text-align: center;">
                                <p
                                    style="font-size: 12px; color: #C8A951; text-transform: uppercase; letter-spacing: 0.2em; margin-bottom: 8px;">
                                    Unified Platform</p>
                                <h3
                                    style="font-family: Cinzel, serif; font-size: 28px; color: white; margin-bottom: 8px;">
                                    FinalWishes Core</h3>

                                <div
                                    style="font-family: Cinzel, serif; font-size: 56px; color: #C8A951; font-weight: 600; margin: 16px 0;">
                                    $95,000</div>

                                <div
                                    style="display: flex; justify-content: center; gap: 24px; margin-bottom: 24px; font-size: 14px; color: rgba(255,255,255,0.8);">
                                    <span>📱 iOS + Android + Web</span>
                                    <span>⏱ 16 Weeks</span>
                                </div>

                                <div
                                    style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; text-align: left; max-width: 600px; margin: 0 auto;">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <ul
                                            style="font-size: 14px; color: rgba(255,255,255,0.9); list-style: none; padding: 0; margin: 0; line-height: 2;">
                                            <li>✓ Video & Photo Memorials</li>
                                            <li>✓ Secure Digital Vault (Lockbox)</li>
                                            <li>✓ AI Obituary Assistant</li>
                                            <li>✓ Time Capsule Scheduling</li>
                                        </ul>
                                        <ul
                                            style="font-size: 14px; color: rgba(255,255,255,0.9); list-style: none; padding: 0; margin: 0; line-height: 2;">
                                            <li>✓ Google Cloud Infrastructure</li>
                                            <li>✓ "The Shepherd" AI Foundation</li>
                                            <li>✓ Estate Plumbing & Architecture</li>
                                            <li>✓ Cross-Platform Codebase</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>



                    <!-- ========== DYNAMIC STATS (Option A - shown by default) ========== -->
                    <div id="cost-stats-a"
                        style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 24px; margin-bottom: 48px; max-width: 1200px; margin-left: auto; margin-right: auto;">

                        <!-- True Market Value -->
                        <div
                            style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 8px; padding: 32px 24px; text-align: center;">
                            <div
                                style="font-size: 14px; color: #C8A951; text-transform: uppercase; letter-spacing: 0.2em; margin-bottom: 12px; font-weight: 500;">
                                True Market Value</div>
                            <div
                                style="font-size: 32px; font-family: Cinzel, serif; color: #94a3b8; text-decoration: line-through; font-weight: 400;">
                                $150k+</div>
                            <div
                                style="font-size: 12px; color: white; text-transform: uppercase; letter-spacing: 0.15em; margin-top: 8px;">
                                Custom iOS Dev</div>
                        </div>

                        <!-- Fixed Bid Price - HERO -->
                        <div
                            style="background: rgba(200,169,81,0.08); border: 2px solid #C8A951; border-radius: 8px; padding: 32px 24px; text-align: center; box-shadow: 0 0 40px rgba(200,169,81,0.15);">
                            <div
                                style="font-size: 16px; color: #C8A951; text-transform: uppercase; letter-spacing: 0.25em; margin-bottom: 12px; font-weight: 600;">
                                Fixed Bid Price</div>
                            <div style="font-size: 36px; font-family: Cinzel, serif; color: white; font-weight: 600;">
                                $95,000</div>
                        </div>

                        <!-- Savings -->
                        <div
                            style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 8px; padding: 32px 24px; text-align: center;">
                            <div
                                style="font-size: 14px; color: #C8A951; text-transform: uppercase; letter-spacing: 0.2em; margin-bottom: 12px; font-weight: 500;">
                                Your Savings</div>
                            <div style="font-size: 32px; font-family: Cinzel, serif; color: #10b981; font-weight: 400;">
                                47%</div>
                            <div
                                style="font-size: 12px; color: white; text-transform: uppercase; letter-spacing: 0.15em; margin-top: 8px;">
                                Asset Leverage</div>
                        </div>

                        <!-- Timeline -->
                        <div
                            style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 8px; padding: 32px 24px; text-align: center;">
                            <div
                                style="font-size: 14px; color: #C8A951; text-transform: uppercase; letter-spacing: 0.2em; margin-bottom: 12px; font-weight: 500;">
                                Delivery</div>
                            <div style="font-size: 32px; font-family: Cinzel, serif; color: white; font-weight: 400;">
                                16 Weeks</div>
                            <div
                                style="font-size: 12px; color: white; text-transform: uppercase; letter-spacing: 0.15em; margin-top: 8px;">
                                Full Deployment</div>
                        </div>
                    </div>



                    <!-- 1. COMPARATIVE MARKET ANALYSIS -->
                    <div class="mb-20">
                        <div class="flex items-center gap-4 mb-8">
                            <div class="h-px bg-white/10 flex-1"></div>
                            <h2 class="text-3xl font-serif text-[#C8A951] uppercase tracking-widest">1.
                                Comparative
                                Market Analysis</h2>
                            <div class="h-px bg-white/10 flex-1"></div>
                        </div>

                        <!-- OPTION A: Market Analysis -->
                        <div id="market-analysis-a" style="max-width: 1000px; margin: 0 auto;">
                            <table id="market-analysis-table-a" style="width: 100%;">
                                <thead>
                                    <tr>
                                        <th>Metric</th>
                                        <th>FinalWishes Platform</th>
                                        <th>Typical Agency (Custom)</th>
                                        <th>Freelance Team</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Total Investment</td>
                                        <td class="u-text-emerald">$95,000 (Fixed)</td>
                                        <td>$180,000-$250,000</td>
                                        <td>$100,000-$150,000</td>
                                    </tr>
                                    <tr>
                                        <td>Platforms</td>
                                        <td class="u-text-gold">iOS + Android + Web</td>
                                        <td>iOS Only (Initial)</td>
                                        <td>Variable</td>
                                    </tr>
                                    <tr>
                                        <td>Time to Market</td>
                                        <td class="u-text-gold">16 Weeks</td>
                                        <td>24-36 Weeks</td>
                                        <td>20-30 Weeks</td>
                                    </tr>
                                    <tr>
                                        <td>IP Ownership</td>
                                        <td class="u-text-emerald">100% Client Owned</td>
                                        <td>Restrictive</td>
                                        <td>Risky</td>
                                    </tr>
                                    <tr>
                                        <td>AI Capability</td>
                                        <td class="u-text-gold">Gemini 3.0 Native</td>
                                        <td>Add-on Cost (High)</td>
                                        <td>Limited Expertise</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>


                    </div>

                    <!-- 2. ATOMIC DEVELOPMENT BREAKDOWN -->
                    <div style="margin-bottom: 80px;">
                        <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 32px;">
                            <div style="height: 1px; background: rgba(255,255,255,0.1); flex: 1;"></div>
                            <h2
                                style="font-size: 28px; font-family: Cinzel, serif; color: #C8A951; text-transform: uppercase; letter-spacing: 0.15em;">
                                2. Atomic Development Breakdown</h2>
                            <div style="height: 1px; background: rgba(255,255,255,0.1); flex: 1;"></div>
                        </div>

                        <!-- ========== OPTION A: WBS (925 hours, 6 phases) - hidden by default ========== -->
                        <div id="wbs-cost-a">
                            <div
                                style="width: 100%; text-align: center; display: flex; justify-content: center; margin-bottom: 48px;">
                                <p id="allocation-text" style="text-align: center !important; margin: 0;">
                                    Transparent allocation of <strong style="color: #C8A951;">480 engineering
                                        hours</strong>
                                    across 4 key phases.
                                </p>
                            </div>

                            <!-- Phases Container: Dynamically populated by updateAtomicBreakdown() -->
                            <div id="wbs-phases-container"
                                style="display: flex; flex-direction: column; gap: 24px; max-width: 900px; margin: 0 auto;">
                                <!-- Phases will be dynamically inserted here based on Core WBS + Selected Add-ons -->
                                <div style="text-align: center; padding: 48px; color: rgba(255,255,255,0.5);">
                                    <p>Loading development phases...</p>
                                </div>
                            </div>
                        </div>
                    </div> <!-- End wbs-cost-a -->


                    <!-- 3. DISCOUNT REALIZATION - SIMPLE CALCULATION BOX -->
                    <div style="margin-bottom: 96px;">
                        <h2
                            style="text-align: center; margin-bottom: 48px; font-size: 28px; font-family: Cinzel, serif; color: #C8A951; text-transform: uppercase; letter-spacing: 0.15em;">
                            3. Value Realization</h2>

                        <div id="discount-a"
                            style="max-width: 1000px; margin: 0 auto; background: rgba(255,255,255,0.03); border: 1px solid rgba(200,169,81,0.4); padding: 32px; border-radius: 8px;">

                            <!-- Row 1: Market Standard -->
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <span style="font-size: 20px; font-family: Inter, sans-serif; color: white;">US Agency
                                    (Cross-Platform)</span>
                                <span
                                    style="font-size: 24px; font-family: Cinzel, serif; color: #94a3b8; text-decoration: line-through;">$180,000</span>
                            </div>

                            <!-- Row 2: Google Stack Leverage -->
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0;">
                                <span style="font-size: 20px; font-family: Inter, sans-serif; color: white;">Google
                                    Stack
                                    Acceleration</span>
                                <span
                                    style="font-size: 24px; font-family: Cinzel, serif; color: #10b981;">−$60,000</span>
                            </div>

                            <!-- Row 3: Sirsi Component Library -->
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <span style="font-size: 20px; font-family: Inter, sans-serif; color: white;">Sirsi Value
                                    Components</span>
                                <span
                                    style="font-size: 24px; font-family: Cinzel, serif; color: #10b981;">−$25,000</span>
                            </div>

                            <!-- Row 4: Final Total -->
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; padding: 24px 0 12px 0;">
                                <span
                                    style="font-size: 20px; font-family: Inter, sans-serif; font-weight: 600; color: #C8A951;">Your
                                    Price</span>
                                <span
                                    style="font-size: 28px; font-family: Cinzel, serif; font-weight: 600; color: #C8A951;">$95,000</span>
                            </div>
                        </div>
                    </div>

                    <!-- 4. COMPREHENSIVE TECHNOLOGY & INFRASTRUCTURE BOM -->
                    <div style="margin-bottom: 96px;">
                        <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 32px;">
                            <div style="height: 1px; background: rgba(255,255,255,0.1); flex: 1;"></div>
                            <h2
                                style="font-size: 28px; font-family: Cinzel, serif; color: #C8A951; text-transform: uppercase; letter-spacing: 0.15em;">
                                4. Technology & Infrastructure Bill of Materials</h2>
                            <div style="height: 1px; background: rgba(255,255,255,0.1); flex: 1;"></div>
                        </div>

                        <p
                            style="text-align: center; color: rgba(255,255,255,0.7); margin-bottom: 32px; max-width: 800px; margin-left: auto; margin-right: auto;">
                            Complete inventory of all technologies, services, APIs, and integrations required for the
                            FinalWishes platform.
                            Client is responsible for ongoing operational expenses (OpEx) after deployment.
                        </p>

                        <!-- GOOGLE CLOUD PLATFORM -->
                        <div style="max-width: 1000px; margin: 0 auto 32px auto;">
                            <h3
                                style="color: #C8A951; font-family: Cinzel, serif; font-size: 18px; margin-bottom: 16px; padding-left: 16px; border-left: 3px solid #C8A951;">
                                Google Cloud Platform (GCP)
                            </h3>
                            <div
                                style="border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); overflow: hidden;">
                                <table
                                    style="width: 100%; text-align: left; border-collapse: collapse; font-size: 14px;">
                                    <thead>
                                        <tr
                                            style="background: rgba(0,0,0,0.2); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 25%;">
                                                Service</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 35%;">
                                                Purpose</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Est. Cost</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Billing Model</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Cloud Run
                                            </td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Serverless
                                                container hosting for Go backend API</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">$18-50/mo</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Per request +
                                                CPU/memory</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Cloud SQL
                                                (PostgreSQL)</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Managed
                                                relational database for PII and vault metadata</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">$9-25/mo</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Instance hours
                                                + storage</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Cloud
                                                Firestore</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">NoSQL database
                                                for real-time user data & session state</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free Tier</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Document
                                                reads/writes</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Cloud
                                                Storage</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Encrypted
                                                object storage for vault documents & media</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">$0.020/GB/mo</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Storage +
                                                egress</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Cloud KMS
                                            </td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Key management
                                                for vault encryption (AES-256)</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">$0.06/key/mo</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Active keys +
                                                operations</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Secret
                                                Manager</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Secure storage
                                                for API keys & credentials</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free Tier</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Secret
                                                versions</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Cloud CDN
                                            </td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Global content
                                                delivery for static assets</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">$0.02/GB</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Cache egress
                                            </td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Cloud Load
                                                Balancing</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">HTTPS load
                                                balancer with SSL termination</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">$18/mo</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Forwarding
                                                rules + data</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Cloud
                                                Logging</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Centralized
                                                application & audit logging</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free Tier (50GB)</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Ingested
                                                volume</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Cloud
                                                Monitoring</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Performance
                                                metrics, alerts, uptime checks</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free Tier</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Metric volume
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- FIREBASE SERVICES -->
                        <div style="max-width: 1000px; margin: 0 auto 32px auto;">
                            <h3
                                style="color: #C8A951; font-family: Cinzel, serif; font-size: 18px; margin-bottom: 16px; padding-left: 16px; border-left: 3px solid #C8A951;">
                                Firebase Services
                            </h3>
                            <div
                                style="border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); overflow: hidden;">
                                <table
                                    style="width: 100%; text-align: left; border-collapse: collapse; font-size: 14px;">
                                    <thead>
                                        <tr
                                            style="background: rgba(0,0,0,0.2); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 25%;">
                                                Service</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 35%;">
                                                Purpose</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Est. Cost</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Billing Model</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Firebase
                                                Authentication</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">User auth with
                                                TOTP MFA, email/password, social login</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free (50K MAU)</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Monthly active
                                                users</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Firebase
                                                Hosting</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Static web app
                                                hosting with global CDN</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free Tier (10GB)</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Storage +
                                                bandwidth</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Cloud
                                                Messaging (FCM)</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Push
                                                notifications to iOS, Android, Web</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Unlimited</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Firebase
                                                Analytics</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">User behavior
                                                tracking and conversion metrics</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Unlimited
                                                events</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- AI & ML SERVICES -->
                        <div style="max-width: 1000px; margin: 0 auto 32px auto;">
                            <h3
                                style="color: #C8A951; font-family: Cinzel, serif; font-size: 18px; margin-bottom: 16px; padding-left: 16px; border-left: 3px solid #C8A951;">
                                AI & Machine Learning
                            </h3>
                            <div
                                style="border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); overflow: hidden;">
                                <table
                                    style="width: 100%; text-align: left; border-collapse: collapse; font-size: 14px;">
                                    <thead>
                                        <tr
                                            style="background: rgba(0,0,0,0.2); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 25%;">
                                                Service</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 35%;">
                                                Purpose</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Est. Cost</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Billing Model</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Vertex AI
                                                (Gemini 2.0)</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">"The Shepherd"
                                                AI guidance engine for obituary drafting</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">$0.00025/1K chars</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Input/output
                                                tokens</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Cloud Vision
                                                API</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Document text
                                                extraction, image analysis</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">$1.50/1K images</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Per API call
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- THIRD-PARTY APIS & INTEGRATIONS -->
                        <div style="max-width: 1000px; margin: 0 auto 32px auto;">
                            <h3
                                style="color: #C8A951; font-family: Cinzel, serif; font-size: 18px; margin-bottom: 16px; padding-left: 16px; border-left: 3px solid #C8A951;">
                                Third-Party APIs & Integrations
                            </h3>
                            <div
                                style="border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); overflow: hidden;">
                                <table
                                    style="width: 100%; text-align: left; border-collapse: collapse; font-size: 14px;">
                                    <thead>
                                        <tr
                                            style="background: rgba(0,0,0,0.2); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 25%;">
                                                Service</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 35%;">
                                                Purpose</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Est. Cost</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Billing Model</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">OpenSign
                                                (Self-Hosted)</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Electronic
                                                document signing (deployed on Cloud Run)</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">~$20/mo hosting</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Compute +
                                                storage</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Google
                                                Photos API</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Photo album
                                                import and memorial gallery</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">API quota
                                                limits</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">YouTube Data
                                                API v3</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Video memorial
                                                hosting and unlisted uploads</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">API quota
                                                limits</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">SendGrid
                                            </td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Transactional
                                                email delivery (notifications, receipts)</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free (100/day)</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Email volume
                                            </td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Stripe</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Payment
                                                processing, subscriptions, invoicing</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">2.9% + $0.30</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Per
                                                transaction</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Apple
                                                Developer Program</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">iOS App Store
                                                distribution</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">$99/year</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Annual
                                                membership</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- OPEN SOURCE TECHNOLOGIES -->
                        <div style="max-width: 1000px; margin: 0 auto 32px auto;">
                            <h3
                                style="color: #C8A951; font-family: Cinzel, serif; font-size: 18px; margin-bottom: 16px; padding-left: 16px; border-left: 3px solid #C8A951;">
                                Open Source Technologies (No License Cost)
                            </h3>
                            <div
                                style="border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); overflow: hidden;">
                                <table
                                    style="width: 100%; text-align: left; border-collapse: collapse; font-size: 14px;">
                                    <thead>
                                        <tr
                                            style="background: rgba(0,0,0,0.2); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Technology</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 15%;">
                                                Version</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 40%;">
                                                Purpose</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 25%;">
                                                License</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Go (Golang)
                                            </td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">1.22+</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Backend API
                                                server</td>
                                            <td style="padding: 12px 16px; color: #10b981;">BSD 3-Clause</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Chi Router
                                            </td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">v5</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">HTTP routing
                                                and middleware</td>
                                            <td style="padding: 12px 16px; color: #10b981;">MIT</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">React</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">18.x</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Web
                                                application framework</td>
                                            <td style="padding: 12px 16px; color: #10b981;">MIT</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Vite</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">5.x</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Web build tool
                                                and dev server</td>
                                            <td style="padding: 12px 16px; color: #10b981;">MIT</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">React Native
                                            </td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">0.73+</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Cross-platform
                                                mobile framework</td>
                                            <td style="padding: 12px 16px; color: #10b981;">MIT</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Expo</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">SDK 50+</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Mobile
                                                development toolchain</td>
                                            <td style="padding: 12px 16px; color: #10b981;">MIT</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">TailwindCSS
                                            </td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">3.x</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Utility-first
                                                CSS framework</td>
                                            <td style="padding: 12px 16px; color: #10b981;">MIT</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Zustand</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">4.x</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">State
                                                management for React</td>
                                            <td style="padding: 12px 16px; color: #10b981;">MIT</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Playwright
                                            </td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Latest</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">End-to-end
                                                testing framework</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Apache 2.0</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">OpenSign
                                            </td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Community</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Electronic
                                                signature solution</td>
                                            <td style="padding: 12px 16px; color: #10b981;">AGPL-3.0</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">PostgreSQL
                                            </td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">15+</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Relational
                                                database (via Cloud SQL)</td>
                                            <td style="padding: 12px 16px; color: #10b981;">PostgreSQL License</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- DEVELOPMENT & CI/CD TOOLS -->
                        <div style="max-width: 1000px; margin: 0 auto 32px auto;">
                            <h3
                                style="color: #C8A951; font-family: Cinzel, serif; font-size: 18px; margin-bottom: 16px; padding-left: 16px; border-left: 3px solid #C8A951;">
                                Development & CI/CD Tools
                            </h3>
                            <div
                                style="border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); overflow: hidden;">
                                <table
                                    style="width: 100%; text-align: left; border-collapse: collapse; font-size: 14px;">
                                    <thead>
                                        <tr
                                            style="background: rgba(0,0,0,0.2); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 25%;">
                                                Tool</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 35%;">
                                                Purpose</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Est. Cost</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Billing Model</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">GitHub</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Source
                                                control, issue tracking, code review</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free (Team)</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Per seat</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">GitHub
                                                Actions</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">CI/CD pipeline
                                                automation</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free (2K min/mo)</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Compute
                                                minutes</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Cloud Build
                                            </td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Container
                                                image builds for Cloud Run</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free (120 min/day)</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Build minutes
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Artifact
                                                Registry</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Docker
                                                container image storage</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">$0.10/GB</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Storage +
                                                egress</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- DOMAIN & SSL -->
                        <div style="max-width: 1000px; margin: 0 auto 32px auto;">
                            <h3
                                style="color: #C8A951; font-family: Cinzel, serif; font-size: 18px; margin-bottom: 16px; padding-left: 16px; border-left: 3px solid #C8A951;">
                                Domain & SSL
                            </h3>
                            <div
                                style="border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); overflow: hidden;">
                                <table
                                    style="width: 100%; text-align: left; border-collapse: collapse; font-size: 14px;">
                                    <thead>
                                        <tr
                                            style="background: rgba(0,0,0,0.2); border-bottom: 1px solid rgba(255,255,255,0.1);">
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 25%;">
                                                Service</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 35%;">
                                                Purpose</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Est. Cost</th>
                                            <th
                                                style="padding: 12px 16px; font-weight: 600; color: #C8A951; width: 20%;">
                                                Billing Model</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">Domain
                                                Registration</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">
                                                finalwishes.com (or similar)</td>
                                            <td style="padding: 12px 16px; color: #C8A951;">$12-50/year</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Annual</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 12px 16px; color: white; font-weight: 500;">SSL
                                                Certificates</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.8);">Google-managed
                                                SSL (automatic)</td>
                                            <td style="padding: 12px 16px; color: #10b981;">Free</td>
                                            <td style="padding: 12px 16px; color: rgba(255,255,255,0.7);">Included with
                                                LB</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- TOTAL ESTIMATED OPEX -->
                        <div style="max-width: 1000px; margin: 0 auto;">
                            <div
                                style="background: rgba(200,169,81,0.1); border: 2px solid #C8A951; border-radius: 12px; padding: 24px 32px;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
                                    <div>
                                        <h3
                                            style="color: #C8A951; font-family: Cinzel, serif; font-size: 20px; margin: 0; text-transform: uppercase; letter-spacing: 0.1em;">
                                            Estimated Monthly OpEx</h3>
                                        <p style="color: rgba(255,255,255,0.7); font-size: 14px; margin: 4px 0 0 0;">
                                            Baseline infrastructure costs (variable with usage)</p>
                                    </div>
                                    <div style="text-align: right;">
                                        <div
                                            style="font-size: 32px; font-weight: bold; color: #C8A951; font-family: Cinzel, serif;">
                                            $75 - $150/mo</div>
                                        <div style="font-size: 14px; color: rgba(255,255,255,0.7);">
                                            + Optional: Sirsi Maintenance $1,500/mo</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 5. PARTNERSHIP PLANS - PAYMENT SCHEDULES (2/3/4 Payments) -->
                    <div style="margin-top: 96px; padding-top: 48px; border-top: 1px solid rgba(200,169,81,0.3);">
                        <h2
                            style="text-align: center; margin-bottom: 64px; font-size: 28px; font-family: Cinzel, serif; color: #C8A951; text-transform: uppercase; letter-spacing: 0.15em;">
                            5. Payment Schedule Options</h2>

                        <!-- ========== PAYMENT PLANS ========== -->
                        <div id="payment-plans" style="display: block;">

                            <!-- Header -->
                            <div style="text-align: center; margin-bottom: 32px;">
                                <span
                                    style="background: linear-gradient(to right, #C8A951, #E2C76B); color: #000; font-size: 12px; font-weight: 700; padding: 6px 16px; border-radius: 20px; text-transform: uppercase; letter-spacing: 0.1em;">
                                    Unified Platform</span>
                                <p style="color: rgba(255,255,255,0.7); font-size: 16px; margin-top: 12px;">Total
                                    Project Value: <strong id="payment-total-display"
                                        style="color: #C8A951;">$95,000</strong></p>
                            </div>

                            <div
                                style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; max-width: 1200px; margin: 0 auto;">

                                <!-- PLAN 1: 2 Payments -->
                                <div id="plan-1-card" class="plan-card-static"
                                    style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.15); padding: 2rem; text-align: center; display: flex; flex-direction: column; border-radius: 8px;">
                                    <h3
                                        style="font-size: 24px; font-family: Cinzel, serif; color: white; margin-bottom: 0.5rem;">
                                        Plan 1</h3>
                                    <p style="font-size: 14px; color: #C8A951; margin-bottom: 1.5rem;">2 Payments</p>

                                    <div
                                        style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-bottom: 1.5rem; flex-grow: 1;">
                                        <div style="margin-bottom: 1rem;">
                                            <div id="plan-1-amount"
                                                style="font-size: 32px; font-family: Cinzel, serif; color: #C8A951;">
                                                $47,500</div>
                                            <div style="font-size: 14px; color: white;">per payment × 2</div>
                                        </div>
                                        <div
                                            style="font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 1rem; text-align: left; padding: 0 16px;">
                                            <div
                                                style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                                <span>• 50% at signing</span>
                                                <span id="plan-1-p1">$47,500</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between;">
                                                <span>• 50% at delivery (Week 16)</span>
                                                <span id="plan-1-p2">$47,500</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div
                                        style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-top: auto;">
                                        <div style="font-size: 16px; color: white; margin-bottom: 0.5rem;">Total
                                        </div>
                                        <div id="plan-1-total"
                                            style="font-size: 20px; font-family: Cinzel, serif; color: white; font-weight: 600; margin-bottom: 1.5rem;">
                                            $95,000</div>
                                        <button onclick="selectPlanFromCost('Unified Plan 1', this)"
                                            class="select-plan-btn"
                                            style="width: 100%; padding: 14px 24px; background: linear-gradient(to right, #C8A951, #E2C76B); color: #000; font-weight: 700; font-size: 12px; text-transform: uppercase; letter-spacing: 0.15em; border: none; border-radius: 4px; cursor: pointer; transition: all 0.3s ease;">
                                            Select Plan
                                        </button>
                                    </div>
                                </div>

                                <!-- PLAN 2: 3 Payments (RECOMMENDED) -->
                                <div id="plan-2-card" class="plan-card-static"
                                    style="background: rgba(200,169,81,0.1); border: 2px solid #C8A951; padding: 2rem; text-align: center; display: flex; flex-direction: column; position: relative; transform: scale(1.02); box-shadow: 0 0 40px rgba(200,169,81,0.2); border-radius: 8px;">
                                    <div
                                        style="position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; font-size: 10px; font-weight: 700; padding: 4px 12px; border-radius: 20px; text-transform: uppercase;">
                                        Recommended</div>
                                    <h3
                                        style="font-size: 24px; font-family: Cinzel, serif; color: white; margin-bottom: 0.5rem;">
                                        Plan 2</h3>
                                    <p style="font-size: 14px; color: #C8A951; margin-bottom: 1.5rem;">3 Payments</p>

                                    <div
                                        style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-bottom: 1.5rem; flex-grow: 1;">
                                        <div style="margin-bottom: 1rem;">
                                            <div id="plan-2-amount"
                                                style="font-size: 32px; font-family: Cinzel, serif; color: #C8A951;">
                                                $31,667</div>
                                            <div style="font-size: 14px; color: white;">per payment × 3</div>
                                        </div>
                                        <div
                                            style="font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 1rem; text-align: left; padding: 0 16px;">
                                            <div
                                                style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                                <span>• Payment 1 at signing</span>
                                                <span id="plan-2-p1">$31,667</span>
                                            </div>
                                            <div
                                                style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                                <span>• Payment 2 (Week 8)</span>
                                                <span id="plan-2-p2">$31,667</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between;">
                                                <span>• Payment 3 at delivery (Week 16)</span>
                                                <span id="plan-2-p3">$31,666</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div
                                        style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-top: auto;">
                                        <div style="font-size: 16px; color: white; margin-bottom: 0.5rem;">Total
                                        </div>
                                        <div id="plan-2-total"
                                            style="font-size: 20px; font-family: Cinzel, serif; color: white; font-weight: 600; margin-bottom: 1.5rem;">
                                            $95,000</div>
                                        <button onclick="selectPlanFromCost('Unified Plan 2', this)"
                                            class="select-plan-btn"
                                            style="width: 100%; padding: 14px 24px; background: linear-gradient(to right, #C8A951, #E2C76B); color: #000; font-weight: 700; font-size: 12px; text-transform: uppercase; letter-spacing: 0.15em; border: none; border-radius: 4px; cursor: pointer; transition: all 0.3s ease;">
                                            Select Plan
                                        </button>
                                    </div>
                                </div>

                                <!-- PLAN 3: 4 Payments -->
                                <div id="plan-3-card" class="plan-card-static"
                                    style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.15); padding: 2rem; text-align: center; display: flex; flex-direction: column; border-radius: 8px;">
                                    <h3
                                        style="font-size: 24px; font-family: Cinzel, serif; color: white; margin-bottom: 0.5rem;">
                                        Plan 3</h3>
                                    <p style="font-size: 14px; color: #C8A951; margin-bottom: 1.5rem;">4 Payments</p>

                                    <div
                                        style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-bottom: 1.5rem; flex-grow: 1;">
                                        <div style="margin-bottom: 1rem;">
                                            <div id="plan-3-amount"
                                                style="font-size: 32px; font-family: Cinzel, serif; color: #C8A951;">
                                                $23,750</div>
                                            <div style="font-size: 14px; color: white;">per payment × 4</div>
                                        </div>
                                        <div
                                            style="font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 1rem; text-align: left; padding: 0 16px;">
                                            <div
                                                style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                                <span>• Payment 1 at signing</span>
                                                <span id="plan-3-p1">$23,750</span>
                                            </div>
                                            <div
                                                style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                                <span>• Payment 2 (Week 4)</span>
                                                <span id="plan-3-p2">$23,750</span>
                                            </div>
                                            <div
                                                style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                                <span>• Payment 3 (Week 8)</span>
                                                <span id="plan-3-p3">$23,750</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between;">
                                                <span>• Payment 4 at delivery (Week 16)</span>
                                                <span id="plan-3-p4">$23,750</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div
                                        style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem; margin-top: auto;">
                                        <div style="font-size: 16px; color: white; margin-bottom: 0.5rem;">Total
                                        </div>
                                        <div id="plan-3-total"
                                            style="font-size: 20px; font-family: Cinzel, serif; color: white; font-weight: 600; margin-bottom: 1.5rem;">
                                            $95,000</div>
                                        <button onclick="selectPlanFromCost('Unified Plan 3', this)"
                                            class="select-plan-btn"
                                            style="width: 100%; padding: 14px 24px; background: linear-gradient(to right, #C8A951, #E2C76B); color: #000; font-weight: 700; font-size: 12px; text-transform: uppercase; letter-spacing: 0.15em; border: none; border-radius: 4px; cursor: pointer; transition: all 0.3s ease;">
                                            Select Plan
                                        </button>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <!-- NEXT BUTTON (COST -> CONTRACT) -->
                    <div class="w-full mt-16 mb-12 relative z-10"
                        style="display: flex; justify-content: flex-end; grid-column: 1 / -1;">
                        <button onclick="switchTab('contract')"
                            class="group relative inline-flex items-center justify-center gap-3 h-11 px-6 overflow-hidden bg-gradient-to-r from-[#D4AF37] to-[#C8A951] text-[#050b14] shadow-[0_4px_20px_rgba(200,169,81,0.4)] hover:shadow-[0_0_40px_rgba(200,169,81,0.8)] transition-all duration-500 ease-out border border-[#C8A951] rounded-sm">

                            <!-- TEXT -->
                            <span class="relative z-10 font-serif font-bold text-sm tracking-[0.15em] uppercase">
                                Next
                            </span>

                            <!-- ICON (Elegant Arrow) -->
                            <svg class="w-4 h-4 relative z-10 transform group-hover:translate-x-1 transition-transform duration-300"
                                fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3">
                                </path>
                            </svg>
                        </button>
                    </div>
                </div>


                <!-- TAB 3: CONTRACT -->
                <div id="contract" class="tab-content" style="position: relative;">
                    <div id="step-1-label" class="text-center mb-8 transition-opacity duration-700">
                        <h2 class="font-serif text-2xl text-[#C8A951] uppercase tracking-widest">
                            Step 2: Review Master Services Agreement</h2>
                        <p class="text-sm text-white/60 mt-2">Scroll through and read the entire agreement
                            before
                            proceeding.</p>
                    </div>

                    <!-- Download PDF Button -->
                    <div class="text-right mb-4 no-print">
                        <button onclick="downloadMSAPDF()" class="download-btn-neo" id="btn-download-msa">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            Download as PDF
                        </button>
                    </div>

                    <div class="legal-scroll-box" id="legal-scroll-container">
                        <div class="legal-viewer transition-opacity duration-700" id="contract-document">
                            <!-- MSA HEADER -->
                            <div class="text-center mb-12 pb-12 border-b border-gray-200">
                                <h2>MASTER SERVICES AGREEMENT</h2>
                                <p class="text-center opacity-60">Global Effective Date: <span
                                        id="date-msa-global"></span>
                                </p>
                            </div>

                            <div class="mb-12 p-8 bg-white/5 border border-white/10 rounded-lg">
                                <p class="mb-4 italic opacity-80">This <strong>Master Services
                                        Agreement</strong>
                                    (this
                                    "Agreement") is entered into as of <span id="date-msa-effective"></span>
                                    (the
                                    "Effective
                                    Date") by and
                                    between:</p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                    <div class="p-4 bg-white/5 rounded border border-white/5">
                                        <h4 class="text-[#C8A951] font-serif mb-2 underline tracking-wider">
                                            CLIENT
                                        </h4>
                                        <p><strong class="company-name-insert">FinalWishes Inc.</strong><br>
                                            Principal: [Principal Name]<br>
                                            [Address Code: Pending Verification]<br>
                                            ("Client")</p>
                                    </div>
                                    <div class="p-4 bg-white/5 rounded border border-white/5">
                                        <h4 class="text-[#C8A951] font-serif mb-2 underline tracking-wider">
                                            PROVIDER
                                        </h4>
                                        <p><strong>Sirsi Technologies, Inc.</strong><br>
                                            FEIN: 93-1696269<br>
                                            909 Rose Avenue, Suite 400<br>
                                            North Bethesda, MD 20852<br>
                                            ("Provider")</p>
                                    </div>
                                </div>
                            </div>

                            <!-- ROBUST MSA CONTENT (100% COMPLETE - NO OMISSIONS) -->
                            <div class="space-y-12">
                                <section>
                                    <h2>1. RECITALS</h2>
                                    <p><strong>WHEREAS</strong>, Client desires to engage Provider to design,
                                        develop,
                                        and implement a comprehensive legacy curation software platform known
                                        as
                                        <strong class="project-name-insert">FinalWishes</strong> (the "Platform");
                                    </p>
                                    <p><strong>WHEREAS</strong>, Provider (Sirsi Technologies, Inc) possesses
                                        the
                                        requisite technical expertise, personnel, and infrastructure, including
                                        expertise in artificial intelligence, cloud architecture, and secure
                                        software
                                        development, to perform the Services;</p>
                                    <p><strong>WHEREAS</strong>, the Parties wish to set forth the terms and
                                        conditions
                                        under which Provider will provide such Services to Client.</p>
                                    <p><strong>NOW, THEREFORE</strong>, in consideration of the mutual covenants
                                        contained herein, and for other good and valuable consideration, the
                                        receipt
                                        and
                                        sufficiency of which are hereby acknowledged, the Parties agree as
                                        follows:
                                    </p>
                                </section>

                                <section>
                                    <h2>2. DEFINITIONS</h2>
                                    <p>For purposes of this Agreement, the following terms shall have the
                                        meanings
                                        set
                                        forth below:</p>
                                    <ul>
                                        <li><strong>"Affiliate"</strong> means any entity that directly or
                                            indirectly
                                            controls, is controlled by, or is under common control with a Party,
                                            where
                                            "control" means ownership of more than fifty percent (50%) of the
                                            voting
                                            stock or other ownership interest.</li>
                                        <li><strong>"Background Technology"</strong> means all software, code,
                                            tools,
                                            libraries, frameworks, know-how, methodologies, and Intellectual
                                            Property
                                            Rights owned or licensed by Provider prior to the Effective Date or
                                            developed independently of the Services (including, without
                                            limitation,
                                            Provider’s "Sirsi" component library, "Gemini" guidance patterns,
                                            and
                                            standard deployment scripts).</li>
                                        <li><strong>"Confidential Information"</strong> means any non-public
                                            information
                                            disclosed by one Party (the "Disclosing Party") to the other Party
                                            (the
                                            "Receiving Party") that is designated as confidential or that, given
                                            the
                                            nature of the information or circumstances of disclosure, reasonably
                                            should
                                            be understood to be confidential.</li>
                                        <li><strong>"Deliverables"</strong> means all documents, work product,
                                            code,
                                            software, reports, and other materials that are specifically created
                                            for
                                            and
                                            delivered to Client by Provider pursuant to a Statement of Work.
                                        </li>
                                        <li><strong>"Intellectual Property Rights"</strong> means all patent
                                            rights,
                                            copyright rights, mask work rights, moral rights, rights of
                                            publicity,
                                            trademark, trade dress and service mark rights, goodwill, trade
                                            secret
                                            rights and other intellectual property rights as may now exist or
                                            hereafter
                                            come into existence, and all applications therefore and
                                            registrations,
                                            renewals and extensions thereof, under the laws of any state,
                                            country,
                                            territory or other jurisdiction.</li>
                                        <li><strong>"Services"</strong> means the professional software
                                            development,
                                            consulting, and design services to be performed by Provider as
                                            described
                                            in
                                            a Statement of Work.</li>
                                        <li><strong>"Statement of Work" or "SOW"</strong> means a document
                                            describing
                                            the specific Services to be performed, Deliverables to be provided,
                                            fees
                                            to
                                            be paid, and timeline for performance, which is agreed upon and
                                            signed
                                            by
                                            authorized representatives of both Parties. Each SOW shall be
                                            substantially
                                            in the form of Exhibit A.</li>
                                    </ul>
                                </section>

                                <section>
                                    <h2>3. SERVICES AND ENGAGEMENT</h2>
                                    <p><strong>3.1 Statements of Work.</strong> Provider shall provide the
                                        Services
                                        and
                                        Deliverables to Client as specified in each SOW. Each SOW shall be
                                        effectively
                                        incorporated into this Agreement. In the event of a conflict between the
                                        terms
                                        of this Agreement and an SOW, the terms of the SOW shall control ONLY
                                        regarding
                                        the specific description of Services, fees, and timeline; for all other
                                        legal
                                        terms and conditions, this Agreement shall control.</p>
                                    <p><strong>3.2 Standard of Performance.</strong> Provider represents and
                                        warrants
                                        that the Services will be performed in a professional, workmanlike
                                        manner,
                                        by
                                        qualified personnel, and consistent with the highest industry standards
                                        for
                                        similar enterprise-grade software development services. Provider shall
                                        devote
                                        adequate resources to meet its obligations under this Agreement.</p>
                                    <p><strong>3.3 Change Orders.</strong> Client may, at any time, request
                                        changes
                                        to
                                        the scope of the Services ("Change Request"). If Provider determines
                                        that
                                        such
                                        changes will impact the fees, timeline, or technical architecture,
                                        Provider
                                        shall submit a written "Change Order" detailing the impact. No change
                                        shall
                                        be
                                        effective until the Change Order is signed by both Parties. Minor
                                        changes
                                        requiring less than eight (8) hours of effort may be approved via
                                        written
                                        correspondence (email sufficient).</p>
                                    <p><strong>3.4 Non-Exclusivity.</strong> Client acknowledges that Provider
                                        is a
                                        professional services firm and may provide similar services to third
                                        parties,
                                        provided that Provider does not use Client’s Confidential Information or
                                        specifically commissioned Deliverables for such third parties.</p>
                                </section>

                                <section>
                                    <h2>4. COMPENSATION AND PAYMENT</h2>
                                    <p><strong>4.1 Fees.</strong> Client shall pay Provider the fees set forth
                                        in
                                        the
                                        applicable SOW. Unless otherwise specified in an SOW, fees for
                                        fixed-price
                                        projects shall be payable according to the agreed-upon milestone
                                        schedule.
                                    </p>
                                    <p><strong>4.2 Expenses.</strong> Client shall reimburse Provider for
                                        reasonable,
                                        documented "Pass-Through Expenses" incurred in connection with the
                                        Services
                                        (e.g., specific cloud infrastructure costs, third-party API licensing
                                        fees,
                                        software licenses specifically required for the Project). Provider shall
                                        obtain
                                        Client’s prior written approval for any individual expense exceeding
                                        Five
                                        Hundred Dollars ($500.00). Travel expenses shall only be reimbursable if
                                        pre-approved by Client in writing.</p>
                                    <p><strong>4.3 Payment Terms.</strong> Provider shall submit invoices to
                                        Client
                                        upon
                                        completion of Milestones or monthly for Time & Materials engagements.
                                        Invoices
                                        are due and payable <strong>Net Fifteen (15)</strong> days from the
                                        invoice
                                        date.</p>
                                    <p><strong>4.4 Late Payments.</strong> Undisputed payments not received by
                                        the
                                        due
                                        date shall accrue interest at the lesser of one and one-half percent
                                        (1.5%)
                                        per
                                        month or the maximum rate permitted by law.</p>
                                    <p><strong>4.5 Taxes.</strong> Fees do not include any sales, use,
                                        value-added,
                                        or
                                        similar taxes. Client shall be responsible for paying all such taxes
                                        properly
                                        levied on the Services, excluding taxes based on Provider’s net income,
                                        property, or employees.</p>
                                </section>

                                <section>
                                    <h2>5. INTELLECTUAL PROPERTY RIGHTS</h2>
                                    <p><strong>5.1 Work Made for Hire.</strong> Provider agrees that all
                                        Deliverables
                                        created for Client under this Agreement shall be considered "works made
                                        for
                                        hire" to the extent permitted by law. To the extent that any Deliverable
                                        does
                                        not qualify as a work made for hire under applicable law, Provider
                                        hereby
                                        irrevocably assigns to Client all right, title, and interest in and to
                                        such
                                        Deliverable, including all Intellectual Property Rights therein, free
                                        and
                                        clear
                                        of all liens and encumbrances.</p>
                                    <p><strong>5.2 Background Technology.</strong> Notwithstanding Section 5.1,
                                        Provider
                                        retains all right, title, and interest in and to its Background
                                        Technology.
                                        Provider hereby grants to Client a perpetual, irrevocable,
                                        non-exclusive,
                                        royalty-free, fully paid-up, worldwide, sublicensable license to use,
                                        reproduce,
                                        modify, display, distribute, and create derivative works of any
                                        Background
                                        Technology incorporated into the Deliverables, solely as necessary for
                                        Client to
                                        utilize, exploit, and maintain the Deliverables for their intended
                                        purpose.
                                    </p>
                                    <p><strong>5.3 Third-Party and Open Source Software.</strong> The
                                        Deliverables
                                        may
                                        contain third-party software or open source software. Provider warrants
                                        that
                                        its
                                        use of such software will comply with the applicable licenses (e.g.,
                                        AGPL-3.0,
                                        MIT, Apache 2.0). Provider shall identify any "Copyleft" libraries (that
                                        would
                                        mandate disclosure of Client’s source code) prior to integration and
                                        obtain
                                        Client’s approval.</p>
                                    <p><strong>5.4 AI-Generated Content.</strong> The Parties acknowledge that
                                        Provider
                                        utilizes advanced Artificial Intelligence tools (e.g., Google Gemini,
                                        Anthropic
                                        Claude) to assist in code generation and architecture. Provider warrants
                                        that it
                                        has the full legal right to assign ownership of such AI-generated output
                                        to
                                        Client as part of the Deliverables, and that such use does not violate
                                        the
                                        terms
                                        of service of the AI providers.</p>
                                    <p><strong>5.5 Further Assurances.</strong> Provider agrees to execute any
                                        documents
                                        and take any actions reasonably requested by Client to perfect Client’s
                                        ownership of the Intellectual Property Rights in the Deliverables.</p>
                                </section>

                                <section>
                                    <h2>6. CONFIDENTIALITY</h2>
                                    <p><strong>6.1 Obligations.</strong> The Receiving Party agrees: (i) to hold
                                        the
                                        Disclosing Party’s Confidential Information in strict confidence and
                                        take
                                        reasonable precautions to protect it (including all precautions the
                                        Receiving
                                        Party employs with respect to its own confidential materials); (ii) not
                                        to
                                        divulge any such Confidential Information to any third party (other than
                                        employees, contractors, or agents who have a need to know and are bound
                                        by
                                        written confidentiality obligations); and (iii) not to use such
                                        Confidential
                                        Information except for the performance of this Agreement.</p>
                                    <p><strong>6.2 Exclusions.</strong> Confidential Information shall not
                                        include
                                        information that: (a) is or becomes generally available to the public
                                        without
                                        breach of this Agreement; (b) was in the Receiving Party’s possession
                                        prior
                                        to
                                        disclosure without legal restriction; (c) is captured by the Receiving
                                        Party
                                        from a third party who had the legal right to disclose it; or (d) is
                                        independently developed by the Receiving Party without reference to or
                                        use
                                        of
                                        the Confidential Information.</p>
                                    <p><strong>6.3 Data Security & SOC 2 Compliance.</strong> Provider
                                        acknowledges
                                        that
                                        it may have access to Client’s data, which may include Personally
                                        Identifiable
                                        Information (PII). Provider agrees to implement and maintain
                                        commercially
                                        reasonable technical and organizational security measures—consistent
                                        with
                                        SOC 2
                                        Type II criteria—to protect such data from unauthorized access, use,
                                        modification, or disclosure. This includes, but is not limited to,
                                        encryption of
                                        data at rest and in transit, access controls, and regular security
                                        audits.
                                    </p>
                                    <p><strong>6.4 Compelled Disclosure.</strong> If the Receiving Party is
                                        required
                                        by
                                        law or court order to disclose Confidential Information, it shall give
                                        the
                                        Disclosing Party prompt written notice (if legally permitted) to allow
                                        the
                                        Disclosing Party to seek a protective order.</p>
                                </section>

                                <section>
                                    <h2>7. WARRANTIES AND COVENANTS</h2>
                                    <p><strong>7.1 Provider Warranties.</strong> Provider represents and
                                        warrants
                                        that:<br>(a) <strong>Non-Infringement:</strong> The Deliverables will be
                                        original and will not infringe, misappropriate, or violate any patent,
                                        copyright, trademark, trade secret, or other proprietary right of any
                                        third
                                        party.<br>(b) <strong>Compliance with Laws:</strong> The Services will
                                        be
                                        performed in compliance with all applicable federal, state, and local
                                        laws
                                        and
                                        regulations.<br>(c) <strong>Malicious Code:</strong> Provider will use
                                        industry-standard measures to ensure the Deliverables do not contain any
                                        viruses, malware, trojan horses, time bombs, or other harmful code.</p>
                                    <p><strong>7.2 Performance Warranty (60-Day Bug Fix Guarantee).</strong>
                                        Provider
                                        warrants that, for a period of <strong>sixty (60) days</strong>
                                        following
                                        Client’s Acceptance of the Deliverables (the "Warranty Period"), the
                                        Deliverables will function materially in accordance with the
                                        specifications
                                        set
                                        forth in the SOW. If the Deliverables fail to meet this warranty,
                                        Provider
                                        shall, at its sole expense and as Client’s exclusive remedy for breach
                                        of
                                        this
                                        warranty, promptly correct the non-conformity.</p>
                                    <p><strong>7.3 Disclaimer.</strong> EXCEPT AS EXPRESSLY SET FORTH IN THIS
                                        AGREEMENT,
                                        PROVIDER MAKES NO OTHER WARRANTIES, EXPRESS OR IMPLIED, AND HEREBY
                                        DISCLAIMS
                                        ALL
                                        IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,
                                        AND
                                        NON-INFRINGEMENT.</p>
                                </section>

                                <section>
                                    <h2>8. INDEMNIFICATION</h2>
                                    <p><strong>8.1 By Provider.</strong> Provider shall indemnify, defend, and
                                        hold
                                        harmless Client and its officers, directors, employees, and agents from
                                        and
                                        against any and all losses, damages, liabilities, costs, and expenses
                                        (including
                                        reasonable attorneys’ fees) arising out of or resulting from any
                                        third-party
                                        claim alleging that the Deliverables or Services infringe or
                                        misappropriate
                                        any
                                        U.S. copyright, trademark, or trade secret.</p>
                                    <p><strong>8.2 By Client.</strong> Client shall indemnify, defend, and hold
                                        harmless
                                        Provider from and against any and all losses, damages, liabilities,
                                        costs,
                                        and
                                        expenses arising out of or resulting from: (i) Client’s specific
                                        specifications
                                        or instructions that compelled the infringement; or (ii) content or data
                                        provided by Client to Provider.</p>
                                    <p><strong>8.3 Procedure.</strong> The indemnified party shall: (a) promptly
                                        notify
                                        the indemnifying party in writing of the claim; (b) allow the
                                        indemnifying
                                        party
                                        sole control of the defense and settlement of the claim; and (c) provide
                                        reasonable assistance to the indemnifying party.</p>
                                </section>

                                <section>
                                    <h2>9. LIMITATION OF LIABILITY</h2>
                                    <p><strong>9.1 Exclusion of Consequential Damages.</strong> EXCEPT FOR
                                        BREACHES
                                        OF
                                        CONFIDENTIALITY (SECTION 6) OR INDEMNIFICATION OBLIGATIONS (SECTION 8),
                                        IN
                                        NO
                                        EVENT SHALL EITHER PARTY BE LIABLE TO THE OTHER FOR ANY INDIRECT,
                                        INCIDENTAL,
                                        SPECIAL, CONSEQUENTIAL, OR PUNITIVE DAMAGES (INCLUDING LOSS OF PROFITS,
                                        DATA, OR
                                        USE), EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.</p>
                                    <p><strong>9.2 Liability Cap.</strong> EXCEPT FOR PROVIDER'S INDEMNIFICATION
                                        OBLIGATIONS FOR IP INFRINGEMENT (SECTION 8.1), EACH PARTY’S TOTAL
                                        AGGREGATE
                                        LIABILITY ARISING OUT OF OR RELATED TO THIS AGREEMENT, WHETHER IN
                                        CONTRACT,
                                        TORT, OR OTHERWISE, SHALL NOT EXCEED THE TOTAL FEES PAID OR PAYABLE BY
                                        CLIENT TO
                                        PROVIDER UNDER THE APPLICABLE SOW IN THE TWELVE (12) MONTHS IMMEDIATELY
                                        PRECEDING THE EVENT GIVING RISE TO THE CLAIM.</p>
                                </section>

                                <section>
                                    <h2>10. TERM AND TERMINATION</h2>
                                    <p><strong>10.1 Term.</strong> This Agreement shall commence on the
                                        Effective
                                        Date
                                        and shall continue in full force and effect until terminated as provided
                                        herein.
                                    </p>
                                    <p><strong>10.2 Termination for Convenience.</strong> Client may terminate
                                        this
                                        Agreement or any SOW for any reason or no reason upon thirty (30) days'
                                        prior
                                        written notice to Provider. Upon such termination, Client shall pay
                                        Provider
                                        for
                                        all Services performed and non-cancellable expenses incurred up to the
                                        date
                                        of
                                        termination.</p>
                                    <p><strong>10.3 Termination for Cause.</strong> Either Party may terminate
                                        this
                                        Agreement or any SOW immediately upon written notice if the other Party:
                                        (i)
                                        materially breaches this Agreement and fails to cure such breach within
                                        fifteen
                                        (15) days after receiving written notice thereof; or (ii) becomes
                                        insolvent,
                                        makes an assignment for the benefit of creditors, or files for
                                        bankruptcy.
                                    </p>
                                    <p><strong>10.4 Effect of Termination.</strong> Upon termination: (i) Client
                                        shall
                                        pay all outstanding undisputed invoices; (ii) Provider shall deliver to
                                        Client
                                        all completed and partially completed Deliverables; and (iii) each Party
                                        shall
                                        return or destroy the other Party’s Confidential Information.</p>
                                    <p><strong>10.5 Survival.</strong> Sections 2, 4, 5, 6, 7.3, 8, 9, 11, and
                                        12
                                        shall
                                        survive any termination or expiration of this Agreement.</p>
                                </section>

                                <section>
                                    <h2>11. GENERAL PROVISIONS</h2>
                                    <p><strong>11.1 Independent Contractor.</strong> Provider is an independent
                                        contractor. Nothing in this Agreement shall be construed to create a
                                        partnership, joint venture, agency, or employment relationship between
                                        the
                                        Parties.</p>
                                    <p><strong>11.2 Force Majeure.</strong> Neither Party shall be liable for
                                        any
                                        delay
                                        or failure to perform (excluding payment obligations) due to causes
                                        beyond
                                        its
                                        reasonable control, including acts of God, war, terrorism, riot,
                                        embargoes,
                                        acts
                                        of civil or military authorities, fire, floods, or accidents.</p>
                                    <p><strong>11.3 Non-Solicitation.</strong> During the Term and for one (1)
                                        year
                                        thereafter, neither Party shall knowingly solicit for employment or hire
                                        any
                                        employee or contractor of the other Party who was directly involved in
                                        the
                                        provision of Services under this Agreement, without the prior written
                                        consent of
                                        the other Party. General solicitations not targeted at such persons
                                        shall
                                        not be
                                        a violation of this provision.</p>
                                    <p><strong>11.4 Dispute Resolution.</strong><br>(a)
                                        <strong>Negotiation:</strong>
                                        The Parties agree to attempt to resolve any dispute arising out of this
                                        Agreement through good faith negotiation between senior
                                        executives.<br>(b)
                                        <strong>Arbitration:</strong> If negotiation fails within thirty (30)
                                        days,
                                        the
                                        dispute shall be predominantly resolved by binding arbitration
                                        administered
                                        by
                                        the American Arbitration Association (AAA) in accordance with its
                                        Commercial
                                        Arbitration Rules.<br>(c) <strong>Venue & Law:</strong> The seat of
                                        arbitration
                                        shall be <strong>Wilmington, Delaware</strong>. This Agreement shall be
                                        governed
                                        by the laws of the <strong>State of Delaware</strong>, without regard to
                                        its
                                        conflict of laws principles.<br>(d) <strong>No Jury Trial:</strong> EACH
                                        PARTY
                                        HEREBY WAIVES ANY RIGHT TO A JURY TRIAL IN CONNECTION WITH ANY DISPUTE
                                        ARISING
                                        OUT OF THIS AGREEMENT.
                                    </p>
                                    <p><strong>11.5 Assignment.</strong> Neither Party may assign this Agreement
                                        without
                                        the prior written consent of the other Party, except that either Party
                                        may
                                        assign this Agreement to an Affiliate or in connection with a merger,
                                        acquisition, or sale of substantially all of its assets.</p>
                                    <p><strong>11.6 Severability.</strong> If any provision of this Agreement is
                                        held to
                                        be invalid or unenforceable, the remaining provisions shall continue in
                                        full
                                        force and effect.</p>
                                    <p><strong>11.7 Entire Agreement.</strong> This Agreement, together with all
                                        SOWs
                                        and Exhibits, constitutes the entire agreement between the Parties
                                        regarding
                                        the
                                        subject matter hereof and supersedes all prior or contemporaneous
                                        agreements,
                                        understandings, and communications.</p>
                                    <p><strong>11.8 Counterparts.</strong> This Agreement may be executed in
                                        counterparts, each of which shall be deemed an original, but all of
                                        which
                                        together shall constitute one and the same instrument. Electronic
                                        signatures
                                        shall be deemed original signatures.</p>
                                </section>
                            </div>
                            <hr class="border-[#C8A951]/20 my-16">

                            <section id="exhibit-a">
                                <h2 class="text-center font-serif text-3xl text-[#C8A951] mb-12">Exhibit A:
                                    Statement of Work (SOW)</h2>
                                <p class="text-center opacity-60 mb-12">Project Name: <span
                                        class="project-name-insert">FinalWishes</span> Platform
                                    <br>SOW Reference: SOW-<span id="year-sow-exhibit"></span>-001 |
                                    Associated
                                    MSA:
                                    MSA-<span id="year-msa-exhibit"></span>-111-FW<br>Date: <span
                                        id="date-exhibit-a"></span>
                                </p>

                                <h3>1. Executive Overview</h3>
                                <p>This Statement of Work ("SOW") defines the comprehensive scope for the
                                    <strong>FinalWishes Unified Platform</strong>. This project deliver a "Vault-Grade"
                                    secure ecosystem for the curation, preservation, and scheduled delivery of
                                    a user's digital legacy, memoirs, and final instructions.
                                </p>
                                <p><strong>Objective:</strong> Establish a permanent, industrial-grade "Living Legacy"
                                    platform spanning iOS, Android, and Web, powered by Sirsi's component library
                                    and Google Cloud's enterprise AI infrastructure.</p>

                                <h3>2. Detailed Scope of Services</h3>
                                <p><strong>2.1 Core Vault & Data Architecture</strong></p>
                                <p>Provider shall implement a <strong>Multi-Tenant, Zero-Knowledge</strong>
                                    architecture to ensure total data privacy for sensitive legacy content.</p>
                                <ul>
                                    <li><strong>Storage Layer:</strong> Hybrid approach using <strong>Cloud SQL
                                            (PostgreSQL)</strong> for structured PII (Encrypted) and
                                        <strong>Firestore</strong> for real-time legacy metadata.
                                    </li>
                                    <li><strong>File Vault:</strong> <strong>Cloud Storage</strong> buckets with
                                        per-tenant isolation. All media (Photos, Videos) secured via
                                        <strong>Cloud KMS</strong> (AES-256).
                                    </li>
                                    <li><strong>Security:</strong> Implementation of <strong>SOC 2 Type
                                            II</strong>
                                        controls, including strict IAM roles and audit logging.</li>
                                </ul>

                                <p><strong>2.2 Legacy Content & Memory Curation</strong></p>
                                <p>Provider will build automation and curation paths for the following
                                    media and directive categories:</p>
                                <p><strong>A. Multimedia Memory Walls</strong></p>
                                <ul>
                                    <li><strong>Video Memorials:</strong> YouTube API (Unlisted) integration for
                                        permanent, high-bandwidth video preservation.</li>
                                    <li><strong>Photo Galleries:</strong> Google Photos API integration for
                                        automated organization and secure sharing of life milestones.</li>
                                </ul>
                                <p><strong>B. The Secure Digital Lockbox</strong></p>
                                <ul>
                                    <li><strong>Passkeys & Accounts:</strong> Secure storage for digital credentials
                                        and account transition instructions.</li>
                                    <li><strong>Heirloom Registry:</strong> Visual inventory of physical assets
                                        with designated legacy stories and recipients.</li>
                                </ul>
                                <p><strong>C. Final Directives & Ethical Wills</strong></p>
                                <ul>
                                    <li><strong>Video Memoirs:</strong> In-app recording and curation of
                                        personal stories, life lessons, and messages of love.</li>
                                    <li><strong>Directive Generation:</strong> Secure templates for funeral
                                        preferences, final messages, and ethical wills (PDF generated).</li>
                                </ul>

                                <h4>2.3 System Integrations</h4>
                                <p>Provider shall integrate the following third-party services to achieve
                                    automation:</p>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Service</th>
                                            <th>Purpose</th>
                                            <th>Integration Level</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>YouTube / Google Photos</strong></td>
                                            <td>Media Preservation</td>
                                            <td><strong>Cloud-Native API</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>Sirsi OpenSign</strong></td>
                                            <td>E-Signatures</td>
                                            <td><strong>Self-Hosted (Full API)</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>Firebase Cloud Messaging</strong></td>
                                            <td>Time-Capsule Notifications</td>
                                            <td><strong>Native Push</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>SendGrid</strong></td>
                                            <td>Transactional Email</td>
                                            <td><strong>API Triggered</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>Google Vision API</strong></td>
                                            <td>Image Auto-Tagging</td>
                                            <td><strong>API Integrated</strong></td>
                                        </tr>
                                        <tr>
                                            <td><strong>Vertex AI (Gemini)</strong></td>
                                            <td>Process Guidance</td>
                                            <td><strong>Context-Aware (RAG)</strong></td>
                                        </tr>
                                    </tbody>
                                </table>

                                <h4>2.4 "The Shepherd" Guidance Engine</h4>
                                <p>Provider shall build a logic engine ("The Shepherd") that:</p>
                                <ol>
                                    <li><strong>Unified Legacy Logic:</strong> Implements the core "Living Legacy"
                                        orchestration for media and directive preservation.</li>
                                    <li><strong>Generates Timeline:</strong> Creates a dynamic roadmap for
                                        memory curation and final wishes organization.</li>
                                    <li><strong>Proactive Alerts:</strong> Notifies users and heirs of legacy
                                        milestones and scheduled content releases.</li>
                                    <li><strong>AI Assistance:</strong> Uses Gemini 3.0 to answer
                                        questions regarding memoir curation and legacy management.</li>
                                </ol>

                                <h3>3. Work Breakdown Structure (WBS)</h3>
                                <p><strong>PHASE 0: STRATEGIC DESIGN & IDENTITY (Weeks 1-4)</strong></p>
                                <ul>
                                    <li>0.1 Brand Identity: Logo, Typography, Palette finalization.</li>
                                    <li>0.2 UX/UI Design System: Figma-based Web + Mobile design system.</li>
                                    <li>0.3 Prototyping: High-fidelity interaction models.</li>
                                    <li>0.4 Asset Production: Custom icons and illustrations.</li>
                                </ul>

                                <p><strong>PHASE 1: FOUNDATION & VAULT ARCHITECTURE (Weeks 1-4)</strong></p>
                                <ul>
                                    <li>1.1 GCP Infrastructure: Provision Cloud Run, Cloud SQL, Firestore, VPC,
                                        Cloud Armor.</li>
                                    <li>1.2 Ops: Setup GitHub Actions CI/CD.</li>
                                    <li>1.3 Auth: Firebase Auth + MFA + Custom Claims.</li>
                                    <li>1.4 Schema: Design Relational (Heirs) vs Document (Metadata) schemas.
                                    </li>
                                    <li>1.5 Vault: Implement AES-256 crypto service and Signed URL logic.</li>
                                    <li>1.6 Web: React + Vite + "Light Royal Neo-Deco" Design System.</li>
                                    <li>1.7 E-Sign: Deploy Self-Hosted OpenSign.</li>
                                </ul>
                                <p><strong>PHASE 2: CORE LOGIC & LEGACY ENGINES (Weeks 5-9)</strong></p>
                                <ul>
                                    <li>2.1 Memorial Module: YouTube and Google Photos API integration.</li>
                                    <li>2.2 Vault Engineering: KMS-backed encryption for sensitive directives.</li>
                                    <li>2.3 Legacy Engine: Time-capsule and notification scheduling.</li>
                                    <li>2.4 Gemini AI: RAG pipeline for legacy assistance.</li>
                                    <li>2.5 PDF Service: Go-based document generation for legacy exports.</li>
                                </ul>
                                <p><strong>PHASE 3: MOBILE & TRI-PLATFORM DEPLOYMENT (Weeks 9-11)</strong></p>
                                <ul>
                                    <li>3.1 Mobile: Unified React Native build for iOS & Android.</li>
                                    <li>3.2 Bio-Auth: FaceID/TouchID secure vault access.</li>
                                    <li>3.3 Cloud Sync: Multi-platform real-time data persistence.</li>
                                    <li>3.4 Media Handling: Optimized video/photo upload pipelines.</li>
                                </ul>
                                <p><strong>PHASE 4: QA, INTEGRATION & LAUNCH (Weeks 13-16)</strong></p>
                                <ul>
                                    <li>4.1 Testing: End-to-end testing (Playwright/Cypress) and performance
                                        optimization.</li>
                                    <li>4.2 Security: Internal security code review & hardening.
                                    </li>
                                    <li>4.3 Compliance: SOC 2 evidence collection (logging, access controls).</li>
                                    <li>4.4 Store Launch: App Store & Play Store submission.</li>
                                    <li>4.5 Go-Live: DNS switchover and production deployment.</li>
                                </ul>
                                <p><strong>PHASE 5: CONTINGENCY & PROJECT MANAGEMENT (Ongoing)</strong></p>
                                <ul>
                                    <li>5.1 Project Management & Client Liaison.</li>
                                    <li>5.2 Manual QA & Cross-Platform Verification.</li>
                                    <li>5.3 User Feedback Loops & Iterative Refinement.</li>
                                    <li>5.4 Post-Launch Stabilization & Infrastructure Watch.</li>
                                </ul>

                                <h3>4. Deliverables</h3>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Deliverable</th>
                                            <th>Description</th>
                                            <th>Format</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><strong>D1: The Vault</strong></td>
                                            <td>Security core, Auth, Encrypted Storage</td>
                                            <td>Staging URL</td>
                                        </tr>
                                        <tr>
                                            <td><strong>D2: Mobile Apps</strong></td>
                                            <td>iOS and Android binaries (TestFlight)</td>
                                            <td>.ipa / .apk</td>
                                        </tr>
                                        <tr>
                                            <td><strong>D4: The Platform</strong></td>
                                            <td>Production release, fully tested</td>
                                            <td>Live URL</td>
                                        </tr>
                                        <tr>
                                            <td><strong>D5: Documentation</strong></td>
                                            <td>API Specs, Admin Guide, Compliance Pack</td>
                                            <td>PDF / Markdown</td>
                                        </tr>
                                    </tbody>
                                </table>

                                <h3>5. Assumptions</h3>
                                <ol>
                                    <li><strong>Universal Infrastructure:</strong> The platform is designed for global
                                        scalability via Google Cloud; specific localizations (if required) are deferred
                                        to V2.</li>
                                    <li><strong>Legacy Guidance Only:</strong> The "Shepherd" AI provides creative and
                                        procedural
                                        legacy support, not legal, tax, or medical advice.</li>
                                    <li><strong>Cloud Consumables:</strong> Client is responsible for direct costs
                                        associated with Google Cloud (Vertex AI, Cloud Storage) and SendGrid.</li>
                                    <li><strong>UGC Responsibility:</strong> Client is responsible for the final
                                        validation and moderating of all content uploaded to the platform.</li>
                                </ol>
                            </section>

                            <hr class="border-[#C8A951]/20 my-16">

                            <section id="exhibit-b">
                                <h2 class="text-center font-serif text-3xl text-[#C8A951] mb-12">Exhibit B: Cost
                                    Proposal & ROI Analysis</h2>


                                <h3>1. Executive Summary</h3>
                                <p>This proposal offers a transparent, atomic breakdown of the investment
                                    required
                                    to
                                    build the "Vault-Grade" legacy curation platform. Unlike opaque agency
                                    pricing
                                    or
                                    "billable hour" law firm models, we provide a fixed-price engineering
                                    partnership.
                                </p>

                                <h3>2. Comparative Market Analysis</h3>
                                <table class="w-full text-left border-collapse mb-12">
                                    <thead>
                                        <tr class="border-b border-white/20">
                                            <th class="py-4">Metric</th>
                                            <th class="py-4 text-[#C8A951]">FinalWishes Platform</th>
                                            <th class="py-4">Typical Agency (Custom)</th>
                                            <th class="py-4">Freelance Team</th>
                                        </tr>
                                    </thead>
                                    <tbody class="text-white/80">
                                        <tr class="border-b border-white/10">
                                            <td class="py-4">Total Investment</td>
                                            <td class="text-[#10b981] font-bold">$95,000 (Fixed Bid)</td>
                                            <td>$180,000 - $250,000</td>
                                            <td>$100,000 - $150,000</td>
                                        </tr>
                                        <tr class="border-b border-white/10">
                                            <td class="py-4">Platforms</td>
                                            <td class="text-[#C8A951]">iOS + Android + Web</td>
                                            <td>iOS Only (Initial)</td>
                                            <td>Variable</td>
                                        </tr>
                                        <tr class="border-b border-white/10">
                                            <td class="py-4">Time to Market</td>
                                            <td class="text-[#C8A951]">16 Weeks</td>
                                            <td>24-36 Weeks</td>
                                            <td>20-30 Weeks</td>
                                        </tr>
                                        <tr class="border-b border-white/10">
                                            <td class="py-4">IP Ownership</td>
                                            <td class="text-[#10b981]">100% Client Owned</td>
                                            <td>Restrictive</td>
                                            <td>Risky</td>
                                        </tr>
                                        <tr>
                                            <td class="py-4">AI Capability</td>
                                            <td class="text-[#C8A951]">Gemini 3.0 Native</td>
                                            <td>Add-on Cost (High)</td>
                                            <td>Limited Expertise</td>
                                        </tr>
                                    </tbody>
                                </table>
                                <blockquote>
                                    Analysis: We deliver 4x the speed at roughly 40% of the cost of a
                                    traditional
                                    enterprise build by leveraging our proprietary "Sirsi" component library and
                                    AI-accelerated development.
                                </blockquote>

                                <h3>3. Atomic Development Cost Breakdown</h3>
                                <p><strong>Phase 1: Foundation & Cloud Infrastructure (Weeks 1-4) - $24,000</strong></p>
                                <ul>
                                    <li>System Architecture & Technical Design: $6,000</li>
                                    <li>Google Cloud Project Setup (Cloud Run, Firebase): $4,000</li>
                                    <li>Database Schema Design (Cloud SQL + Firestore): $4,000</li>
                                    <li>Authentication System (Firebase Auth + MFA): $4,000</li>
                                    <li>Vault Infrastructure (Cloud Storage + KMS): $3,000</li>
                                    <li>OpenSign Self-Hosted Deployment: $3,000</li>
                                </ul>
                                <p><strong>Phase 2: Core Application Development (Weeks 5-8) - $28,000</strong>
                                </p>
                                <ul>
                                    <li>React + Vite Web Application Shell: $6,000</li>
                                    <li>React Native + Expo Mobile Shell: $7,000</li>
                                    <li>User Dashboard & Navigation: $5,000</li>
                                    <li>"The Shepherd" AI Foundation (Gemini): $6,000</li>
                                    <li>Time Capsule Scheduling System: $4,000</li>
                                </ul>
                                <p><strong>Phase 3: Living Legacy Features (Weeks 9-12) - $26,000</strong></p>
                                <ul>
                                    <li>Video Memorial Upload & Management: $6,000</li>
                                    <li>Photo Gallery / Google Photos Integration: $5,000</li>
                                    <li>Digital Lockbox Document Storage: $5,000</li>
                                    <li>Beneficiary Management UI: $5,000</li>
                                    <li>Cross-Platform Sync & Offline Support: $5,000</li>
                                </ul>
                                <p><strong>Phase 4: QA, Integration & Launch (Weeks 13-16) - $17,000</strong></p>
                                <ul>
                                    <li>End-to-End Testing (Playwright/Cypress): $5,000</li>
                                    <li>Performance Optimization & Load Testing: $3,000</li>
                                    <li>Security Code Review & Hardening: $3,000</li>
                                    <li>iOS App Store Submission: $2,000</li>
                                    <li>Google Play Store Submission: $2,000</li>
                                    <li>Production Deployment & Monitoring Setup: $2,000</li>
                                </ul>
                                <p class="mt-8"><strong>Total Fixed Investment: $95,000.00 USD</strong></p>

                                <h3>4. Infrastructure Bill of Materials (BoM)</h3>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Service</th>
                                            <th>Item</th>
                                            <th>Est. Unit Cost</th>
                                            <th>Purpose</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Compute</td>
                                            <td>Cloud Run</td>
                                            <td>~$18/mo</td>
                                            <td>Backend container</td>
                                        </tr>
                                        <tr>
                                            <td>Database</td>
                                            <td>Cloud SQL</td>
                                            <td>~$9/mo</td>
                                            <td>Secure PII storage</td>
                                        </tr>
                                        <tr>
                                            <td>NoSQL</td>
                                            <td>Firestore</td>
                                            <td>Free Tier</td>
                                            <td>User metadata</td>
                                        </tr>
                                        <tr>
                                            <td>Storage</td>
                                            <td>Cloud Storage</td>
                                            <td>$0.026/GB</td>
                                            <td>Document vault</td>
                                        </tr>
                                        <tr>
                                            <td>AI</td>
                                            <td>Vertex AI</td>
                                            <td>~$5/1M tokens</td>
                                            <td>Memory curation</td>
                                        </tr>
                                        <tr>
                                            <td>E-Sign</td>
                                            <td>OpenSign</td>
                                            <td>$20/mo</td>
                                            <td>Unlimited signatures</td>
                                        </tr>
                                    </tbody>
                                </table>

                                <div id="exhibit-b-dynamic"
                                    class="p-8 border border-[#C8A951]/20 rounded bg-white/5 italic text-center opacity-60">
                                    Selection Pending: Please select a partnership plan above to finalize
                                    Exhibit B
                                    and
                                    execute the agreement.
                                </div>
                            </section>
                        </div>
                    </div> <!-- End legal-scroll-box -->

                    <!-- MSA ACKNOWLEDGMENT BLOCK -->
                    <div id="msa-acknowledgment-block"
                        class="p-8 bg-white/5 border border-[#C8A951]/30 rounded text-center my-8 opacity-40 transition-all duration-500"
                        style="pointer-events: none;">
                        <p id="msa-status-line" class="text-white/90 font-medium mb-6">
                            ⏳ <span class="text-[#C8A951] uppercase tracking-wider text-xs">Step 2 of 3:</span>
                            <span id="msa-status-text">Please scroll to the bottom of the agreement to
                                continue.</span>
                        </p>
                        <label id="msa-ack-label" class="flex items-center justify-center gap-3 cursor-pointer mb-4"
                            style="pointer-events: none; opacity: 0.5;">
                            <input type="checkbox" id="msa-read-acknowledge" onchange="unlockPlanSelection()"
                                class="w-5 h-5 accent-[#C8A951] cursor-pointer" disabled>
                            <span class="text-sm text-white/80">I have read and understand the Master Services
                                Agreement
                                above.</span>
                        </label>
                        <button id="proceed-to-step2" disabled onclick="scrollToSignature()"
                            style="background: linear-gradient(to right, #C8A951, #E2C76B); color: #0f172a; padding: 12px 24px; font-weight: bold; font-size: 14px; text-transform: uppercase; letter-spacing: 0.1em; border-radius: 6px; border: none; cursor: not-allowed; opacity: 0.5; transition: all 0.3s;">
                            Proceed to Step 3: Sign
                        </button>
                    </div>



                    <!-- DYNAMIC APPENDIX A: SELECTED SCOPE & FEES -->
                    <div id="msa-dynamic-schedule" class="mb-12 p-8 bg-white/5 border border-white/10 rounded-lg">
                        <div
                            style="text-align: center; color: rgba(255,255,255,0.4); margin-bottom: 24px; font-style: italic;">
                            Select a package in the "Cost & Valuation" tab to populate this schedule.
                        </div>
                    </div>

                    <!-- DYNAMIC MSA SECTIONS: Conditional Legal Content Based on Add-ons -->
                    <div id="dynamic-msa-sections" class="mb-12">
                        <!-- Content injected by updateMSADynamicContent() based on selected add-ons -->
                    </div>

                    <!-- STEP 3: SIGNATURE SECTION -->
                    <div id="step-3-label" class="text-center mt-20 mb-0 opacity-0 transition-opacity duration-1000">
                        <div
                            style="width: 100%; height: 1px; background: linear-gradient(to right, transparent, #C8A951, transparent); margin-bottom: 3rem;">
                        </div>
                        <h2 class="font-serif text-3xl text-[#C8A951] uppercase tracking-widest mb-2">
                            Step 3: Sign Agreement</h2>
                        <p class="text-white/60 text-sm">Review your selection and execute the agreement</p>
                    </div>

                    <div id="signature-block"
                        class="mt-8 scroll-mt-32 opacity-0 pointer-events-none transition-all duration-500"
                        style="max-width: 800px; margin: 0 auto;">

                        <!-- Signature Card -->
                        <div style="background: linear-gradient(145deg, rgba(200,169,81,0.08), rgba(0,0,0,0.4)); 
                                    border: 2px solid rgba(200,169,81,0.5); 
                                    border-radius: 16px; 
                                    padding: 3rem; 
                                    box-shadow: 0 0 60px rgba(200,169,81,0.15), inset 0 1px 0 rgba(255,255,255,0.05);">

                            <!-- Selected Plan Display -->
                            <div
                                style="text-align: center; margin-bottom: 2.5rem; padding-bottom: 2rem; border-bottom: 1px solid rgba(200,169,81,0.3);">
                                <div
                                    style="font-size: 12px; text-transform: uppercase; letter-spacing: 0.2em; color: rgba(255,255,255,0.5); margin-bottom: 0.5rem;">
                                    Your Selected Plan</div>
                                <div id="selected-plan-display"
                                    style="font-family: Cinzel, serif; font-size: 28px; color: #C8A951;">Plan
                                    Not
                                    Selected</div>
                            </div>

                            <!-- Agreement Checkbox -->
                            <div style="text-align: center; margin-bottom: 2rem;">
                                <label
                                    style="display: inline-flex; align-items: center; gap: 12px; cursor: pointer; padding: 1rem 2rem; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; transition: all 0.3s;">
                                    <input type="checkbox" id="msa-acknowledge" onchange="toggleExecuteButton()"
                                        style="width: 20px; height: 20px; accent-color: #C8A951; cursor: pointer;">
                                    <span style="color: rgba(255,255,255,0.8); font-size: 14px;">I agree to all
                                        terms
                                        and conditions of this Master Services Agreement</span>
                                </label>
                            </div>

                            <!-- Sign Button -->
                            <div style="text-align: center; margin-bottom: 2.5rem;">
                                <button onclick="initiateOpenSign()" id="execute-btn" disabled style="display: inline-flex; align-items: center; gap: 12px; padding: 18px 48px; 
                                           background: linear-gradient(145deg, #C8A951, #B8994A); 
                                           color: #0f172a; font-weight: 700; font-size: 16px; 
                                           text-transform: uppercase; letter-spacing: 0.15em;
                                           border: none; border-radius: 50px; cursor: not-allowed;
                                           box-shadow: 0 8px 30px rgba(200,169,81,0.3);
                                           opacity: 0.5; transition: all 0.3s ease;">
                                    <svg width="24" height="24" fill="none" viewBox="0 0 24 24" stroke="currentColor"
                                        stroke-width="2">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                                    </svg>
                                    Sign Agreement
                                </button>
                                <p style="color: rgba(255,255,255,0.4); font-size: 12px; margin-top: 1rem;">
                                    You will be redirected to OpenSign for secure digital signature
                                </p>
                            </div>

                            <!-- Signature Lines -->
                            <div
                                style="display: flex; justify-content: center; gap: 4rem; padding-top: 2rem; border-top: 1px solid rgba(200,169,81,0.2);">
                                <div style="text-align: center;">
                                    <div
                                        style="border-bottom: 2px solid rgba(200,169,81,0.5); padding-bottom: 8px; margin-bottom: 8px; min-width: 220px;">
                                        <span
                                            style="font-family: 'Georgia', serif; font-style: italic; color: white; font-size: 18px;">Tameeka
                                            Lockhart</span>
                                    </div>
                                    <span
                                        style="color: rgba(255,255,255,0.4); font-size: 11px; text-transform: uppercase; letter-spacing: 0.1em;">
                                        Client · <span id="date-signature">Pending Execution</span>
                                    </span>
                                </div>
                                <div style="text-align: center;">
                                    <div
                                        style="border-bottom: 2px solid rgba(200,169,81,0.5); padding-bottom: 8px; margin-bottom: 8px; min-width: 220px;">
                                        <span
                                            style="font-family: 'Georgia', serif; font-style: italic; color: white; font-size: 18px;">Cylton
                                            Collymore</span>
                                    </div>
                                    <span
                                        style="color: rgba(255,255,255,0.4); font-size: 11px; text-transform: uppercase; letter-spacing: 0.1em;">
                                        Provider · Sirsi Technologies
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Download Link -->
                        <div style="text-align: center; margin-top: 2rem;">
                            <button onclick="downloadMSAPdf(event)"
                                style="color: rgba(200,169,81,0.6); font-size: 12px; background: none; border: none; cursor: pointer; text-decoration: underline;">
                                Download unsigned MSA as PDF
                            </button>
                        </div>
                    </div>
                </div> <!-- End Contract Tab -->

                <!-- TAB 4: VAULT -->
                <div id="vault" class="tab-content" style="position: relative;">
                    <div class="w-full flex justify-center items-start py-12 px-8">
                        <div class="w-full max-w-4xl">
                            <div class="text-center mb-12">
                                <h2 class="text-4xl font-serif text-[#C8A951] mb-4 uppercase tracking-widest">Sirsi
                                    Vault
                                </h2>
                                <p class="text-gray-400">Secure access to your executed legal artifacts and project
                                    documents.</p>
                            </div>

                            <div id="vault-empty"
                                class="text-center py-20 bg-white/5 rounded-2xl border border-dashed border-white/10">
                                <svg class="w-16 h-16 text-gray-600 mx-auto mb-4" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z">
                                    </path>
                                </svg>
                                <p class="text-gray-500">No documents found in your vault yet.</p>
                            </div>

                            <div id="vault-list" class="grid gap-4 hidden">
                                <!-- Vault items will be injected here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div> <!-- End Main Card -->
    </div> <!-- End Immersive Wrapper -->
    </main>
    </div> <!-- End Admin Wrapper -->

    <!-- Scripts -->
    <!-- Offerings Engine -->
    <script src="../../lib/offerings/catalog-data.js"></script>
    <script src="../../lib/offerings/pricing-engine.js"></script>
    <script src="../../lib/offerings/cart-manager.js"></script>
    <script src="../../lib/offerings/offerings-engine.js"></script>

    <script>
        function switchTab(tabId) {
            // Hide all content
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));

            // Show target
            document.getElementById(tabId).classList.add('active');

            // Scroll to top
            const container = document.querySelector('.main-content') || window;
            container.scrollTo({ top: 0, behavior: 'smooth' });

            // Activate btn
            const buttons = document.querySelectorAll('.tab-btn');
            if (tabId === 'sow') buttons[0].classList.add('active');
            if (tabId === 'cost') buttons[1].classList.add('active');
            if (tabId === 'contract') buttons[2].classList.add('active');
            if (tabId === 'vault') {
                buttons[3].classList.add('active');
                loadVault();
            }

            // Handle Stepper Visibility and Update
            const verticalGuide = document.getElementById('vertical-workflow-guide');
            if (verticalGuide) {
                if (tabId === 'contract') {
                    verticalGuide.style.display = 'flex';
                    // FIX 4: Properly sync stepper based on full state
                    const storedPlan = sessionStorage.getItem('selectedPlan') || selectedPlan;
                    const msaAcknowledged = document.getElementById('msa-read-acknowledge')?.checked;

                    if (storedPlan && msaAcknowledged) {
                        currentStep = 3;
                        updateStepperStatus(3);
                    } else if (storedPlan) {
                        currentStep = 2;
                        updateStepperStatus(2);
                    } else {
                        currentStep = 1;
                        updateStepperStatus(1);
                    }
                } else {
                    verticalGuide.style.display = 'none';
                }
            }
        }

        // ============================================
        // DATA INITIALIZATION (Sirsi Offerings Engine)
        // ============================================
        const PROJECT_ID = new URLSearchParams(window.location.search).get('project') || 'finalwishes';
        const catalog = getCatalog('sirsi-engineering');
        const projectMetadata = catalog.projectConfig[PROJECT_ID] || catalog.projectConfig['finalwishes'];

        const BUNDLE = catalog.bundles[`${PROJECT_ID}-core`] || catalog.bundles['finalwishes-core'];
        const CORE_PRICE = BUNDLE.basePrice;
        const CORE_WBS_DATA = BUNDLE.wbs;

        /**
         * Injects project-specific metadata into the DOM for a truly dynamic portal.
         */
        function populateProjectMetadata() {
            const projectName = projectMetadata.name || 'FinalWishes';
            const companyName = projectMetadata.legalMetadata.companyName || 'FinalWishes Inc.';

            // 1. Update document title
            document.title = `${projectName} | Strategic Partnership Agreement`;

            // 2. Update all project name placeholders
            document.querySelectorAll('.project-name-insert').forEach(el => {
                el.textContent = projectName;
            });

            // 3. Update all company name placeholders
            document.querySelectorAll('.company-name-insert').forEach(el => {
                el.textContent = companyName;
            });

            // 4. Update Header Subtitle if component logic allows (or direct DOM)
            const header = document.querySelector('.project-title-display');
            if (header) {
                header.setAttribute('data-subtitle', `${projectName} • Strategic Partnership Agreement`);
            }

            console.log(`[Lifecycle Engine] Context Loaded: ${projectName} (${PROJECT_ID})`);
        }

        // Initialize metadata on load
        document.addEventListener('DOMContentLoaded', populateProjectMetadata);

        const ADDONS_INFO = {};
        const ADDON_WBS_DATA = {};

        // Derive add-on info from master catalog
        Object.values(catalog.products).forEach(p => {
            ADDONS_INFO[p.id] = {
                id: p.id,
                name: p.name,
                desc: p.description,
                shortDesc: p.shortDescription,
                price: p.bundledPrice,
                weeks: p.timeline,
                unit: p.timelineUnit === 'weeks' ? '' : p.timelineUnit,
                note: p.shortDescription || ''
            };
            if (p.wbs) {
                ADDON_WBS_DATA[p.id] = {
                    phases: p.wbs
                };
            }
        });

        // Default State
        let pkg = 'A';
        const selectedAddons = new Set();
        let selectedPlan = 'Unified Plan 1'; // Default plan

        /**
         * INITIALIZE STATE FROM SESSION STORAGE
         * Sources: 1. offerings_contract_data (New Engine)
         *          2. selectedAddons/selectedPlan (Legacy)
         */
        function initializeContractState() {
            const offeringsDataRaw = sessionStorage.getItem('offerings_contract_data');

            if (offeringsDataRaw) {
                try {
                    const data = JSON.parse(offeringsDataRaw);
                    console.log('[Contract] Initializing from Offerings Engine:', data);

                    // Clear current and repopulate
                    selectedAddons.clear();

                    if (data.items) {
                        data.items.forEach(item => {
                            // Map 'finalwishes-core' to pkg 'A'
                            if (item.id === 'finalwishes-core') {
                                pkg = 'A';
                            } else {
                                selectedAddons.add(item.id);
                            }
                        });
                    }

                    // Sync UI checkboxes for add-ons
                    syncAddonCheckboxes();
                } catch (e) {
                    console.error('[Contract] Error loading offerings data:', e);
                }
            } else {
                // Fallback to legacy storage
                const legacyAddons = sessionStorage.getItem('selectedAddons');
                if (legacyAddons) {
                    try {
                        JSON.parse(legacyAddons).forEach(id => selectedAddons.add(id));
                        syncAddonCheckboxes();
                    } catch (e) { }
                }
            }

            // Always update content after init
            updateAllDynamicContent();
        }

        /**
         * Synchronize the visual state of add-on cards with selectedAddons set
         */
        function syncAddonCheckboxes() {
            // Find all elements that look like addon cards
            const cards = document.querySelectorAll('[id^="addon-card-"]');
            cards.forEach(card => {
                const id = card.id.replace('addon-card-', '');
                const checkbox = card.querySelector('.checkbox-indicator');

                if (selectedAddons.has(id)) {
                    card.classList.remove('border-white/10');
                    card.classList.add('border-[#C8A951]', 'bg-[#C8A951]/10');
                    if (checkbox) {
                        checkbox.innerHTML = '✓';
                        checkbox.className = 'w-6 h-6 rounded flex items-center justify-center checkbox-indicator bg-[#10B981] border-2 border-[#10B981] text-white font-bold text-sm';
                    }
                } else {
                    card.classList.remove('border-[#C8A951]', 'bg-[#C8A951]/10');
                    card.classList.add('border-white/10');
                    if (checkbox) {
                        checkbox.innerHTML = '';
                        checkbox.className = 'w-6 h-6 rounded border-2 border-white/30 flex items-center justify-center checkbox-indicator transition-colors';
                    }
                }
            });
        }

        function toggleAddon(addonId, element) {
            // Toggle visual state
            const checkbox = element.querySelector('.checkbox-indicator');
            const isSelected = selectedAddons.has(addonId);

            if (isSelected) {
                selectedAddons.delete(addonId);
                element.classList.remove('border-[#C8A951]', 'bg-[#C8A951]/10');
                element.classList.add('border-white/10');
                if (checkbox) {
                    checkbox.innerHTML = '';
                    checkbox.classList.remove('bg-[#10B981]', 'border-[#10B981]');
                    checkbox.classList.add('border-white/30');
                }
            } else {
                selectedAddons.add(addonId);
                element.classList.remove('border-white/10');
                element.classList.add('border-[#C8A951]', 'bg-[#C8A951]/10');
                if (checkbox) {
                    checkbox.innerHTML = '✓';
                    checkbox.className = 'w-6 h-6 rounded flex items-center justify-center checkbox-indicator bg-[#10B981] border-2 border-[#10B981] text-white font-bold text-sm';
                }
            }

            // Save to session for persistence
            sessionStorage.setItem('selectedAddons', JSON.stringify([...selectedAddons]));

            // MASTER ORCHESTRATOR: Propagate changes through ALL dynamic sections
            updateAllDynamicContent();
        }

        /**
         * Update the add-on total bar visibility and values
         */
        function updateAddonTotalBar() {
            const totalBar = document.getElementById('addon-total-bar');
            const totalValue = document.getElementById('addon-total-value');
            const grandTotalDisplay = document.getElementById('addon-grand-total');

            if (!totalBar) return;

            let addonsTotal = calculateAddonsTotal();
            let grandTotal = CORE_PRICE + addonsTotal;

            if (addonsTotal > 0) {
                totalBar.classList.remove('hidden');
                totalValue.textContent = '$' + addonsTotal.toLocaleString();
                if (grandTotalDisplay) grandTotalDisplay.textContent = '$' + grandTotal.toLocaleString();
            } else {
                totalBar.classList.add('hidden');
            }
        }

        /**
         * Helper to update the MSA Appendix A based on selection
         */
        function updateMSAAppendix() {
            const msaSchedule = document.getElementById('msa-dynamic-schedule');
            if (!msaSchedule) return;

            let addonsTotal = 0;
            let addonsHtml = '';

            if (selectedAddons.size > 0) {
                addonsHtml = `<div style="grid-column: span 2; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid rgba(200,169,81,0.3);">
                    <h4 style="color: #C8A951; font-weight: 700; margin-bottom: 1rem; font-size: 1.1rem;">Selected Add-On Modules</h4>
                    <table style="width: 100%; border-collapse: collapse; color: rgba(255,255,255,0.9); font-size: 0.9rem;">
                        <thead>
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <th style="text-align: left; padding: 0.5rem 0; color: #C8A951;">Module</th>
                                <th style="text-align: right; padding: 0.5rem 0; color: #C8A951;">Timeline</th>
                                <th style="text-align: right; padding: 0.5rem 0; color: #C8A951;">Price</th>
                            </tr>
                        </thead>
                        <tbody>`;

                selectedAddons.forEach(id => {
                    const info = ADDONS_INFO[id];
                    if (info) {
                        addonsTotal += info.price;
                        const timeline = info.unit ? `${info.weeks} ${info.unit}` : `${info.weeks} weeks`;
                        addonsHtml += `
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                                <td style="padding: 0.75rem 0;"><span style="color: #10B981; margin-right: 0.5rem;">✓</span>${info.name}</td>
                                <td style="text-align: right; padding: 0.75rem 0; color: rgba(255,255,255,0.6);">${timeline}</td>
                                <td style="text-align: right; padding: 0.75rem 0; font-weight: 600;">$${info.price.toLocaleString()}</td>
                            </tr>`;
                    }
                });

                addonsHtml += `
                        </tbody>
                        <tfoot>
                            <tr style="border-top: 2px solid rgba(200,169,81,0.3);">
                                <td colspan="2" style="padding: 0.75rem 0; font-weight: 700; color: white;">Add-Ons Subtotal</td>
                                <td style="text-align: right; padding: 0.75rem 0; font-weight: 700; color: #10B981;">$${addonsTotal.toLocaleString()}</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>`;
            }

            const grandTotal = CORE_PRICE + addonsTotal;

            msaSchedule.innerHTML = `
                <h3 style="color: #C8A951; font-family: Cinzel, serif; font-size: 1.5rem; text-align: center; margin-bottom: 1.5rem; text-transform: uppercase; border-bottom: 1px solid rgba(200,169,81,0.3); padding-bottom: 1rem;">
                    Appendix A: Selected Scope & Fees
                </h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; font-family: 'Inter', sans-serif;">
                    <div>
                        <h4 style="color: white; font-weight: 700; margin-bottom: 0.5rem;">Core Package</h4>
                        <p style="color: #C8A951; font-size: 1.25rem;">${BUNDLE.name}</p>
                        <p style="color: white; font-size: 1.5rem; font-weight: 700; margin-top: 0.5rem;">$${CORE_PRICE.toLocaleString()}</p>
                    </div>
                    <div>
                        <h4 style="color: white; font-weight: 700; margin-bottom: 0.5rem;">Total Contract Value</h4>
                        <p style="color: #10B981; font-size: 2rem; font-weight: 700;">$${grandTotal.toLocaleString()}</p>
                        ${addonsTotal > 0 ? `<p style="font-size: 0.8rem; color: #94a3b8;">(Core + ${selectedAddons.size} Add-On${selectedAddons.size > 1 ? 's' : ''})</p>` : '<p style="font-size: 0.8rem; color: #94a3b8;">(Core Package Only)</p>'}
                    </div>
                    <div style="grid-column: span 2;">
                        <h4 style="color: white; font-weight: 700; margin-bottom: 0.5rem;">Core Scope Summary</h4>
                        <ul style="list-style: disc; padding-left: 1.5rem; color: rgba(255,255,255,0.8); line-height: 1.6;">
                            <li><strong>Platform:</strong> ${projectMetadata.scopeSummary.platform}</li>
                            <li><strong>Architecture:</strong> ${projectMetadata.scopeSummary.architecture}</li>
                            <li><strong>Timeline:</strong> ${projectMetadata.scopeSummary.timeline}</li>
                        </ul>
                    </div>
                    ${addonsHtml}
                </div>
            `;
        }

        // ============================================
        // DYNAMIC CONTRACT SYSTEM - MASTER ORCHESTRATOR
        // Version 2.0.0 - Full Dynamic Propagation
        // ============================================

        /**
         * MASTER ORCHESTRATOR: Updates ALL dynamic content when add-ons change
         * This is the single source of truth for propagating add-on selections
         */
        function updateAllDynamicContent() {
            const grandTotal = calculateGrandTotal();

            // 1. Update add-on total bar (Cost tab header)
            updateAddonTotalBar();

            // 2. Update Payment Schedule (recalculate all plans)
            updatePaymentSchedule(grandTotal);

            // 3. Update Value Realization (price breakdown)
            updateValueRealization(grandTotal);

            // 4. Update Atomic Development Breakdown (WBS)
            updateAtomicBreakdown(grandTotal);

            // 5. Update MSA Appendix (already exists, call it)
            updateMSAAppendix();

            // 6. Update MSA Dynamic Content (conditional legal sections)
            updateMSADynamicContent();

            console.log('[Dynamic Contract] Updated all sections. Grand Total:', '$' + grandTotal.toLocaleString());
        }

        /**
         * Calculate the grand total (Core + All Selected Add-ons)
         */
        function calculateGrandTotal() {
            let addonsTotal = calculateAddonsTotal();
            return (CORE_PRICE || 0) + addonsTotal;
        }

        /**
         * Calculate add-ons subtotal only
         */
        function calculateAddonsTotal() {
            let addonsTotal = 0;
            selectedAddons.forEach(id => {
                if (ADDONS_INFO[id]) {
                    addonsTotal += ADDONS_INFO[id].price;
                }
            });
            return addonsTotal;
        }

        /**
         * Recalculates all payment plan cards based on the new grand total
         */
        function updatePaymentSchedule(grandTotal) {
            const totalDisplay = document.getElementById('payment-total-display');
            if (totalDisplay) totalDisplay.textContent = '$' + grandTotal.toLocaleString();

            // Plan 1: 2 Payments
            const p1Amt = Math.round(grandTotal / 2);
            const p1Remaining = grandTotal - p1Amt;
            const p1AmtEl = document.getElementById('plan-1-amount');
            const p1p1El = document.getElementById('plan-1-p1');
            const p1p2El = document.getElementById('plan-1-p2');
            const p1TotalEl = document.getElementById('plan-1-total');

            if (p1AmtEl) p1AmtEl.textContent = '$' + p1Amt.toLocaleString();
            if (p1p1El) p1p1El.textContent = '$' + p1Amt.toLocaleString();
            if (p1p2El) p1p2El.textContent = '$' + p1Remaining.toLocaleString();
            if (p1TotalEl) p1TotalEl.textContent = '$' + grandTotal.toLocaleString();

            // Plan 2: 3 Payments
            const p2Amt = Math.floor(grandTotal / 3);
            const p2Last = grandTotal - (p2Amt * 2);
            const p2AmtEl = document.getElementById('plan-2-amount');
            const p2p1El = document.getElementById('plan-2-p1');
            const p2p2El = document.getElementById('plan-2-p2');
            const p2p3El = document.getElementById('plan-2-p3');
            const p2TotalEl = document.getElementById('plan-2-total');

            if (p2AmtEl) p2AmtEl.textContent = '$' + p2Amt.toLocaleString();
            if (p2p1El) p2p1El.textContent = '$' + p2Amt.toLocaleString();
            if (p2p2El) p2p2El.textContent = '$' + p2Amt.toLocaleString();
            if (p2p3El) p2p3El.textContent = '$' + p2Last.toLocaleString();
            if (p2TotalEl) p2TotalEl.textContent = '$' + grandTotal.toLocaleString();

            // Plan 3: 4 Payments (Special check for existence)
            const p3Amt = Math.round(grandTotal / 4);
            const p3Last = grandTotal - (p3Amt * 3);
            const p3AmtEl = document.getElementById('plan-3-amount');
            const p3p1El = document.getElementById('plan-3-p1');
            const p3p2El = document.getElementById('plan-3-p2');
            const p3p3El = document.getElementById('plan-3-p3');
            const p3p4El = document.getElementById('plan-3-p4');
            const p3TotalEl = document.getElementById('plan-3-total');

            if (p3AmtEl) p3AmtEl.textContent = '$' + p3Amt.toLocaleString();
            if (p3p1El) p3p1El.textContent = '$' + p3Amt.toLocaleString();
            if (p3p2El) p3p2El.textContent = '$' + p3Amt.toLocaleString();
            if (p3p3El) p3p3El.textContent = '$' + p3Amt.toLocaleString();
            if (p3p4El) p3p4El.textContent = '$' + p3Last.toLocaleString();
            if (p3TotalEl) p3TotalEl.textContent = '$' + grandTotal.toLocaleString();

            // Sync current plan if one is already selected
            const storedPlan = sessionStorage.getItem('selectedPlan');
            if (storedPlan) {
                updateExhibitBDynamic(storedPlan);
            }
        }


        /**
         * UPDATE VALUE REALIZATION: Shows price breakdown with add-ons
         */
        function updateValueRealization(grandTotal) {
            const discountBox = document.getElementById('discount-a');
            if (!discountBox) return;

            const addonsTotal = calculateAddonsTotal();

            // Fetch configuration from projectMetadata or use defaults
            const vr = projectMetadata.valueRealization || {
                marketBase: 180000, marketMultiplier: 1.5, marketLabel: 'US Agency (Standard Rate)',
                googleBase: 60000, googleMultiplier: 0.15, googleLabel: 'Google Stack Acceleration',
                sirsiBase: 25000, sirsiMultiplier: 0.10, sirsiLabel: 'Sirsi Logic Asset Leverage'
            };

            const marketRate = vr.marketBase + (addonsTotal * vr.marketMultiplier);
            const googleSavings = vr.googleBase + Math.round(addonsTotal * vr.googleMultiplier);
            const sirsiSavings = vr.sirsiBase + Math.round(addonsTotal * vr.sirsiMultiplier);

            let addonsRowHtml = '';
            if (addonsTotal > 0) {
                addonsRowHtml = `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <span style="font-size: 20px; font-family: Inter, sans-serif; color: white;">
                            <span style="color: #10b981;">✓</span> Selected Add-Ons (${selectedAddons.size})
                        </span>
                        <span style="font-size: 24px; font-family: Cinzel, serif; color: #C8A951;">+$${addonsTotal.toLocaleString()}</span>
                    </div>
                `;
            }

            discountBox.innerHTML = `
                <!-- Row 1: Market Standard -->
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <span style="font-size: 20px; font-family: Inter, sans-serif; color: white;">${vr.marketLabel}</span>
                    <span style="font-size: 24px; font-family: Cinzel, serif; color: #94a3b8; text-decoration: line-through;">$${marketRate.toLocaleString()}</span>
                </div>
                
                <!-- Row 2: Google Stack Leverage -->
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0;">
                    <span style="font-size: 20px; font-family: Inter, sans-serif; color: white;">${vr.googleLabel}</span>
                    <span style="font-size: 24px; font-family: Cinzel, serif; color: #10b981;">−$${googleSavings.toLocaleString()}</span>
                </div>
                
                <!-- Row 3: Sirsi Component Library -->
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <span style="font-size: 20px; font-family: Inter, sans-serif; color: white;">${vr.sirsiLabel}</span>
                    <span style="font-size: 24px; font-family: Cinzel, serif; color: #10b981;">−$${sirsiSavings.toLocaleString()}</span>
                </div>
                
                ${addonsRowHtml}
                
                <!-- Row 4: Final Total -->
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 24px 0 12px 0;">
                    <span style="font-size: 20px; font-family: Inter, sans-serif; font-weight: 600; color: #C8A951;">Your Price</span>
                    <span style="font-size: 28px; font-family: Cinzel, serif; font-weight: 600; color: #C8A951;">$${grandTotal.toLocaleString()}</span>
                </div>
            `;
        }

        /**
         * UPDATE ATOMIC BREAKDOWN: Rebuilds WBS with Core + Selected Add-ons
         * - Uses CORE_WBS_DATA which totals exactly $95,000
         * - Dynamically adds selected add-on phases
         * - Shows activity breakdowns for ALL phases
         * - Adds totals summary at bottom
         */
        function updateAtomicBreakdown(grandTotal) {
            const wbsContainer = document.getElementById('wbs-cost-a');
            const phasesContainer = document.getElementById('wbs-phases-container');
            if (!wbsContainer || !phasesContainer) return;

            // Calculate totals
            let coreHours = CORE_WBS_DATA.reduce((sum, p) => sum + p.hours, 0);
            let coreCost = CORE_WBS_DATA.reduce((sum, p) => sum + p.cost, 0);
            let addonHours = 0;
            let addonCost = 0;

            selectedAddons.forEach(id => {
                if (ADDON_WBS_DATA[id]) {
                    ADDON_WBS_DATA[id].phases.forEach(p => {
                        addonHours += p.hours;
                        addonCost += p.cost;
                    });
                }
            });

            const totalHours = coreHours + addonHours;
            const totalCost = coreCost + addonCost;

            // Update allocation text
            const allocationText = wbsContainer.querySelector('#allocation-text');
            if (allocationText) {
                const addonsCount = selectedAddons.size;
                const corePhaseCount = CORE_WBS_DATA.length;
                let addonPhaseCount = 0;
                selectedAddons.forEach(id => {
                    if (ADDON_WBS_DATA[id]) {
                        addonPhaseCount += ADDON_WBS_DATA[id].phases.length;
                    }
                });
                const totalPhases = corePhaseCount + addonPhaseCount;

                if (addonsCount > 0) {
                    allocationText.innerHTML = `Transparent allocation of <strong style="color: #C8A951;">${totalHours} engineering hours</strong> across ${totalPhases} phases <span style="color: rgba(255,255,255,0.6);">(Core: ${corePhaseCount} + Add-Ons: ${addonPhaseCount})</span>.`;
                } else {
                    allocationText.innerHTML = `Transparent allocation of <strong style="color: #C8A951;">${totalHours} engineering hours</strong> across ${totalPhases} core phases.`;
                }
            }

            // Build phase HTML
            let phasesHtml = '';
            let phaseNum = 1;

            // Add Core Phases (always shown)
            CORE_WBS_DATA.forEach(phase => {
                phasesHtml += buildPhaseHtml(phaseNum, phase.name, `Weeks ${phase.weeks}`, phase.hours, phase.cost, phase.activities, false);
                phaseNum++;
            });

            // Add Selected Add-on Phases
            selectedAddons.forEach(addonId => {
                const addonInfo = ADDONS_INFO[addonId];
                const addonWBS = ADDON_WBS_DATA[addonId];

                if (addonInfo && addonWBS) {
                    addonWBS.phases.forEach((phase, idx) => {
                        const phaseName = `${addonInfo.name}: ${phase.name}`;
                        const timeline = phase.weeks.includes('-') ? `Weeks ${phase.weeks}` : phase.weeks;
                        phasesHtml += buildPhaseHtml(phaseNum, phaseName, timeline, phase.hours, phase.cost, phase.activities, true, addonInfo.name);
                        phaseNum++;
                    });
                }
            });

            // Add Totals Summary Row
            phasesHtml += `
                <div style="background: rgba(200,169,81,0.1); border: 2px solid #C8A951; border-radius: 12px; padding: 24px 32px; margin-top: 16px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h3 style="color: #C8A951; font-weight: 700; font-size: 20px; font-family: Cinzel, serif; margin: 0; text-transform: uppercase; letter-spacing: 0.1em;">
                                Total Development Investment</h3>
                            <p style="color: rgba(255,255,255,0.7); font-size: 14px; margin: 4px 0 0 0;">
                                ${totalHours} Hours • ${phaseNum - 1} Phases${selectedAddons.size > 0 ? ` • ${selectedAddons.size} Add-On${selectedAddons.size > 1 ? 's' : ''} Selected` : ''}</p>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 32px; font-weight: bold; color: #C8A951; font-family: Cinzel, serif;">
                                $${totalCost.toLocaleString()}</div>
                            <div style="font-size: 14px; color: rgba(255,255,255,0.7);">
                                ${selectedAddons.size > 0 ? `Core: $${coreCost.toLocaleString()} + Add-Ons: $${addonCost.toLocaleString()}` : 'Core Platform'}</div>
                        </div>
                    </div>
                </div>
            `;

            // Replace the phases container content
            phasesContainer.innerHTML = phasesHtml;

            console.log('[Atomic Breakdown] Updated with', phaseNum - 1, 'phases. Total:', '$' + totalCost.toLocaleString());
        }

        /**
         * Helper: Build Phase HTML Block
         * - Removed green badges per user feedback
         * - All phases now show consistent styling (gold accent)
         * - Activity breakdown is always included
         */
        function buildPhaseHtml(num, name, timeline, hours, cost, activities, isAddon = false, addonName = '') {
            // Build activities table rows
            let activitiesHtml = '';
            activities.forEach(act => {
                activitiesHtml += `
                    <tr>
                        <td style="padding: 12px 0; color: white;">${act.name}</td>
                        <td style="color: rgba(255,255,255,0.8);">${act.role}</td>
                        <td style="text-align: right; color: white;">${act.hours}</td>
                        <td style="text-align: right; color: #C8A951;">$${act.cost.toLocaleString()}</td>
                    </tr>
                `;
            });

            // All phases use consistent gold styling - no green distinction
            const accentColor = '#C8A951';
            const bgColor = 'rgba(255,255,255,0.05)';
            const borderColor = 'rgba(255,255,255,0.15)';

            // Add-on indicator text (subtle, no badge)
            const addonIndicator = isAddon ? ` (${addonName})` : '';

            return `
                <div style="background: ${bgColor}; border: 1px solid ${borderColor}; border-radius: 12px; overflow: hidden;">
                    <div style="padding: 24px 32px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; background: rgba(255,255,255,0.03);"
                        onclick="this.nextElementSibling.classList.toggle('hidden')">
                        <div style="display: flex; align-items: center; gap: 24px;">
                            <div style="height: 48px; width: 48px; border-radius: 4px; background: rgba(200,169,81,0.1); border: 1px solid ${accentColor}; display: flex; align-items: center; justify-content: center; color: ${accentColor}; font-family: Cinzel, serif; font-weight: bold; font-size: 20px;">
                                ${num}</div>
                            <div>
                                <h3 style="color: white; font-weight: 600; font-size: 20px; font-family: Cinzel, serif; margin: 0;">
                                    ${name}${addonIndicator}</h3>
                                <p style="color: ${accentColor}; font-size: 14px; margin: 4px 0 0 0;">
                                    ${timeline} • ${hours} Hours</p>
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 24px; font-weight: bold; color: white; font-family: Cinzel, serif;">
                                $${cost.toLocaleString()}</div>
                            <div style="font-size: 14px; color: ${accentColor};">${isAddon ? 'Add-On Value' : 'Allocated Value'}</div>
                        </div>
                    </div>
                    <div style="border-top: 1px solid rgba(255,255,255,0.1); padding: 24px 32px; background: rgba(0,0,0,0.2);">
                        <table style="width: 100%; font-size: 14px; text-align: left; border-collapse: collapse;">
                            <tr style="color: ${accentColor}; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <th style="padding-bottom: 12px; font-weight: 600;">Activity</th>
                                <th style="padding-bottom: 12px; font-weight: 600;">Role</th>
                                <th style="padding-bottom: 12px; text-align: right; font-weight: 600;">Hrs</th>
                                <th style="padding-bottom: 12px; text-align: right; font-weight: 600;">Cost</th>
                            </tr>
                            ${activitiesHtml}
                        </table>
                    </div>
                </div>
            `;
        }

        /**
         * UPDATE MSA DYNAMIC CONTENT: Add conditional legal sections based on add-ons
         */
        function updateMSADynamicContent() {
            // This adds/removes conditional sections in the MSA based on selected add-ons
            // For example, if 'maintenance' is selected, add SLA terms
            // If 'ai' is selected, add AI usage disclosure

            const dynamicMSASections = document.getElementById('dynamic-msa-sections');
            if (!dynamicMSASections) return;

            let sectionsHtml = '';

            if (selectedAddons.has('maintenance')) {
                sectionsHtml += `
                    <div class="msa-addon-section" style="margin-top: 2rem; padding: 1.5rem; background: rgba(16,185,129,0.05); border: 1px solid rgba(16,185,129,0.3); border-radius: 8px;">
                        <h4 style="color: #10b981; margin-bottom: 1rem;">Maintenance & Support Terms</h4>
                        <ul style="list-style: disc; padding-left: 1.5rem; color: rgba(255,255,255,0.8); line-height: 1.6;">
                            <li>Support hours: Maximum 20 hours per month</li>
                            <li>Emergency response SLA: 4 hours</li>
                            <li>Excludes new feature development</li>
                            <li>Monthly health reports provided</li>
                        </ul>
                    </div>
                `;
            }

            const hasAI = Array.from(selectedAddons).some(id => id.includes('ai')) || projectMetadata.legalMetadata.disclosureAI;
            if (hasAI) {
                sectionsHtml += `
                    <div class="msa-addon-section" style="margin-top: 2rem; padding: 1.5rem; background: rgba(200,169,81,0.05); border: 1px solid rgba(200,169,81,0.3); border-radius: 8px;">
                        <h4 style="color: #C8A951; margin-bottom: 1rem;">AI Usage Disclosure</h4>
                        <p style="color: rgba(255,255,255,0.8); line-height: 1.6;">
                            This engagement includes AI-powered features using Google Vertex AI (Gemini 3.0). 
                            AI outputs are provided as guidance and should be verified by qualified professionals 
                            for legal accuracy. Provider makes no warranty regarding AI-generated content accuracy.
                        </p>
                    </div>
                `;
            }

            const hasFinancial = selectedAddons.has('financial') || projectMetadata.legalMetadata.disclosureFinancial;
            if (hasFinancial) {
                sectionsHtml += `
                    <div class="msa-addon-section" style="margin-top: 2rem; padding: 1.5rem; background: rgba(200,169,81,0.05); border: 1px solid rgba(200,169,81,0.3); border-radius: 8px;">
                        <h4 style="color: #C8A951; margin-bottom: 1rem;">Financial Data Security Addendum</h4>
                        <p style="color: rgba(255,255,255,0.8); line-height: 1.6;">
                            Advanced Data Discovery modules may connect to third-party financial institutions.
                            Client acknowledges that Provider acts as data processor, not controller, for financial data.
                            All financial credentials are tokenized and never stored in plain text.
                        </p>
                    </div>
                `;
            }

            if (projectMetadata.legalMetadata.jurisdiction) {
                sectionsHtml += `
                    <div class="msa-addon-section" style="margin-top: 2rem; padding: 1.5rem; background: rgba(200,169,81,0.05); border: 1px solid rgba(200,169,81,0.3); border-radius: 8px;">
                        <h4 style="color: #C8A951; margin-bottom: 1rem;">Jurisdiction</h4>
                        <p style="color: rgba(255,255,255,0.8); line-height: 1.6;">
                            This Agreement shall be governed by and construed in accordance with the laws of ${projectMetadata.legalMetadata.jurisdiction}.
                        </p>
                    </div>
                `;
            }

            dynamicMSASections.innerHTML = sectionsHtml;
        }

        /**
         * Update Exhibit B with dynamic pricing
         */
        function updateExhibitBDynamic(planName) {
            const dynamicBlock = document.getElementById('exhibit-b-dynamic');
            if (!dynamicBlock) return;

            const grandTotal = calculateGrandTotal();
            let planContent = '';

            const isPlan1 = (planName || '').includes('Plan 1');
            const isPlan2 = (planName || '').includes('Plan 2');
            const isPlan3 = (planName || '').includes('Plan 3');

            if (isPlan1) {
                const payment = Math.round(grandTotal / 2);
                planContent = `
                    <h3>5. Payment Schedule (Plan 1: 2 Payments)</h3>
                    <p>Two equal payments for simplified billing.</p>
                    <table class="w-full text-left border-collapse mt-4">
                        <tr class="border-b border-white/10"><td class="py-2">Payment 1 (Signing)</td><td class="text-right text-[#C8A951]">$${payment.toLocaleString()}</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Payment 2 (Delivery)</td><td class="text-right text-[#C8A951]">$${payment.toLocaleString()}</td></tr>
                    </table>
                    <p class="mt-4 text-sm font-bold opacity-60">Total Contract Value: $${grandTotal.toLocaleString()} USD</p>
                `;
            } else if (isPlan2) {
                const base = Math.floor(grandTotal / 3);
                const last = grandTotal - (base * 2);
                planContent = `
                    <h3>5. Payment Schedule (Plan 2: 3 Monthly Payments)</h3>
                    <p>Recommended: Balanced cash flow over 3 months.</p>
                    <table class="w-full text-left border-collapse mt-4">
                        <tr class="border-b border-white/10"><td class="py-2">Month 1 (Signing)</td><td class="text-right text-[#C8A951]">$${base.toLocaleString()}</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 2</td><td class="text-right text-[#C8A951]">$${base.toLocaleString()}</td></tr>
                        <tr><td class="py-2">Month 3</td><td class="text-right text-[#C8A951]">$${last.toLocaleString()}</td></tr>
                    </table>
                    <p class="mt-4 text-sm font-bold opacity-60">Total Contract Value: $${grandTotal.toLocaleString()} USD</p>
                `;
            } else if (isPlan3) {
                const payment = Math.round(grandTotal / 4);
                planContent = `
                    <h3>5. Payment Schedule (Plan 3: 4 Monthly Payments)</h3>
                    <p>Extended flexibility spread across 4 months.</p>
                    <table class="w-full text-left border-collapse mt-4">
                        <tr class="border-b border-white/10"><td class="py-2">Month 1 (Signing)</td><td class="text-right text-[#C8A951]">$${payment.toLocaleString()}</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 2</td><td class="text-right text-[#C8A951]">$${payment.toLocaleString()}</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 3</td><td class="text-right text-[#C8A951]">$${payment.toLocaleString()}</td></tr>
                        <tr><td class="py-2">Month 4</td><td class="text-right text-[#C8A951]">$${payment.toLocaleString()}</td></tr>
                    </table>
                    <p class="mt-4 text-sm font-bold opacity-60">Total Contract Value: $${grandTotal.toLocaleString()} USD</p>
                `;
            } else {
                planContent = `<p class="text-red-400">Please select a valid payment plan.</p>`;
            }

            dynamicBlock.innerHTML = planContent;
            dynamicBlock.classList.remove('opacity-60', 'italic', 'text-center');
            dynamicBlock.style.background = 'rgba(200, 169, 81, 0.05)';
            dynamicBlock.style.borderColor = 'rgba(200, 169, 81, 0.5)';
        }


        document.addEventListener('DOMContentLoaded', () => {
            console.log('[Contract] DOM Content Loaded - Initializing State');
            initializeContractState();
        });

        /**
         * Load items from the Sirsi Vault via Firestore
         * v1.1.3 - 2026-01-06 (Modular SDK + Contrast Fix)
         */
        async function loadVault() {
            const vaultList = document.getElementById('vault-list');
            const vaultEmpty = document.getElementById('vault-empty');

            try {
                const dbService = window.Firebase ? window.Firebase.DatabaseService : null;
                if (!dbService) {
                    console.warn('Vault: DatabaseService not available.');
                    return;
                }

                // Fetch using custom DatabaseService with PROJECT_ID filter and ordering
                const documents = await dbService.getDocuments('vault', [
                    { field: 'projectId', operator: '==', value: PROJECT_ID }
                ], 'createdAt', 'desc');

                if (!documents || documents.length === 0) {
                    vaultList.classList.add('hidden');
                    vaultEmpty.classList.remove('hidden');
                    return;
                }

                vaultEmpty.classList.add('hidden');
                vaultList.classList.remove('hidden');
                vaultList.innerHTML = '';

                documents.forEach(data => {
                    const date = data.signedAt ? new Date(data.signedAt).toLocaleDateString() : 'N/A';

                    const item = document.createElement('div');
                    item.className = 'glass-panel p-6 rounded-xl border border-white/10 flex items-center justify-between hover:border-[#C8A951]/50 transition-all';
                    item.style.marginBottom = '1rem';
                    item.innerHTML = `
                        <div class="flex items-center gap-4">
                            <div class="p-3 bg-[#C8A951]/10 rounded-lg text-[#C8A951]">
                                <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                    <path d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                                </svg>
                            </div>
                            <div class="text-left">
                                <h4 class="text-white font-medium">${data.signerName || 'Untitled Document'}</h4>
                                <div class="text-xs text-gray-500 font-mono mt-1">Ref: ${data.envelopeId?.substring(0, 8) || 'ARCHIVE'} • Signed: ${date}</div>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <button onclick="downloadFromVault('${data.envelopeId}')" class="px-4 py-2 border border-[#C8A951]/30 rounded-lg text-xs font-bold text-[#C8A951] hover:bg-[#C8A951]/10 transition-colors uppercase tracking-widest">
                                Download
                            </button>
                        </div>
                    `;
                    vaultList.appendChild(item);
                });

            } catch (error) {
                console.error('Error loading vault:', error);
                if (vaultEmpty) vaultEmpty.innerHTML = `<p class="text-red-400">Error loading vault: ${error.message}</p>`;
            }
        }

        /**
         * Download document from vault
         */
        function downloadFromVault(envelopeId) {
            // Redirect to the signing API which returns the PDF
            window.open(`https://us-central1-sirsi-opensign.cloudfunctions.net/api/api/envelopes/${envelopeId}/pdf?guest=true`, '_blank');
        }

        // ============================================
        // GLOBAL STATE
        // ============================================
        let currentStep = 1;
        let msaExecuted = false;
        // selectedPlan is already declared at the top of the script

        /**
         * Download MSA as PDF using browser print dialog
         * Opens the standalone printable MSA document in a new window.
         * This document uses the exact template from Sirsi_Contract_and_SOW.html with:
         * - Clean white background (no app UI)
         * - Merriweather body text, Cinzel headers
         * - 1-inch margins with page headers/footers
         * - CONFIDENTIAL watermark
         * - Page breaks before each section
         */
        function downloadMSAPDF() {
            // Open the standalone printable MSA in a new window
            // This provides a clean document without app UI that can be printed properly
            const printWindow = window.open('printable-msa.html', '_blank', 'width=900,height=700,scrollbars=yes');

            // Auto-trigger print dialog after page loads
            if (printWindow) {
                printWindow.onload = function () {
                    // Short delay to ensure styles are loaded
                    setTimeout(() => {
                        printWindow.print();
                    }, 500);
                };
            } else {
                // Fallback if popup blocked - just navigate
                alert('Please allow popups for this site to download the PDF, or visit printable-msa.html directly.');
                window.location.href = 'printable-msa.html';
            }
        }

        /**
         * Updates Exhibit B (Payment Schedule) in the Contract Tab
         */
        function updateExhibitB(planName) {
            const dynamicBlock = document.getElementById('exhibit-b-dynamic');
            if (!dynamicBlock) return;

            let planContent = '';
            // Normalize plan selection
            const isPlan1 = (planName || '').includes('Plan 1');
            const isPlan2 = (planName || '').includes('Plan 2');
            const isPlan3 = (planName || '').includes('Plan 3');

            if (isPlan1) {
                planContent = `
                    <h3>5. Payment Schedule (Plan 1: 2 Payments)</h3>
                    <p>Two equal payments for simplified billing.</p>
                    <table class="w-full text-left border-collapse mt-4">
                        <tr class="border-b border-white/10"><td class="py-2">Payment 1 (Signing)</td><td class="text-right text-[#C8A951]">$47,500</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Payment 2 (Delivery)</td><td class="text-right text-[#C8A951]">$47,500</td></tr>
                    </table>
                    <p class="mt-4 text-sm font-bold opacity-60">Total Contract Value: $95,000 USD</p>
                `;
            } else if (isPlan2) {
                planContent = `
                    <h3>5. Payment Schedule (Plan 2: 3 Monthly Payments)</h3>
                    <p>Recommended: Balanced cash flow over 3 months.</p>
                    <table class="w-full text-left border-collapse mt-4">
                        <tr class="border-b border-white/10"><td class="py-2">Month 1 (Signing)</td><td class="text-right text-[#C8A951]">$31,666</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 2</td><td class="text-right text-[#C8A951]">$31,666</td></tr>
                        <tr><td class="py-2">Month 3</td><td class="text-right text-[#C8A951]">$31,668</td></tr>
                    </table>
                    <p class="mt-4 text-sm font-bold opacity-60">Total Contract Value: $95,000 USD</p>
                `;
            } else if (isPlan3) {
                planContent = `
                    <h3>5. Payment Schedule (Plan 3: 4 Monthly Payments)</h3>
                    <p>Extended flexibility spread across 4 months.</p>
                    <table class="w-full text-left border-collapse mt-4">
                        <tr class="border-b border-white/10"><td class="py-2">Month 1 (Signing)</td><td class="text-right text-[#C8A951]">$23,750</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 2</td><td class="text-right text-[#C8A951]">$23,750</td></tr>
                        <tr class="border-b border-white/10"><td class="py-2">Month 3</td><td class="text-right text-[#C8A951]">$23,750</td></tr>
                        <tr><td class="py-2">Month 4</td><td class="text-right text-[#C8A951]">$23,750</td></tr>
                    </table>
                    <p class="mt-4 text-sm font-bold opacity-60">Total Contract Value: $95,000 USD</p>
                `;
            } else {
                // Default fallback if unknown
                planContent = `<p class="text-red-400">Please select a valid payment plan.</p>`;
            }

            dynamicBlock.innerHTML = planContent;
            dynamicBlock.classList.remove('opacity-60', 'italic', 'text-center');
            dynamicBlock.style.background = 'rgba(200, 169, 81, 0.05)';
            dynamicBlock.style.borderColor = 'rgba(200, 169, 81, 0.5)';
        }

        // Select plan from COST tab and navigate to MSA
        function selectPlanFromCost(planName, btnElement) {
            selectedPlan = planName;
            // Persist plan selection to sessionStorage for page navigation
            sessionStorage.setItem('selectedPlan', planName);

            // Update Exhibit B with DYNAMIC pricing (includes add-ons)
            updateExhibitBDynamic(planName);

            // Reset all buttons in COST tab
            const costTab = document.getElementById('cost');
            if (costTab) {
                costTab.querySelectorAll('.select-plan-btn').forEach(b => {
                    b.innerHTML = 'SELECT PLAN';
                    b.style.background = 'linear-gradient(to right, #C8A951, #E2C76B)';
                });
                costTab.querySelectorAll('.plan-card-static').forEach(c => {
                    c.style.borderColor = 'rgba(255,255,255,0.15)';
                    c.style.boxShadow = 'none';
                });
            }

            // Highlight selected card and button
            const card = btnElement.closest('.plan-card-static');
            if (card) {
                card.style.borderColor = '#C8A951';
                card.style.boxShadow = '0 0 30px rgba(200,169,81,0.3)';
            }
            btnElement.innerHTML = '✓ SELECTED';

            // Update stepper to show Step 1 complete
            currentStep = 1;
            updateStepperStatus(1);

            // Update MSA tab to show selected plan and skip duplicate selection
            const selectionPhase = document.getElementById('selection-phase');
            if (selectionPhase) {
                selectionPhase.style.display = 'none';
            }

            // Update "Selected Plan" display in MSA headers
            const planLockNotice = document.getElementById('plan-lock-notice');
            if (planLockNotice) {
                planLockNotice.style.color = '#10B981';
                planLockNotice.innerHTML = `✓ ${planName} Selected`;
            }

            // Update signature block display
            const selectedPlanDisplay = document.getElementById('selected-plan-display');
            if (selectedPlanDisplay) {
                selectedPlanDisplay.textContent = planName;
            }

            // Scroll to Next button
            const nextBtn = costTab.querySelector('button[onclick*="switchTab"]');
            if (nextBtn) {
                nextBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // Legacy/Direct selection form Contract Tab (if applicable)
        function selectContractPlan(planName, btnElement) {
            currentStep = 3;
            updateStepperStatus(3);

            // 1. Reset UI
            document.querySelectorAll('.plan-card-static').forEach(c => {
                c.style.borderColor = 'rgba(255, 255, 255, 0.1)';
                c.style.backgroundColor = 'rgba(0, 0, 0, 0.4)';
            });
            document.querySelectorAll('.select-plan-btn').forEach(b => {
                b.innerHTML = 'SELECT PLAN';
                b.style.backgroundColor = 'transparent';
                b.style.color = '#C8A951';
            });

            // 2. Activate Selected (if button exists)
            if (btnElement) {
                const card = btnElement.closest('.plan-card-static');
                if (card) {
                    card.style.borderColor = '#C8A951';
                    card.style.backgroundColor = 'rgba(200, 169, 81, 0.05)';
                }
                btnElement.innerHTML = 'SELECTED';
                btnElement.style.backgroundColor = '#C8A951';
                btnElement.style.color = '#000000';
            }

            // 3. Update Step 3 Label
            const step3Label = document.getElementById('step-3-label');
            if (step3Label) {
                step3Label.classList.remove('opacity-0');
                step3Label.classList.add('opacity-100');
            }

            // 4. Update Exhibit B
            updateExhibitB(planName);

            // 5. Ensure Signature Block is Visible
            const signatureBlock = document.getElementById('signature-block');
            if (signatureBlock) {
                signatureBlock.classList.remove('opacity-0', 'pointer-events-none', 'hidden', 'invisible');
                signatureBlock.style.opacity = '1';
                signatureBlock.style.pointerEvents = 'auto';
                signatureBlock.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            // 6. Reveal MSA Action Bar
            const msaFab = document.getElementById('msa-fab');
            if (msaFab) {
                msaFab.classList.remove('opacity-0', 'pointer-events-none');
                msaFab.classList.add('opacity-100');
                updateMSAState('draft');
            }
        }

        // Dynamic Date Population & Plan State Restoration
        document.addEventListener('DOMContentLoaded', function () {
            const today = new Date();
            const year = today.getFullYear();

            // Format: December 18, 2025
            const longDate = today.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            // Format: 12/18/2025
            const shortDate = today.toLocaleDateString('en-US', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            });

            // Populate all date elements
            const dateElements = {
                'date-proposal': longDate,
                'date-sow': longDate,
                'year-ref': year,
                'year-msa': year,
                'date-msa-global': longDate,
                'date-msa-effective': longDate,
                'year-sow-exhibit': year,
                'year-msa-exhibit': year,
                'date-exhibit-a': longDate,
                'date-exhibit-b': longDate,
                'date-signature': 'Pending Execution'
            };

            for (const [id, value] of Object.entries(dateElements)) {
                const el = document.getElementById(id);
                if (el) el.textContent = value;
            }

            // RESTORE SELECTED PLAN FROM SESSION STORAGE
            const storedPlan = sessionStorage.getItem('selectedPlan');
            if (storedPlan) {
                selectedPlan = storedPlan;

                // Update Exhibit B immediately
                updateExhibitB(storedPlan);

                // FIX 1: Hide plan selection in MSA since already selected
                const selectionPhase = document.getElementById('selection-phase');
                if (selectionPhase) {
                    selectionPhase.style.display = 'none';
                }

                // Update the selected plan display in signature block
                const selectedPlanDisplay = document.getElementById('selected-plan-display');
                if (selectedPlanDisplay) {
                    selectedPlanDisplay.textContent = storedPlan;
                }
                // Update plan lock notice if exists
                const planLockNotice = document.getElementById('plan-lock-notice');
                if (planLockNotice) {
                    planLockNotice.style.color = '#10B981';
                    planLockNotice.innerHTML = `✓ ${storedPlan} Selected`;
                }
                // Mark the correct plan card as selected in Cost tab
                const costTab = document.getElementById('cost');
                if (costTab) {
                    let cardId = '';
                    if (storedPlan.includes('1')) cardId = 'plan-1-card';
                    else if (storedPlan.includes('2')) cardId = 'plan-2-card';
                    else if (storedPlan.includes('3')) cardId = 'plan-3-card';

                    if (cardId) {
                        const card = document.getElementById(cardId);
                        if (card) {
                            card.style.borderColor = '#C8A951';
                            card.style.boxShadow = '0 0 30px rgba(200,169,81,0.3)';
                            const btn = card.querySelector('.select-plan-btn');
                            if (btn) btn.innerHTML = '✓ SELECTED';
                        }
                    }
                }
                console.log('Restored plan from session:', storedPlan);
            }
        });


        // ============================================
        // SCROLL DETECTION FOR MSA
        // ============================================
        let msaScrollComplete = false;

        document.addEventListener('DOMContentLoaded', function () {
            const scrollBox = document.getElementById('legal-scroll-container');
            const contractDoc = document.getElementById('contract-document');
            const msaStatusLine = document.getElementById('msa-status-line');
            const msaStatusText = document.getElementById('msa-status-text');
            const msaAckBlock = document.getElementById('msa-acknowledgment-block');
            const msaAckLabel = document.getElementById('msa-ack-label');
            const msaCheckbox = document.getElementById('msa-read-acknowledge');
            const verticalGuide = document.getElementById('vertical-workflow-guide');

            if (scrollBox) {
                // Use scroll position check instead of IntersectionObserver
                // because msaAckBlock is now OUTSIDE the scroll container
                scrollBox.addEventListener('scroll', function () {
                    if (msaScrollComplete) return;

                    const scrollTop = scrollBox.scrollTop;
                    const scrollHeight = scrollBox.scrollHeight;
                    const clientHeight = scrollBox.clientHeight;

                    // Trigger when user is within 50px of the bottom
                    if (scrollTop + clientHeight >= scrollHeight - 50) {
                        msaScrollComplete = true;

                        // Unlock the acknowledgment block
                        if (msaAckBlock) {
                            msaAckBlock.style.opacity = '1';
                            msaAckBlock.style.pointerEvents = 'auto';
                        }

                        // Update Status
                        if (msaStatusLine) {
                            msaStatusLine.innerHTML = `✅ <span class="text-[#10B981] uppercase tracking-wider text-xs">Step 2 of 3:</span> <span id="msa-status-text">Agreement Read. Please check the box below to acknowledge.</span>`;
                        }

                        // Enable the checkbox
                        if (msaAckLabel) {
                            msaAckLabel.style.pointerEvents = 'auto';
                            msaAckLabel.style.opacity = '1';
                        }
                        if (msaCheckbox) {
                            msaCheckbox.disabled = false;
                        }
                    }
                });
            }

            // ============================================
            // VERTICAL PROGRESS TRACKING
            // ============================================
            const verticalProgressBox = document.getElementById('legal-scroll-container');

            if (verticalProgressBox) {
                verticalProgressBox.addEventListener('scroll', function () {
                    const contractTab = document.getElementById('contract');
                    if (!contractTab || contractTab.style.display === 'none') return;

                    const scrollTop = verticalProgressBox.scrollTop;
                    const scrollHeight = verticalProgressBox.scrollHeight - verticalProgressBox.clientHeight;

                    // Always ensure it's unhidden when on the right tab
                    if (verticalGuide) verticalGuide.style.display = 'flex';

                    // Show/Hide Vertical Guide based on scroll
                    if (scrollTop > 20) {
                        verticalGuide.classList.remove('opacity-0', 'pointer-events-none');
                        verticalGuide.classList.add('opacity-100', 'pointer-events-auto');
                    } else {
                        verticalGuide.classList.add('opacity-0', 'pointer-events-none');
                        verticalGuide.classList.remove('opacity-100', 'pointer-events-auto');
                    }

                    // Simple 0-100 calculation for the internal box
                    const progress = (scrollTop / scrollHeight) * 100;

                    let finalProgress = Math.max(0, Math.min(100, progress));

                    // Update vertical fill (Step 1 is the first 33%)
                    const progressFill = document.getElementById('v-progress-fill');
                    if (progressFill && currentStep === 1) {
                        progressFill.style.height = (finalProgress / 3) + "%";
                    }
                });
            }

            // ============================================
            // GLOBAL HYBRID PROGRESS (Steps 2 & 3)
            // ============================================
            const globalScroller = document.getElementById('contract-immersive-wrapper');
            if (globalScroller) {
                globalScroller.addEventListener('scroll', function () {
                    if (currentStep < 2) return; // Wait for Step 1 completion

                    const scrollTop = globalScroller.scrollTop;
                    const scrollHeight = globalScroller.scrollHeight - globalScroller.clientHeight;

                    // Always show guide when on MSA phase
                    const contractTab = document.getElementById('contract');
                    if (contractTab && contractTab.style.display !== 'none' && verticalGuide) {
                        verticalGuide.style.display = 'flex';
                        verticalGuide.classList.remove('opacity-0', 'pointer-events-none');
                        verticalGuide.classList.add('opacity-100', 'pointer-events-auto');
                    }

                    // Calculate progress for Steps 2 & 3
                    // Step 2 starts at ~33% and ends at ~66%
                    // Step 3 starts at ~66% and ends at 100%

                    const progressFill = document.getElementById('v-progress-fill');
                    if (progressFill) {
                        if (currentStep === 2) {
                            // Map scroll from 0 to 50% of page to 33-66% of bar
                            // (This is a heuristic since plans are at the top)
                            let globalProgress = (scrollTop / (scrollHeight * 0.5)) * 33.3;
                            progressFill.style.height = (33.3 + Math.min(33.3, globalProgress)) + "%";
                        } else if (currentStep === 3) {
                            // Map scroll from 50% to 100% of page to 66-100% of bar
                            let globalProgress = ((scrollTop - (scrollHeight * 0.5)) / (scrollHeight * 0.5)) * 33.3;
                            progressFill.style.height = (66.6 + Math.min(33.3, Math.max(0, globalProgress))) + "%";
                        }
                    }
                });
            }
        });

        function updateStepperStatus(step) {
            const vNodes = [
                document.getElementById('v-step-1'),
                document.getElementById('v-step-2'),
                document.getElementById('v-step-3')
            ];
            const vProgressFill = document.getElementById('v-progress-fill');

            vNodes.forEach((node, idx) => {
                if (!node) return;
                const circle = node.querySelector('div');
                const label = node.querySelector('span');

                if (idx < step - 1) {
                    // Completed Steps
                    node.classList.remove('opacity-30', 'grayscale');
                    circle.innerHTML = '✓';
                    circle.className = "w-10 h-10 rounded-full bg-[#10B981] border border-[#10B981] text-white flex items-center justify-center font-bold transition-all duration-500 scale-100";
                    label.style.color = '#10B981';
                    label.className = label.className.replace('text-gold', 'text-[#10B981]').replace('text-white/50', 'text-[#10B981]');
                } else if (idx === step - 1) {
                    // Current Step
                    node.classList.remove('opacity-30', 'grayscale');
                    circle.innerHTML = idx + 1;
                    circle.className = "w-10 h-10 rounded-full bg-gold border border-gold/50 text-navy flex items-center justify-center font-bold shadow-[0_0_20px_rgba(200,169,81,0.3)] transition-all duration-500 scale-110";
                    label.style.color = '#C8A951';
                } else {
                    // Future Steps
                    node.classList.add('opacity-30', 'grayscale');
                    circle.innerHTML = idx + 1;
                    circle.className = "w-10 h-10 rounded-full bg-[#0f172a] border border-white/20 text-white flex items-center justify-center font-bold transition-all duration-500 scale-100";
                    label.style.color = 'rgba(255,255,255,0.5)';
                }
            });

            if (vProgressFill) {
                if (step === 1) {
                    // Handled by internal scroll listener v1.1.0
                } else if (step === 2) {
                    vProgressFill.style.height = '66.6%'; // Move to end of Step 2
                } else if (step === 3) {
                    vProgressFill.style.height = '100%';
                }
            }
        }

        function unlockPlanSelection() {
            const checkbox = document.getElementById('msa-read-acknowledge');
            const proceedBtn = document.getElementById('proceed-to-step2');
            const msaStatusLine = document.getElementById('msa-status-line');
            const step3Label = document.getElementById('step-3-label');
            const signatureBlock = document.getElementById('signature-block');

            // FIX 2 & 3: Validate that a plan was selected before allowing Step 3
            const storedPlan = sessionStorage.getItem('selectedPlan') || selectedPlan;

            if (!storedPlan) {
                console.warn('Cannot proceed to Step 3 without selecting a plan first');
                if (checkbox) checkbox.checked = false;
                alert('Please select a plan from the Cost & Valuation tab before proceeding.');
                return;
            }

            if (checkbox && proceedBtn) {
                if (checkbox.checked) {
                    // MSA acknowledged - move to Step 3
                    currentStep = 3;
                    updateStepperStatus(3);

                    // Ensure plan is displayed in Step 3
                    const selectedPlanDisplay = document.getElementById('selected-plan-display');
                    if (selectedPlanDisplay) {
                        selectedPlanDisplay.textContent = storedPlan;
                    }

                    proceedBtn.disabled = false;
                    proceedBtn.style.opacity = '1';
                    proceedBtn.style.cursor = 'pointer';
                    proceedBtn.style.boxShadow = '0 4px 20px rgba(200, 169, 81, 0.3)';

                    if (msaStatusLine) {
                        msaStatusLine.innerHTML = `✨ <span class="text-[#10B981] uppercase tracking-wider text-xs">Step 2 Complete:</span> <span id="msa-status-text">Acknowledged. Click below to proceed to signature.</span>`;
                    }

                    // Reveal Step 3 label
                    if (step3Label) {
                        step3Label.classList.remove('opacity-0');
                        step3Label.classList.add('opacity-100');
                    }

                    // Reveal signature block
                    if (signatureBlock) {
                        signatureBlock.classList.remove('opacity-0', 'pointer-events-none');
                        signatureBlock.style.opacity = '1';
                        signatureBlock.style.pointerEvents = 'auto';
                    }
                } else {
                    // Unchecked - go back to Step 2
                    currentStep = 2;
                    updateStepperStatus(2);

                    proceedBtn.disabled = true;
                    proceedBtn.style.opacity = '0.5';
                    proceedBtn.style.cursor = 'not-allowed';
                    proceedBtn.style.boxShadow = 'none';

                    if (msaStatusLine) {
                        msaStatusLine.innerHTML = `✅ <span class="text-[#10B981] uppercase tracking-wider text-xs">Step 2 of 3:</span> <span id="msa-status-text">Agreement Read. Please check the box below to acknowledge.</span>`;
                    }

                    // Hide Step 3 label
                    if (step3Label) {
                        step3Label.classList.remove('opacity-100');
                        step3Label.classList.add('opacity-0');
                    }
                }
            }
        }

        function scrollToSignature() {
            // Already at Step 3 from unlockPlanSelection, just scroll to signature
            const signatureBlock = document.getElementById('signature-block');
            const step3Label = document.getElementById('step-3-label');

            // Ensure signature block is visible
            if (signatureBlock) {
                signatureBlock.classList.remove('opacity-0', 'pointer-events-none');
                signatureBlock.style.opacity = '1';
                signatureBlock.style.pointerEvents = 'auto';
            }

            // Ensure Step 3 label is visible
            if (step3Label) {
                step3Label.classList.remove('opacity-0');
                step3Label.classList.add('opacity-100');
            }

            // Scroll to signature
            requestAnimationFrame(() => {
                if (step3Label) {
                    step3Label.scrollIntoView({ behavior: 'smooth', block: 'start' });
                } else if (signatureBlock) {
                    signatureBlock.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        }

        function updateMSAState(state) {
            const msaDownloadLabel = document.getElementById('msa-download-label');
            const msaDownloadBtn = document.getElementById('msa-download-btn');
            const msaEmailLabel = document.getElementById('msa-email-label');
            const msaEmailBtn = document.getElementById('msa-email-btn');
            const msaPrintLabel = document.getElementById('msa-print-label');
            const msaPrintBtn = document.getElementById('msa-print-btn');

            if (state === 'executed') {
                msaExecuted = true;
                // Label updates
                if (msaDownloadLabel) msaDownloadLabel.textContent = 'Download Executed MSA';
                if (msaEmailLabel) msaEmailLabel.textContent = 'Email Executed MSA';
                if (msaPrintLabel) msaPrintLabel.textContent = 'Print Executed MSA';

                // Button tooltips
                if (msaDownloadBtn) msaDownloadBtn.title = 'Download Executed MSA';
                if (msaEmailBtn) msaEmailBtn.title = 'Email Executed MSA to myself';
                if (msaPrintBtn) msaPrintBtn.title = 'Print Executed MSA';

                // Specific Styling for prominence
                if (msaDownloadBtn) msaDownloadBtn.style.background = 'linear-gradient(135deg, #10B981, #059669)';
            } else {
                msaExecuted = false;
                // Draft State (Default)
                if (msaDownloadLabel) msaDownloadLabel.textContent = 'Download Draft';
                if (msaEmailLabel) msaEmailLabel.textContent = 'Email Draft';
                if (msaPrintLabel) msaPrintLabel.textContent = 'Print Draft';

                if (msaDownloadBtn) msaDownloadBtn.title = 'Download Draft';
                if (msaEmailBtn) msaEmailBtn.title = 'Email Draft to myself';
                if (msaPrintBtn) msaPrintBtn.title = 'Print Draft';

                if (msaDownloadBtn) msaDownloadBtn.style.background = 'linear-gradient(135deg, #C8A951, #E2C76B)';
            }
        }

        async function downloadTabPdf(e, tabId, filename) {
            const btn = e ? e.target.closest('button') : null;
            const originalHTML = btn ? btn.innerHTML : '';

            if (btn) {
                btn.innerHTML = '<svg class="animate-spin" width="16" height="16" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" opacity="0.3"></circle><path fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>';
                btn.disabled = true;
                btn.title = "Generating High-Fidelity PDF...";
            }

            try {
                // Determine target element or document
                let elementId = tabId === 'contract' ? 'contract-document' : tabId;

                // Attempt OpenSign Rendering
                const pdfData = await downloadPdfviaOpenSign(elementId, filename);

                if (pdfData) {
                    const link = document.createElement('a');
                    link.href = `data:application/pdf;base64,${pdfData}`;
                    link.download = filename;
                    link.click();
                } else {
                    console.warn('OpenSign Render returned no data, falling back to browser print.');
                    const usePrint = confirm('High-fidelity PDF generation failed or timed out.\n\nWould you like to use the browser\'s standard print dialog instead?');
                    if (usePrint) window.print();
                }
            } catch (err) {
                console.error('Download error:', err);
                const usePrint = confirm('An error occurred during PDF generation.\n\nUse browser standard print instead?');
                if (usePrint) window.print();
            } finally {
                if (btn) {
                    btn.innerHTML = originalHTML;
                    btn.disabled = false;
                    btn.title = tabId === 'contract' ? 'Download as PDF' : 'Download PDF';
                }
            }
        }

        /**
         * Generic PDF download utility via OpenSign Render API
         */
        async function downloadPdfviaOpenSign(elementId, filename) {
            const element = document.getElementById(elementId);
            if (!element) return;

            try {
                // Construct styles
                const styles = Array.from(document.styleSheets)
                    .map(sheet => {
                        try {
                            return Array.from(sheet.cssRules).map(rule => rule.cssText).join('');
                        } catch (e) { return ''; }
                    }).join('');

                const htmlContent = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
                        <style>
                            ${styles}
                            body { background: white !important; color: #1e293b !important; padding: 40px; font-family: 'Inter', sans-serif; }
                            .glass-panel { background: rgba(0, 0, 0, 0.02); border: 1px solid rgba(0, 0, 0, 0.1); }
                            .tab-content { display: block !important; opacity: 1 !important; }
                        </style>
                    </head>
                    <body>
                        <div class="legal-viewer" id="contract-document">
                            ${element.innerHTML}
                        </div>
                    </body>
                    </html>
                `;

                // Call OpenSign Render API
                // Note: In production, this uses Firebase Auth for 'authenticate' middleware
                const user = firebase.auth().currentUser;
                const idToken = user ? await user.getIdToken() : '';

                const response = await fetch('https://sign.sirsi.ai/api/render', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${idToken}`
                    },
                    body: JSON.stringify({
                        html: htmlContent,
                        filename: filename
                    })
                });

                const result = await response.json();
                if (result.success && result.pdfBase64) return result.pdfBase64;
                throw new Error(result.message || 'Rendering failed');
            } catch (error) {
                console.warn('OpenSign Render failed:', error);
                // Fallback to local high-fidelity print or jsPDF
                return null;
            }
        }

        async function downloadMSAPdf(e) {
            // 1. Get Data from Session/Auth
            const user = window.AuthService ? window.AuthService.getCurrentUser() : null;
            let clientName = user?.displayName || 'Tameeka Lockhart'; // Default for demo/context

            // If Guest Modal has data, use it (though likely user hasn't filled it yet for simple download)
            const guestNameInput = document.getElementById('guest-name');
            if (!user && guestNameInput && guestNameInput.value) {
                clientName = guestNameInput.value;
            }

            const storedPlan = sessionStorage.getItem('selectedPlan') || (window.selectedPlan ? window.selectedPlan : 'Unified Plan 1');
            const dateStr = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });

            // 2. Build URL Parameters
            // Map: Unified Plan 1 -> 1, Unified Plan 2 -> 2, Unified Plan 3 -> 3
            let planCode = '1';
            if (storedPlan.includes('Plan 2')) planCode = '2';
            if (storedPlan.includes('Plan 3')) planCode = '3';

            const params = new URLSearchParams({
                plan: planCode,
                client: clientName,
                date: dateStr,
                address: '[Client Address]' // Placeholder until profile integration
            });

            // 3. Open Popup Window (Centered)
            const width = 1000;
            const height = 900;
            const left = (window.screen.width - width) / 2;
            const top = (window.screen.height - height) / 2;

            const popup = window.open(
                `printable-msa.html?${params.toString()}`,
                'MSA_Print_Preview',
                `width=${width},height=${height},top=${top},left=${left},scrollbars=yes,resizable=yes`
            );

            if (!popup) {
                alert('Please allow popups for this website to view the printable Agreement.');
            }
        }

        async function emailMSAToSelf(e) {
            const user = firebase.auth().currentUser;
            if (!user || !user.email) {
                alert('Please log in to use this feature.');
                return;
            }

            const contractDoc = document.getElementById('contract-document');
            if (!contractDoc) {
                alert('Contract document not found.');
                return;
            }

            const confirmSend = confirm(`Send the Master Services Agreement to:\n${user.email}?`);
            if (!confirmSend) return;

            const btn = e ? e.target.closest('button') : document.querySelector('#msa-fab button:nth-child(2)');
            const originalHTML = btn.innerHTML;
            btn.innerHTML = '<svg class="animate-spin" width="20" height="20" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke="#C8A951" stroke-width="3" opacity="0.3"></circle><path fill="#C8A951" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>';
            btn.disabled = true;

            try {
                // 1. Attempt OpenSign Render
                let pdfBase64 = await downloadPdfviaOpenSign('contract-document', 'MSA.pdf');

                // 2. Client-side fallback if OpenSign is unavailable/WIP
                if (!pdfBase64 && typeof html2pdf !== 'undefined') {
                    const opt = {
                        margin: [0.5, 0.5, 0.5, 0.5],
                        filename: 'Legacy_Estate_OS_MSA.pdf',
                        html2canvas: { scale: 2, useCORS: true },
                        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
                    };
                    pdfBase64 = await html2pdf().set(opt).from(contractDoc).outputPdf('datauristring').then(d => d.split(',')[1]);
                }

                if (!pdfBase64) {
                    throw new Error('Could not generate PDF attachment. Please try downloading instead.');
                }

                // 3. Call Firebase Function to send email
                const sendContractEmail = firebase.functions().httpsCallable('sendContractEmail');
                await sendContractEmail({
                    email: user.email,
                    pdfBase64: pdfBase64,
                    documentType: 'Master Services Agreement'
                });

                alert(`✅ Agreement sent to ${user.email}!`);
            } catch (err) {
                console.error('Email error:', err);
                alert(err.message || 'Error sending email. Please try downloading instead.');
            } finally {
                btn.innerHTML = originalHTML;
                btn.disabled = false;
            }
        }

        // ============================================
        // ACKNOWLEDGMENT TOGGLE (Step 3 - Execute)
        // ============================================
        function toggleExecuteButton() {
            const checkbox = document.getElementById('msa-acknowledge');
            const button = document.getElementById('execute-btn');

            if (checkbox && button) {
                if (checkbox.checked) {
                    button.disabled = false;
                    button.style.opacity = '1';
                    button.style.cursor = 'pointer';
                    button.style.backgroundColor = '#C8A951'; // Force background
                    button.style.color = '#000000';
                    button.style.boxShadow = '0 4px 20px rgba(200, 169, 81, 0.3)';
                } else {
                    button.disabled = true;
                    button.style.opacity = '0.5';
                    button.style.cursor = 'not-allowed';
                    button.style.boxShadow = 'none';
                    // Keep background but dim it via opacity
                    button.style.backgroundColor = '#C8A951';
                }
            }
        }
    </script>



    <!-- Firebase SDK (Modular) -->
    <script type="module">
        import { AuthService } from '../../assets/js/firebase-init.js';
        window.AuthService = AuthService;
    </script>

    <script>
        // ============================================
        // MODAL LOGIC (Simple div-based)
        // ============================================
        let guestModalResolve = null;

        function showGuestModal() {
            return new Promise((resolve) => {
                guestModalResolve = resolve;
                const modal = document.getElementById('guest-signer-modal');
                modal.classList.add('active');
                document.getElementById('guest-name').focus();
            });
        }

        function hideGuestModal() {
            const modal = document.getElementById('guest-signer-modal');
            modal.classList.remove('active');
            document.getElementById('guest-name').value = '';
            document.getElementById('guest-email').value = '';
        }

        function confirmGuestModal() {
            const name = document.getElementById('guest-name').value.trim();
            const email = document.getElementById('guest-email').value.trim();

            if (!name || !email) {
                alert('Both Name and Email are required.');
                return;
            }
            if (!email.includes('@')) {
                alert('Please enter a valid email address.');
                return;
            }

            if (guestModalResolve) {
                guestModalResolve({ name, email });
                hideGuestModal();
            }
        }

        function cancelGuestModal() {
            if (guestModalResolve) {
                guestModalResolve(null); // Return null to indicate cancellation
                hideGuestModal();
            }
        }

        // ============================================
        // OPENSIGN INTEGRATION
        // ============================================

        async function initiateOpenSign() {
            const grandTotal = calculateGrandTotal();
            const storedPlan = sessionStorage.getItem('selectedPlan') || selectedPlan || 'Unified Plan 1';

            let amount = 0;
            if (storedPlan.includes('Plan 1')) {
                amount = Math.round(grandTotal / 2);
            } else if (storedPlan.includes('Plan 2')) {
                amount = Math.floor(grandTotal / 3);
            } else if (storedPlan.includes('Plan 3')) {
                amount = Math.round(grandTotal / 4);
            } else {
                amount = grandTotal; // Fallback
            }

            console.log('INITIATING STREAMLINED SIGNING FLOW - SKIPPING MODAL');
            const targetUrl = `/sign.html?project=${PROJECT_ID}&plan=${encodeURIComponent(storedPlan)}&amount=${amount}.00`;

            console.log('Directing to consolidated signing page:', targetUrl);
            window.location.href = targetUrl;
        }

        // ============================================
        // POST-SIGNATURE PAYMENT REDIRECT
        // ============================================
        // Check URL for signature completion callback
        document.addEventListener('DOMContentLoaded', function () {
            const urlParams = new URLSearchParams(window.location.search);

            // OpenSign will redirect back with status parameters
            if (urlParams.get('signature_complete') === 'true' ||
                urlParams.get('event') === 'signing_complete') {

                // Update UI to show completion
                const signatureBlock = document.getElementById('signature-block');
                const executeBtn = document.getElementById('execute-btn');
                const signatureDateEl = document.getElementById('date-signature');

                if (signatureDateEl) {
                    signatureDateEl.textContent = new Date().toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                }

                if (executeBtn) {
                    executeBtn.innerHTML = '✓ Agreement Executed';
                    executeBtn.disabled = true;
                    executeBtn.style.backgroundColor = '#10B981';
                    executeBtn.classList.remove('bg-[#C8A951]');
                    executeBtn.classList.add('bg-[#10B981]');
                }

                updateMSAState('executed');
                updateStepperStatus(3);

                // Show payment redirect modal -> NOW DEDICATED PAGE
                // Requirement: Auto-open Signed PDF Popup
                setTimeout(() => {
                    downloadMSAPdf(); // Triggers the popup
                }, 500);

                setTimeout(() => {
                    const storedPlan = sessionStorage.getItem('selectedPlan') || 'Unified Plan 1';
                    const PLAN_AMOUNTS = {
                        'Unified Plan 1': '47500',
                        'Unified Plan 2': '31666',
                        'Unified Plan 3': '23750'
                    };
                    const amount = PLAN_AMOUNTS[storedPlan] || '47500';
                    const envelopeId = sessionStorage.getItem('envelopeId') || urlParams.get('envelope') || '';
                    window.location.href = `payment.html?amount=${amount}&ref=MSA-V1&envelope=${envelopeId}`;
                }, 3000); // Increased delay to allow popup to appear properly
            }
        });
    </script>




    <!-- Vertical Workflow Guide (Fixed Right) -->
    <div id="vertical-workflow-guide"
        class="fixed right-8 top-1/2 -translate-y-1/2 z-[99999] flex flex-col items-center gap-12 no-print transition-all duration-500 opacity-0 pointer-events-none"
        style="display: none;">
        <!-- Vertical Progress Line (Background) -->
        <div class="absolute top-4 bottom-4 w-[2px] bg-white/10 z-0"></div>
        <div id="v-progress-fill"
            class="absolute top-4 w-[2px] bg-gold z-0 transition-all duration-300 shadow-[0_0_10px_rgba(200,169,81,0.5)]"
            style="height: 0%;"></div>

        <!-- Step 1: Select Plan -->
        <div id="v-step-1" class="relative z-10 group flex flex-col items-center">
            <div
                class="w-12 h-12 rounded-full bg-gold border border-gold/50 text-navy flex items-center justify-center font-bold shadow-[0_0_20px_rgba(200,169,81,0.5)] transition-all duration-500 scale-110">
                1</div>
            <span
                class="absolute right-16 top-1/2 -translate-y-1/2 bg-[#0f172a]/95 backdrop-blur-md border border-gold/40 px-5 py-3 rounded-lg font-serif text-[11px] uppercase tracking-[0.25em] text-gold opacity-0 group-hover:opacity-100 transition-all duration-300 whitespace-nowrap pointer-events-none translate-x-4 group-hover:translate-x-0 shadow-2xl">Select
                Plan</span>
        </div>

        <!-- Step 2: Review MSA -->
        <div id="v-step-2"
            class="relative z-10 group flex flex-col items-center opacity-30 grayscale transition-all duration-500">
            <div
                class="w-12 h-12 rounded-full bg-[#0f172a] border border-white/20 text-white flex items-center justify-center font-bold transition-all duration-500">
                2</div>
            <span
                class="absolute right-16 top-1/2 -translate-y-1/2 bg-[#0f172a]/95 backdrop-blur-md border border-white/20 px-5 py-3 rounded-lg font-serif text-[11px] uppercase tracking-[0.25em] text-white/60 opacity-0 group-hover:opacity-100 transition-all duration-300 whitespace-nowrap pointer-events-none translate-x-4 group-hover:translate-x-0 shadow-2xl">Review
                MSA</span>
        </div>

        <!-- Step 3: Sign -->
        <div id="v-step-3"
            class="relative z-10 group flex flex-col items-center opacity-30 grayscale transition-all duration-500">
            <div
                class="w-12 h-12 rounded-full bg-[#0f172a] border border-white/20 text-white flex items-center justify-center font-bold transition-all duration-500">
                3</div>
            <span
                class="absolute right-16 top-1/2 -translate-y-1/2 bg-[#0f172a]/95 backdrop-blur-md border border-white/20 px-5 py-3 rounded-lg font-serif text-[11px] uppercase tracking-[0.25em] text-white/60 opacity-0 group-hover:opacity-100 transition-all duration-300 whitespace-nowrap pointer-events-none translate-x-4 group-hover:translate-x-0 shadow-2xl">Sign</span>
        </div>
    </div>

    <!-- Guest Signer Modal - Simple div-based, no native dialog quirks -->
    <div id="guest-signer-modal" class="modal-overlay">
        <div class="w-full max-w-md bg-[#0f172a] p-8 rounded-2xl border border-gold/30 text-left">
            <!-- Modal Header -->
            <div class="mb-6 text-center">
                <div class="mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-gold/10 text-gold">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </div>
                <h3 class="font-serif text-2xl text-gold">Signer Identity</h3>
                <p class="mt-2 text-sm text-gray-400">Please provide your details to authenticate this digital
                    signature.</p>
            </div>

            <!-- Modal Form -->
            <div class="space-y-4">
                <div>
                    <label class="mb-1 block text-xs font-semibold uppercase tracking-wider text-gray-500">Full
                        Name</label>
                    <input type="text" id="guest-name"
                        class="w-full rounded-lg border border-white/10 bg-white/5 px-4 py-3 text-white placeholder-gray-600 focus:border-gold focus:outline-none focus:ring-1 focus:ring-gold"
                        placeholder="e.g. John Doe">
                </div>
                <div>
                    <label class="mb-1 block text-xs font-semibold uppercase tracking-wider text-gray-500">Email
                        Address</label>
                    <input type="email" id="guest-email"
                        class="w-full rounded-lg border border-white/10 bg-white/5 px-4 py-3 text-white placeholder-gray-600 focus:border-gold focus:outline-none focus:ring-1 focus:ring-gold"
                        placeholder="e.g. john@example.com">
                </div>

                <!-- Modal Actions -->
                <div class="mt-8 flex gap-3">
                    <button type="button" onclick="cancelGuestModal()"
                        class="flex-1 rounded-lg border border-white/10 bg-white/5 py-3 text-sm font-semibold text-gray-400 hover:bg-white/10 transition-colors">Cancel</button>
                    <button type="button" onclick="confirmGuestModal()"
                        class="flex-1 rounded-lg bg-gold py-3 text-sm font-semibold text-black hover:bg-[#D4AF37] transition-colors shadow-lg shadow-gold/20">Continue
                        to Sign</button>
                </div>
            </div>
        </div>
    </div>

</body>

</html>