<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog - SirsiNexus Insights</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-functions-compat.js"></script>
    
    <!-- Firebase Auth Module -->
    <script src="assets/js/firebase-auth-module.js" defer></script>
    
    <style>
        .blog-content p { margin-bottom: 1rem; }
        .blog-content h2 { font-size: 1.5rem; font-weight: bold; margin: 2rem 0 1rem; }
        .blog-content h3 { font-size: 1.25rem; font-weight: bold; margin: 1.5rem 0 0.75rem; }
        .blog-content ul, .blog-content ol { margin: 1rem 0; padding-left: 2rem; }
        .blog-content li { margin: 0.5rem 0; }
        .blog-content code { background: #1f2937; padding: 0.25rem 0.5rem; border-radius: 0.25rem; }
        .blog-content pre { background: #1f2937; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin: 1rem 0; }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <!-- Navigation -->
    <nav class="bg-gray-800 border-b border-gray-700">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex">
                    <div class="flex-shrink-0 flex items-center">
                        <a href="/index.html" class="flex items-center">
                            <img class="h-8 w-8" src="assets/images/Sirsi_Logo_300ppi_cguiyg.png" alt="SirsiNexus">
                            <span class="ml-2 text-xl font-bold">SirsiNexus</span>
                        </a>
                    </div>
                    <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
                        <a href="index.html" class="text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Home</a>
                        <a href="about.html" class="text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium">About</a>
                        <a href="blog.html" class="text-white px-3 py-2 rounded-md text-sm font-medium">Blog</a>
                        <a href="documentation.html" class="text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Docs</a>
                        <a href="contact.html" class="text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Contact</a>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div id="auth-status" class="text-sm text-gray-300"></div>
                    <button id="auth-btn" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg text-sm font-medium">
                        Sign In
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="relative bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-5xl font-bold mb-6 bg-gradient-to-r from-blue-400 to-cyan-500 bg-clip-text text-transparent">
                    SirsiNexus Insights
                </h1>
                <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                    Latest updates, technical deep-dives, and industry insights from our team
                </p>
            </div>
        </div>
    </div>

    <!-- Search and Filter Bar -->
    <div class="sticky top-0 z-10 bg-gray-800 border-b border-gray-700 py-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row gap-4">
                <!-- Search -->
                <div class="flex-1">
                    <div class="relative">
                        <input type="text" id="search-input" placeholder="Search articles..." 
                               class="w-full px-4 py-2 pl-10 bg-gray-900 border border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                    </div>
                </div>
                
                <!-- Category Filter -->
                <div class="flex gap-2 flex-wrap">
                    <button onclick="filterByCategory('all')" class="category-btn active bg-blue-600 px-4 py-2 rounded-lg text-sm">All Posts</button>
                    <button onclick="filterByCategory('technical')" class="category-btn bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg text-sm">Technical</button>
                    <button onclick="filterByCategory('product')" class="category-btn bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg text-sm">Product</button>
                    <button onclick="filterByCategory('industry')" class="category-btn bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg text-sm">Industry</button>
                    <button onclick="filterByCategory('company')" class="category-btn bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg text-sm">Company</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Featured Post -->
    <section class="py-12 bg-gray-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div id="featured-post" class="bg-gradient-to-r from-blue-900 to-purple-900 rounded-xl overflow-hidden">
                <!-- Featured post will be loaded dynamically -->
            </div>
        </div>
    </section>

    <!-- Blog Posts Grid -->
    <section class="py-12 bg-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-2xl font-bold mb-8">Latest Articles</h2>
            <div id="blog-posts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Blog posts will be loaded dynamically -->
                <div class="text-center py-12 col-span-full">
                    <i class="fas fa-spinner fa-spin text-4xl text-blue-400"></i>
                    <p class="mt-4 text-gray-400">Loading articles...</p>
                </div>
            </div>
            
            <!-- Load More Button -->
            <div class="text-center mt-12">
                <button id="load-more" onclick="loadMorePosts()" class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg font-semibold hidden">
                    Load More Articles
                </button>
            </div>
        </div>
    </section>

    <!-- Newsletter Subscription -->
    <section class="py-16 bg-gray-900">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-3xl font-bold mb-4">Stay Updated</h2>
            <p class="text-gray-400 mb-8">Get the latest insights delivered to your inbox</p>
            <form id="newsletter-form" class="flex flex-col sm:flex-row gap-4 max-w-md mx-auto">
                <input type="email" placeholder="Enter your email" required
                       class="flex-1 px-4 py-3 bg-gray-800 border border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <button type="submit" class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg font-semibold">
                    Subscribe
                </button>
            </form>
            <div id="newsletter-success" class="hidden mt-4 text-green-400">
                <i class="fas fa-check-circle"></i> Successfully subscribed!
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 border-t border-gray-800 py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p class="text-gray-400">&copy; 2024 SirsiNexus. All rights reserved.</p>
        </div>
    </footer>

    <!-- Blog Post Modal -->
    <div id="blog-modal" class="fixed inset-0 z-50 hidden overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen px-4">
            <div class="fixed inset-0 bg-black bg-opacity-75 transition-opacity" onclick="closeBlogModal()"></div>
            <div class="relative bg-gray-800 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <button onclick="closeBlogModal()" class="absolute top-4 right-4 text-gray-400 hover:text-white">
                    <i class="fas fa-times text-2xl"></i>
                </button>
                <div id="modal-content" class="p-8">
                    <!-- Blog post content will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        let allPosts = [];
        let displayedPosts = 6;
        let currentCategory = 'all';

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            await SirsiAuth.init();
            setupAuthUI();
            loadBlogPosts();
            
            // Search functionality
            document.getElementById('search-input').addEventListener('input', (e) => {
                searchPosts(e.target.value);
            });
        });

        // Setup Auth UI
        function setupAuthUI() {
            SirsiAuth.onAuthStateChanged((user) => {
                const authStatus = document.getElementById('auth-status');
                const authBtn = document.getElementById('auth-btn');
                
                if (user) {
                    authStatus.textContent = `Welcome, ${user.displayName || user.email}`;
                    authBtn.textContent = 'Sign Out';
                    authBtn.onclick = async () => {
                        await SirsiAuth.signOut();
                        window.location.reload();
                    };
                } else {
                    authStatus.textContent = '';
                    authBtn.textContent = 'Sign In';
                    authBtn.onclick = () => {
                        window.location.href = 'signup.html';
                    };
                }
            });
        }

        // Default blog posts data
        const defaultPosts = [
            {
                id: 'post-1',
                title: 'Introducing Quantum-Enhanced Edge Computing',
                excerpt: 'How we\'re leveraging quantum computing to revolutionize edge AI inference with unprecedented speed and efficiency.',
                content: `<h2>The Future of Edge Computing</h2>
                <p>Today, we're excited to announce a breakthrough in edge computing that combines quantum processing with traditional AI inference...</p>
                <h3>Key Benefits</h3>
                <ul>
                    <li>10x faster inference speeds</li>
                    <li>90% reduction in energy consumption</li>
                    <li>Real-time processing at the edge</li>
                </ul>`,
                author: 'Dr. Sarah Chen',
                authorRole: 'Head of Quantum Research',
                date: new Date('2024-01-15'),
                category: 'technical',
                featured: true,
                image: 'https://via.placeholder.com/800x400/1e3a8a/3b82f6?text=Quantum+Computing',
                readTime: '5 min read',
                tags: ['quantum', 'edge computing', 'AI']
            },
            {
                id: 'post-2',
                title: 'SirsiNexus Raises $50M Series B',
                excerpt: 'Led by top-tier VCs, this funding will accelerate our global expansion and R&D efforts.',
                content: `<p>We're thrilled to announce our $50M Series B funding round...</p>`,
                author: 'Michael Torres',
                authorRole: 'CEO',
                date: new Date('2024-01-10'),
                category: 'company',
                featured: false,
                image: 'https://via.placeholder.com/400x300/065f46/10b981?text=Funding+News',
                readTime: '3 min read',
                tags: ['funding', 'growth', 'announcement']
            },
            {
                id: 'post-3',
                title: 'Building Secure AI Infrastructure: Best Practices',
                excerpt: 'A comprehensive guide to implementing zero-trust architecture in AI systems.',
                content: `<h2>Security First Approach</h2>
                <p>In today's landscape, security cannot be an afterthought...</p>`,
                author: 'Alex Johnson',
                authorRole: 'Security Architect',
                date: new Date('2024-01-08'),
                category: 'technical',
                featured: false,
                image: 'https://via.placeholder.com/400x300/7c3aed/a855f7?text=Security',
                readTime: '8 min read',
                tags: ['security', 'best practices', 'infrastructure']
            },
            {
                id: 'post-4',
                title: 'The State of AI Infrastructure in 2024',
                excerpt: 'Industry trends, challenges, and opportunities in the evolving AI landscape.',
                content: `<p>As we enter 2024, the AI infrastructure landscape is evolving rapidly...</p>`,
                author: 'Jennifer Park',
                authorRole: 'VP of Product',
                date: new Date('2024-01-05'),
                category: 'industry',
                featured: false,
                image: 'https://via.placeholder.com/400x300/dc2626/ef4444?text=Industry+Trends',
                readTime: '6 min read',
                tags: ['industry', 'trends', 'AI']
            },
            {
                id: 'post-5',
                title: 'Announcing SirsiNexus SDK 2.0',
                excerpt: 'Major update brings new APIs, improved performance, and enhanced developer experience.',
                content: `<h2>What's New in SDK 2.0</h2>
                <p>We've completely reimagined our SDK based on developer feedback...</p>`,
                author: 'David Kim',
                authorRole: 'Developer Relations',
                date: new Date('2024-01-03'),
                category: 'product',
                featured: false,
                image: 'https://via.placeholder.com/400x300/ea580c/f97316?text=SDK+2.0',
                readTime: '4 min read',
                tags: ['SDK', 'developers', 'product']
            },
            {
                id: 'post-6',
                title: 'Sustainable AI: Our Carbon-Neutral Journey',
                excerpt: 'How we achieved carbon neutrality while scaling our AI infrastructure.',
                content: `<p>Sustainability is at the core of everything we do at SirsiNexus...</p>`,
                author: 'Emma Wilson',
                authorRole: 'Head of Sustainability',
                date: new Date('2023-12-28'),
                category: 'company',
                featured: false,
                image: 'https://via.placeholder.com/400x300/059669/10b981?text=Sustainability',
                readTime: '5 min read',
                tags: ['sustainability', 'environment', 'carbon-neutral']
            }
        ];

        // Load blog posts
        async function loadBlogPosts() {
            try {
                // Try to load from Firestore
                const snapshot = await firebase.firestore()
                    .collection('blog_posts')
                    .where('status', '==', 'published')
                    .orderBy('publishedAt', 'desc')
                    .limit(20)
                    .get();

                if (!snapshot.empty) {
                    allPosts = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data(),
                        date: doc.data().publishedAt?.toDate() || new Date()
                    }));
                } else {
                    allPosts = defaultPosts;
                }
            } catch (error) {
                console.error('Error loading blog posts:', error);
                allPosts = defaultPosts;
            }

            displayFeaturedPost();
            displayPosts();
        }

        // Display featured post
        function displayFeaturedPost() {
            const featured = allPosts.find(post => post.featured) || allPosts[0];
            if (!featured) return;

            document.getElementById('featured-post').innerHTML = `
                <div class="md:flex">
                    <div class="md:w-1/2">
                        <img src="${featured.image}" alt="${featured.title}" class="w-full h-64 md:h-full object-cover">
                    </div>
                    <div class="md:w-1/2 p-8">
                        <span class="bg-blue-600 text-xs px-2 py-1 rounded-full uppercase">${featured.category}</span>
                        <h2 class="text-3xl font-bold mt-4 mb-3">${featured.title}</h2>
                        <p class="text-gray-300 mb-4">${featured.excerpt}</p>
                        <div class="flex items-center gap-4 text-sm text-gray-400 mb-6">
                            <span><i class="fas fa-user"></i> ${featured.author}</span>
                            <span><i class="fas fa-calendar"></i> ${formatDate(featured.date)}</span>
                            <span><i class="fas fa-clock"></i> ${featured.readTime}</span>
                        </div>
                        <button onclick="openBlogPost('${featured.id}')" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg font-semibold">
                            Read Article
                        </button>
                    </div>
                </div>
            `;
        }

        // Display posts
        function displayPosts(posts = null) {
            const container = document.getElementById('blog-posts');
            const postsToShow = posts || allPosts.filter(p => !p.featured).slice(0, displayedPosts);

            if (postsToShow.length === 0) {
                container.innerHTML = '<p class="col-span-full text-center text-gray-400">No articles found.</p>';
                return;
            }

            container.innerHTML = postsToShow.map(post => `
                <article class="bg-gray-900 rounded-xl overflow-hidden border border-gray-700 hover:border-blue-500 transition cursor-pointer"
                         onclick="openBlogPost('${post.id}')">
                    <img src="${post.image}" alt="${post.title}" class="w-full h-48 object-cover">
                    <div class="p-6">
                        <span class="text-xs text-blue-400 uppercase">${post.category}</span>
                        <h3 class="text-xl font-semibold mt-2 mb-3">${post.title}</h3>
                        <p class="text-gray-400 mb-4 line-clamp-3">${post.excerpt}</p>
                        <div class="flex items-center justify-between text-sm text-gray-500">
                            <span>${post.author}</span>
                            <span>${formatDate(post.date)}</span>
                        </div>
                    </div>
                </article>
            `).join('');

            // Show/hide load more button
            const loadMoreBtn = document.getElementById('load-more');
            if (allPosts.filter(p => !p.featured).length > displayedPosts) {
                loadMoreBtn.classList.remove('hidden');
            } else {
                loadMoreBtn.classList.add('hidden');
            }
        }

        // Filter by category
        function filterByCategory(category) {
            currentCategory = category;
            
            // Update button styles
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'active');
                btn.classList.add('bg-gray-700');
            });
            event.target.classList.remove('bg-gray-700');
            event.target.classList.add('bg-blue-600', 'active');

            // Filter posts
            if (category === 'all') {
                displayPosts();
            } else {
                const filtered = allPosts.filter(p => p.category === category && !p.featured);
                displayPosts(filtered);
            }
        }

        // Search posts
        function searchPosts(query) {
            if (!query) {
                displayPosts();
                return;
            }

            const filtered = allPosts.filter(post => 
                post.title.toLowerCase().includes(query.toLowerCase()) ||
                post.excerpt.toLowerCase().includes(query.toLowerCase()) ||
                post.tags?.some(tag => tag.toLowerCase().includes(query.toLowerCase()))
            );
            displayPosts(filtered);
        }

        // Load more posts
        function loadMorePosts() {
            displayedPosts += 6;
            displayPosts();
        }

        // Open blog post modal
        function openBlogPost(postId) {
            const post = allPosts.find(p => p.id === postId);
            if (!post) return;

            document.getElementById('modal-content').innerHTML = `
                <div class="mb-6">
                    <span class="text-sm text-blue-400 uppercase">${post.category}</span>
                    <h1 class="text-3xl font-bold mt-2 mb-4">${post.title}</h1>
                    <div class="flex items-center gap-4 text-sm text-gray-400">
                        <img src="https://ui-avatars.com/api/?name=${post.author}&background=3b82f6&color=fff" 
                             alt="${post.author}" class="w-10 h-10 rounded-full">
                        <div>
                            <div class="text-white font-medium">${post.author}</div>
                            <div>${post.authorRole} • ${formatDate(post.date)} • ${post.readTime}</div>
                        </div>
                    </div>
                </div>
                <img src="${post.image}" alt="${post.title}" class="w-full rounded-lg mb-6">
                <div class="blog-content text-gray-300">
                    ${post.content}
                </div>
                <div class="mt-8 pt-8 border-t border-gray-700">
                    <h3 class="text-lg font-semibold mb-4">Share this article</h3>
                    <div class="flex gap-4">
                        <button onclick="shareArticle('twitter', '${postId}')" class="bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg">
                            <i class="fab fa-twitter"></i> Twitter
                        </button>
                        <button onclick="shareArticle('linkedin', '${postId}')" class="bg-blue-700 hover:bg-blue-800 px-4 py-2 rounded-lg">
                            <i class="fab fa-linkedin"></i> LinkedIn
                        </button>
                        <button onclick="copyLink('${postId}')" class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg">
                            <i class="fas fa-link"></i> Copy Link
                        </button>
                    </div>
                </div>
            `;

            document.getElementById('blog-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';

            // Track view
            SirsiAuth.trackEvent('blog_post_viewed', { postId, title: post.title });
        }

        // Close blog modal
        function closeBlogModal() {
            document.getElementById('blog-modal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // Share article
        function shareArticle(platform, postId) {
            const post = allPosts.find(p => p.id === postId);
            const url = `${window.location.origin}/blog/${postId}`;
            
            if (platform === 'twitter') {
                window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(post.title)}&url=${encodeURIComponent(url)}`);
            } else if (platform === 'linkedin') {
                window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`);
            }
        }

        // Copy link
        function copyLink(postId) {
            const url = `${window.location.origin}/blog/${postId}`;
            navigator.clipboard.writeText(url);
            alert('Link copied to clipboard!');
        }

        // Format date
        function formatDate(date) {
            return new Intl.DateTimeFormat('en-US', {
                month: 'short',
                day: 'numeric',
                year: 'numeric'
            }).format(date);
        }

        // Newsletter subscription
        document.getElementById('newsletter-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = e.target.querySelector('input[type="email"]').value;

            try {
                await firebase.firestore().collection('newsletter_subscribers').add({
                    email,
                    subscribedAt: firebase.firestore.FieldValue.serverTimestamp(),
                    source: 'blog'
                });

                document.getElementById('newsletter-success').classList.remove('hidden');
                e.target.reset();

                // Track event
                await SirsiAuth.trackEvent('newsletter_subscription', { source: 'blog' });
            } catch (error) {
                console.error('Subscription error:', error);
                alert('Error subscribing. Please try again.');
            }
        });
    </script>
</body>
</html>
